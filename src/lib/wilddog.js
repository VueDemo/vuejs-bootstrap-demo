!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.io=t()}}(function(){var t;return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return o(n?n:e)},u,u.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){function r(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r=o(t),i=r.source,p=r.id,u=r.path,f=c[p]&&u in c[p].nsps,h=e.forceNew||e["force new connection"]||!1===e.multiplex||f;return h?(a("ignoring socket cache for %s",i),n=s(i,e)):(c[p]||(a("new io instance for %s",i),c[p]=s(i,e)),n=c[p]),n.socket(r.path)}var o=t("./url"),i=t("socket.io-parser"),s=t("./manager"),a=t("debug")("socket.io-client");e.exports=n=r;var c=n.managers={};n.protocol=i.protocol,n.connect=r,n.Manager=t("./manager"),n.Socket=t("./socket")},{"./manager":2,"./socket":4,"./url":5,debug:14,"socket.io-parser":41}],2:[function(t,e,n){function r(t,e){return this instanceof r?(t&&"object"==typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(t,e)}var o=t("engine.io-client"),i=t("./socket"),s=t("component-emitter"),a=t("socket.io-parser"),c=t("./on"),p=t("component-bind"),u=t("debug")("socket.io-client:manager"),f=t("indexof"),h=t("backo2"),l=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)l.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},r.prototype.updateSocketIds=function(){for(var t in this.nsps)l.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},s(r.prototype),r.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},r.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},r.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=o(this.uri,this.opts);var e=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=c(e,"open",function(){n.onopen(),t&&t()}),i=c(e,"error",function(e){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var r=new Error("Connection error");r.data=e,t(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;u("connect attempt will timeout after %d",s);var a=setTimeout(function(){u("connect attempt timed out after %d",s),r.destroy(),e.close(),e.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(r),this.subs.push(i),this},r.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",p(this,"ondata"))),this.subs.push(c(t,"ping",p(this,"onping"))),this.subs.push(c(t,"pong",p(this,"onpong"))),this.subs.push(c(t,"error",p(this,"onerror"))),this.subs.push(c(t,"close",p(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",p(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(t){this.decoder.add(t)},r.prototype.ondecoded=function(t){this.emit("packet",t)},r.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},r.prototype.socket=function(t){function e(){~f(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[t];if(!n){n=new i(this,t),this.nsps[t]=n;var r=this;n.on("connecting",e),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&e()}return n},r.prototype.destroy=function(t){var e=f(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},r.prototype.packet=function(t){u("writing packet %j",t);var e=this;e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},r.prototype.cleanup=function(){u("cleanup");for(var t;t=this.subs.shift();)t.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"./on":3,"./socket":4,backo2:8,"component-bind":11,"component-emitter":12,debug:14,"engine.io-client":16,indexof:33,"socket.io-parser":41}],3:[function(t,e,n){function r(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}e.exports=r},{}],4:[function(t,e,n){function r(t,e){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}var o=t("socket.io-parser"),i=t("component-emitter"),s=t("to-array"),a=t("./on"),c=t("component-bind"),p=t("debug")("socket.io-client:socket"),u=t("has-binary");e.exports=n=r;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=i.prototype.emit;i(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",c(this,"onopen")),a(t,"packet",c(this,"onpacket")),a(t,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},r.prototype.emit=function(t){if(f.hasOwnProperty(t))return h.apply(this,arguments),this;var e=s(arguments),n=o.EVENT;u(e)&&(n=o.BINARY_EVENT);var r={type:n,data:e};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(p("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},r.prototype.onopen=function(){p("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:o.CONNECT})},r.prototype.onclose=function(t){p("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},r.prototype.onpacket=function(t){if(t.nsp==this.nsp)switch(t.type){case o.CONNECT:this.onconnect();break;case o.EVENT:this.onevent(t);break;case o.BINARY_EVENT:this.onevent(t);break;case o.ACK:this.onack(t);break;case o.BINARY_ACK:this.onack(t);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",t.data)}},r.prototype.onevent=function(t){var e=t.data||[];p("emitting event %j",e),null!=t.id&&(p("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?h.apply(this,e):this.receiveBuffer.push(e)},r.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);p("sending ack %j",r);var i=u(r)?o.BINARY_ACK:o.ACK;e.packet({type:i,id:t,data:r})}}},r.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(p("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):p("bad ack %s",t.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)h.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){p("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(p("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},{"./on":3,"component-bind":11,"component-emitter":12,debug:14,"has-binary":31,"socket.io-parser":41,"to-array":44}],5:[function(t,e,n){(function(n){function r(t,e){var r=t,e=e||n.location;null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t="undefined"!=typeof e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),r=o(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=-1!==r.host.indexOf(":"),a=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port,r.href=r.protocol+"://"+a+(e&&e.port==r.port?"":":"+r.port),r}var o=t("parseuri"),i=t("debug")("socket.io-client:url");e.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{debug:14,parseuri:39}],6:[function(t,e,n){function r(t,e,n){function r(t,o){if(r.count<=0)throw new Error("after called too many times");--r.count,t?(i=!0,e(t),e=n):0!==r.count||i||e(null,o)}var i=!1;return n=n||o,r.count=t,0===t?e():r}function o(){}e.exports=r},{}],7:[function(t,e,n){e.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(0>e&&(e+=r),0>n&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(t),i=new Uint8Array(n-e),s=e,a=0;n>s;s++,a++)i[a]=o[s];return i.buffer}},{}],8:[function(t,e,n){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}},{}],9:[function(t,e,n){!function(t){"use strict";n.encode=function(e){var n,r=new Uint8Array(e),o=r.buffer.byteLength,i="";for(n=0;o>n;n+=3)i+=t[r.buffer[n]>>2],i+=t[(3&r.buffer[n])<<4|r.buffer[n+1]>>4],i+=t[(15&r.buffer[n+1])<<2|r.buffer[n+2]>>6],i+=t[63&r.buffer[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},n.decode=function(e){var n,r,o,i,s,a=.75*e.length,c=e.length,p=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),f=new Uint8Array(u);for(n=0;c>n;n+=4)r=t.indexOf(e[n]),o=t.indexOf(e[n+1]),i=t.indexOf(e[n+2]),s=t.indexOf(e[n+3]),f[p++]=r<<2|o>>4,f[p++]=(15&o)<<4|i>>2,f[p++]=(3&i)<<6|63&s;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],10:[function(t,e,n){(function(t){function n(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}t[e]=r}}}function r(t,e){e=e||{};var r=new i;n(t);for(var o=0;o<t.length;o++)r.append(t[o]);return e.type?r.getBlob(e.type):r.getBlob()}function o(t,e){return n(t),new Blob(t,e||{})}var i=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size}catch(e){return!1}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;e.exports=function(){return s?a?t.Blob:o:c?r:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],11:[function(t,e,n){var r=[].slice;e.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return e.apply(t,n.concat(r.call(arguments)))}}},{}],12:[function(t,e,n){function r(t){return t?o(t):void 0}function o(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],13:[function(t,e,n){e.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],14:[function(t,e,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,i=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,r),t}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(e){}}function a(){var t;try{t=n.storage.debug}catch(e){}return t}function c(){try{return window.localStorage}catch(t){}}n=e.exports=t("./debug"),n.log=i,n.formatArgs=o,n.save=s,n.load=a,n.useColors=r,n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(t){return JSON.stringify(t)},n.enable(a())},{"./debug":15}],15:[function(t,e,n){function r(){return n.colors[u++%n.colors.length]}function o(t){function e(){}function o(){var t=o,e=+new Date,i=e-(p||e);t.diff=i,t.prev=p,t.curr=e,p=e,null==t.useColors&&(t.useColors=n.useColors()),null==t.color&&t.useColors&&(t.color=r());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;a++;var o=n.formatters[r];if("function"==typeof o){var i=s[a];e=o.call(t,i),s.splice(a,1),a--}return e}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(t,s));var c=o.log||n.log||console.log.bind(console);c.apply(t,s)}e.enabled=!1,o.enabled=!0;var i=n.enabled(t)?o:e;return i.namespace=t,i}function i(t){n.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,o=0;r>o;o++)e[o]&&(t=e[o].replace(/\*/g,".*?"),"-"===t[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")))}function s(){n.enable("")}function a(t){var e,r;for(e=0,r=n.skips.length;r>e;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;r>e;e++)if(n.names[e].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}n=e.exports=o,n.coerce=c,n.disable=s,n.enable=i,n.enabled=a,n.humanize=t("ms"),n.names=[],n.skips=[],n.formatters={};var p,u=0},{ms:36}],16:[function(t,e,n){e.exports=t("./lib/")},{"./lib/":17}],17:[function(t,e,n){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":18,"engine.io-parser":27}],18:[function(t,e,n){(function(n){function r(t,e){if(!(this instanceof r))return new r(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=u(t),e.hostname=t.host,e.secure="https"==t.protocol||"wss"==t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=u(e.host).host),this.secure=null!=e.secure?e.secure:n.location&&"https:"==location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(n.location?location.hostname:"localhost"),this.port=e.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate?e.perMessageDeflate||{}:!1,!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized?null:e.rejectUnauthorized;var o="object"==typeof n&&n;o.global===o&&e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),this.open()}function o(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var i=t("./transports"),s=t("component-emitter"),a=t("debug")("engine.io-client:socket"),c=t("indexof"),p=t("engine.io-parser"),u=t("parseuri"),f=t("parsejson"),h=t("parseqs");e.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=p.protocol,r.Socket=r,r.Transport=t("./transport"),r.transports=t("./transports"),r.parser=t("engine.io-parser"),r.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=o(this.query);e.EIO=p.protocol,e.transport=t,this.id&&(e.sid=this.id);var n=new i[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n},r.prototype.open=function(){var t;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(n){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},r.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},r.prototype.probe=function(t){function e(){if(h.onlyBinaryUpgrades){var e=!this.supportsBinary&&h.transport.supportsBinary;f=f||e}f||(a('probe transport "%s" opened',t),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(e){if(!f)if("pong"==e.type&&"probe"==e.data){if(a('probe transport "%s" pong',t),h.upgrading=!0,h.emit("upgrading",u),!u)return;r.priorWebsocketSuccess="websocket"==u.name,a('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){f||"closed"!=h.readyState&&(a("changing transport and sending upgrade packet"),p(),h.setTransport(u),u.send([{type:"upgrade"}]),h.emit("upgrade",u),u=null,h.upgrading=!1,h.flush())})}else{a('probe transport "%s" failed',t);var n=new Error("probe error");n.transport=u.name,h.emit("upgradeError",n)}}))}function n(){f||(f=!0,p(),u.close(),u=null)}function o(e){var r=new Error("probe error: "+e);r.transport=u.name,n(),a('probe transport "%s" failed because of error: %s',t,e),h.emit("upgradeError",r)}function i(){o("transport closed")}function s(){o("socket closed")}function c(t){u&&t.name!=u.name&&(a('"%s" works - aborting "%s"',t.name,u.name),n())}function p(){u.removeListener("open",e),u.removeListener("error",o),u.removeListener("close",i),h.removeListener("close",s),h.removeListener("upgrading",c)}a('probing transport "%s"',t);var u=this.createTransport(t,{probe:1}),f=!1,h=this;r.priorWebsocketSuccess=!1,u.once("open",e),u.once("error",o),u.once("close",i),this.once("close",s),this.once("upgrading",c),u.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;e>t;t++)this.probe(this.upgrades[t])}},r.prototype.onPacket=function(t){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(f(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!=e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},r.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},r.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},r.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){n=n||{},n.compress=!1!==n.compress;var o={type:t,data:e,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function t(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function e(){r.removeListener("upgrade",e),r.removeListener("upgradeError",e),t()}function n(){r.once("upgrade",e),r.once("upgradeError",e)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():t()}):this.upgrading?n():t()}return this},r.prototype.onError=function(t){a("socket error %j",t),r.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},r.prototype.onClose=function(t,e){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',t);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;r>n;n++)~c(this.transports,t[n])&&e.push(t[n]);return e}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./transport":19,"./transports":20,"component-emitter":26,debug:14,"engine.io-parser":27,indexof:33,parsejson:37,parseqs:38,parseuri:39}],19:[function(t,e,n){function r(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders}var o=t("engine.io-parser"),i=t("component-emitter");e.exports=r,i(r.prototype),r.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},r.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},r.prototype.send=function(t){if("open"!=this.readyState)throw new Error("Transport not open");this.write(t)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(t){var e=o.decodePacket(t,this.socket.binaryType);this.onPacket(e)},r.prototype.onPacket=function(t){this.emit("packet",t)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":26,"engine.io-parser":27}],20:[function(t,e,n){(function(e){function r(t){var n,r=!1,a=!1,c=!1!==t.jsonp;if(e.location){var p="https:"==location.protocol,u=location.port;u||(u=p?443:80),r=t.hostname!=location.hostname||u!=t.port,a=t.secure!=p}if(t.xdomain=r,t.xscheme=a,n=new o(t),"open"in n&&!t.forceJSONP)return new i(t);if(!c)throw new Error("JSONP disabled");return new s(t)}var o=t("xmlhttprequest-ssl"),i=t("./polling-xhr"),s=t("./polling-jsonp"),a=t("./websocket");n.polling=r,n.websocket=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling-jsonp":21,"./polling-xhr":22,"./websocket":24,"xmlhttprequest-ssl":25}],21:[function(t,e,n){(function(n){function r(){}function o(t){i.call(this,t),this.query=this.query||{},a||(n.___eio||(n.___eio=[]),a=n.___eio),this.index=a.length;var e=this;a.push(function(t){e.onData(t)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=r)},!1)}var i=t("./polling"),s=t("component-inherit");e.exports=o;var a,c=/\n/g,p=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n),
this.script=e;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},o.prototype.doWrite=function(t,e){function n(){r(),e()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(t){o.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(t){i=document.createElement("iframe"),i.name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=u,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),t=t.replace(p,"\\\n"),this.area.value=t.replace(c,"\\n");try{this.form.submit()}catch(f){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":23,"component-inherit":13}],22:[function(t,e,n){(function(n){function r(){}function o(t){if(c.call(this,t),n.location){var e="https:"==location.protocol,r=location.port;r||(r=e?443:80),this.xd=t.hostname!=n.location.hostname||r!=t.port,this.xs=t.secure!=e}else this.extraHeaders=t.extraHeaders}function i(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in i.requests)i.requests.hasOwnProperty(t)&&i.requests[t].abort()}var a=t("xmlhttprequest-ssl"),c=t("./polling"),p=t("component-emitter"),u=t("component-inherit"),f=t("debug")("engine.io-client:polling-xhr");e.exports=o,e.exports.Request=i,u(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.extraHeaders=this.extraHeaders,new i(t)},o.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),o=this;r.on("success",e),r.on("error",function(t){o.onError("xhr post error",t)}),this.sendXhr=r},o.prototype.doPoll=function(){f("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},p(i.prototype),i.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new a(t),r=this;try{f("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders){e.setDisableHeaderCheck(!0);for(var o in this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&e.setRequestHeader(o,this.extraHeaders[o])}}catch(s){}if(this.supportsBinary&&(e.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){r.onLoad()},e.onerror=function(){r.onError(e.responseText)}):e.onreadystatechange=function(){4==e.readyState&&(200==e.status||1223==e.status?r.onLoad():setTimeout(function(){r.onError(e.status)},0))},f("xhr data %s",this.data),e.send(this.data)}catch(s){return void setTimeout(function(){r.onError(s)},0)}n.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},i.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},i.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,t)try{this.xhr.abort()}catch(e){}n.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}if("application/octet-stream"===e)t=this.xhr.response;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(n){for(var r=new Uint8Array(this.xhr.response),o=[],i=0,s=r.length;s>i;i++)o.push(r[i]);t=String.fromCharCode.apply(null,o)}else t=this.xhr.responseText}catch(n){this.onError(n)}null!=t&&this.onData(t)},i.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},n.document&&(i.requestsCount=0,i.requests={},n.attachEvent?n.attachEvent("onunload",s):n.addEventListener&&n.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":23,"component-emitter":26,"component-inherit":13,debug:14,"xmlhttprequest-ssl":25}],23:[function(t,e,n){function r(t){var e=t&&t.forceBase64;(!u||e)&&(this.supportsBinary=!1),o.call(this,t)}var o=t("../transport"),i=t("parseqs"),s=t("engine.io-parser"),a=t("component-inherit"),c=t("yeast"),p=t("debug")("engine.io-client:polling");e.exports=r;var u=function(){var e=t("xmlhttprequest-ssl"),n=new e({xdomain:!1});return null!=n.responseType}();a(r,o),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(t){function e(){p("paused"),n.readyState="paused",t()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(p("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){p("pre-pause polling complete"),--r||e()})),this.writable||(p("we are currently writing - waiting to pause"),r++,this.once("drain",function(){p("pre-pause writing complete"),--r||e()}))}else e()},r.prototype.poll=function(){p("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(t){var e=this;p("polling got data %s",t);var n=function(t,n,r){return"opening"==e.readyState&&e.onOpen(),"close"==t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():p('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function t(){p("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(p("transport open - closing"),t()):(p("transport not open - deferring close"),this.once("open",t))},r.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")},e=this;s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,n)})},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(n=":"+this.port),t.length&&(t="?"+t);var r=-1!==this.hostname.indexOf(":");return e+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+t}},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:38,"xmlhttprequest-ssl":25,yeast:46}],24:[function(t,e,n){(function(n){function r(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,o.call(this,t)}var o=t("../transport"),i=t("engine.io-parser"),s=t("parseqs"),a=t("component-inherit"),c=t("yeast"),p=t("debug")("engine.io-client:websocket"),u=n.WebSocket||n.MozWebSocket,f=u||("undefined"!=typeof window?null:t("ws"));e.exports=r,a(r,o),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.ws=u?new f(t):new f(t,e,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(r.prototype.onData=function(t){var e=this;setTimeout(function(){o.prototype.onData.call(e,t)},0)}),r.prototype.write=function(t){function e(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var o=t.length,s=0,a=o;a>s;s++)!function(t){i.encodePacket(t,r.supportsBinary,function(i){if(!u){var s={};if(t.options&&(s.compress=t.options.compress),r.perMessageDeflate){var a="string"==typeof i?n.Buffer.byteLength(i):i.length;a<r.perMessageDeflate.threshold&&(s.compress=!1)}}try{u?r.ws.send(i):r.ws.send(i,s)}catch(c){p("websocket closed before onclose event")}--o||e()})}(t[s])},r.prototype.onClose=function(){o.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),t=s.encode(t),t.length&&(t="?"+t);var r=-1!==this.hostname.indexOf(":");return e+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+t},r.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===r.prototype.name)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:38,ws:void 0,yeast:46}],25:[function(t,e,n){var r=t("has-cors");e.exports=function(t){var e=t.xdomain,n=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(i){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(i){}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}},{"has-cors":32}],26:[function(t,e,n){function r(t){return t?o(t):void 0}function o(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){r.off(t,n),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks[t];if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],27:[function(t,e,n){(function(e){function r(t,e){var r="b"+n.packets[t.type]+t.data.data;return e(r)}function o(t,e,r){if(!e)return n.encodeBase64Packet(t,r);var o=t.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=m[t.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}function i(t,e,r){if(!e)return n.encodeBase64Packet(t,r);var o=new FileReader;return o.onload=function(){t.data=o.result,n.encodePacket(t,e,!0,r)},o.readAsArrayBuffer(t.data)}function s(t,e,r){if(!e)return n.encodeBase64Packet(t,r);if(g)return i(t,e,r);var o=new Uint8Array(1);o[0]=m[t.type];var s=new w([o.buffer,t.data]);return r(s)}function a(t,e,n){for(var r=new Array(t.length),o=h(t.length,n),i=function(t,n,o){e(n,function(e,n){r[t]=n,o(e,r)})},s=0;s<t.length;s++)i(s,t[s],o)}var c=t("./keys"),p=t("has-binary"),u=t("arraybuffer.slice"),f=t("base64-arraybuffer"),h=t("after"),l=t("utf8"),d=navigator.userAgent.match(/Android/i),y=/PhantomJS/i.test(navigator.userAgent),g=d||y;n.protocol=3;var m=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=c(m),v={type:"error",data:"parser error"},w=t("blob");n.encodePacket=function(t,n,i,a){"function"==typeof n&&(a=n,n=!1),"function"==typeof i&&(a=i,i=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return o(t,n,a);if(w&&c instanceof e.Blob)return s(t,n,a);if(c&&c.base64)return r(t,a);var p=m[t.type];return void 0!==t.data&&(p+=i?l.encode(String(t.data)):String(t.data)),a(""+p)},n.encodeBase64Packet=function(t,r){var o="b"+n.packets[t.type];if(w&&t.data instanceof e.Blob){var i=new FileReader;return i.onload=function(){var t=i.result.split(",")[1];r(o+t)},i.readAsDataURL(t.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(a){for(var c=new Uint8Array(t.data),p=new Array(c.length),u=0;u<c.length;u++)p[u]=c[u];s=String.fromCharCode.apply(null,p)}return o+=e.btoa(s),r(o)},n.decodePacket=function(t,e,r){if("string"==typeof t||void 0===t){if("b"==t.charAt(0))return n.decodeBase64Packet(t.substr(1),e);if(r)try{t=l.decode(t)}catch(o){return v}var i=t.charAt(0);return Number(i)==i&&b[i]?t.length>1?{type:b[i],data:t.substring(1)}:{type:b[i]}:v}var s=new Uint8Array(t),i=s[0],a=u(t,1);return w&&"blob"===e&&(a=new w([a])),{type:b[i],data:a}},n.decodeBase64Packet=function(t,n){var r=b[t.charAt(0)];if(!e.ArrayBuffer)return{type:r,data:{base64:!0,data:t.substr(1)}};var o=f.decode(t.substr(1));return"blob"===n&&w&&(o=new w([o])),{type:r,data:o}},n.encodePayload=function(t,e,r){function o(t){return t.length+":"+t}function i(t,r){n.encodePacket(t,s?e:!1,!0,function(t){r(null,o(t))})}"function"==typeof e&&(r=e,e=null);var s=p(t);return e&&s?w&&!g?n.encodePayloadAsBlob(t,r):n.encodePayloadAsArrayBuffer(t,r):t.length?void a(t,i,function(t,e){return r(e.join(""))}):r("0:")},n.decodePayload=function(t,e,r){if("string"!=typeof t)return n.decodePayloadAsBinary(t,e,r);"function"==typeof e&&(r=e,e=null);var o;if(""==t)return r(v,0,1);for(var i,s,a="",c=0,p=t.length;p>c;c++){var u=t.charAt(c);if(":"!=u)a+=u;else{if(""==a||a!=(i=Number(a)))return r(v,0,1);if(s=t.substr(c+1,i),a!=s.length)return r(v,0,1);if(s.length){if(o=n.decodePacket(s,e,!0),v.type==o.type&&v.data==o.data)return r(v,0,1);var f=r(o,c+i,p);if(!1===f)return}c+=i,a=""}}return""!=a?r(v,0,1):void 0},n.encodePayloadAsArrayBuffer=function(t,e){function r(t,e){n.encodePacket(t,!0,!0,function(t){return e(null,t)})}return t.length?void a(t,r,function(t,n){var r=n.reduce(function(t,e){var n;return n="string"==typeof e?e.length:e.byteLength,t+n.toString().length+n+2},0),o=new Uint8Array(r),i=0;return n.forEach(function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);n=r.buffer}e?o[i++]=0:o[i++]=1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]}),e(o.buffer)}):e(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(t,e){function r(t,e){n.encodePacket(t,!0,!0,function(t){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);t=r.buffer,n[0]=0}for(var i=t instanceof ArrayBuffer?t.byteLength:t.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++)a[o]=parseInt(s[o]);if(a[s.length]=255,w){var c=new w([n.buffer,a.buffer,t]);e(null,c)}})}a(t,r,function(t,n){return e(new w(n))})},n.decodePayloadAsBinary=function(t,e,r){"function"==typeof e&&(r=e,e=null);for(var o=t,i=[],s=!1;o.byteLength>0;){for(var a=new Uint8Array(o),c=0===a[0],p="",f=1;255!=a[f];f++){if(p.length>310){s=!0;break}p+=a[f]}if(s)return r(v,0,1);o=u(o,2+p.length),p=parseInt(p);var h=u(o,0,p);if(c)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(l){var d=new Uint8Array(h);h="";for(var f=0;f<d.length;f++)h+=String.fromCharCode(d[f])}i.push(h),o=u(o,p)}var y=i.length;i.forEach(function(t,o){r(n.decodePacket(t,e,!0),o,y)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./keys":28,after:6,"arraybuffer.slice":7,"base64-arraybuffer":9,blob:10,"has-binary":29,utf8:45}],28:[function(t,e,n){e.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},{}],29:[function(t,e,n){(function(n){function r(t){function e(t){if(!t)return!1;if(n.Buffer&&n.Buffer.isBuffer(t)||n.ArrayBuffer&&t instanceof ArrayBuffer||n.Blob&&t instanceof Blob||n.File&&t instanceof File)return!0;if(o(t)){for(var r=0;r<t.length;r++)if(e(t[r]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0}return!1}return e(t)}var o=t("isarray");e.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:34}],30:[function(t,e,n){e.exports=function(){return this}()},{}],31:[function(t,e,n){(function(n){function r(t){function e(t){if(!t)return!1;if(n.Buffer&&n.Buffer.isBuffer&&n.Buffer.isBuffer(t)||n.ArrayBuffer&&t instanceof ArrayBuffer||n.Blob&&t instanceof Blob||n.File&&t instanceof File)return!0;if(o(t)){for(var r=0;r<t.length;r++)if(e(t[r]))return!0}else if(t&&"object"==typeof t){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0}return!1}return e(t)}var o=t("isarray");e.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:34}],32:[function(t,e,n){var r=t("global");try{e.exports="XMLHttpRequest"in r&&"withCredentials"in new r.XMLHttpRequest}catch(o){e.exports=!1}},{global:30}],33:[function(t,e,n){var r=[].indexOf;e.exports=function(t,e){if(r)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},{}],34:[function(t,e,n){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],35:[function(e,n,r){(function(e){(function(){function o(t,e){function n(t){if(n[t]!==g)return n[t];var o;if("bug-string-char-index"==t)o="a"!="a"[0];else if("json"==t)o=n("json-stringify")&&n("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var c=e.stringify,u="function"==typeof c&&v;if(u){(s=function(){return 1}).toJSON=s;try{u="0"===c(0)&&"0"===c(new r)&&'""'==c(new i)&&c(b)===g&&c(g)===g&&c()===g&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([g])&&"null"==c(null)&&"[null,null,null]"==c([g,b,null])&&c({a:[s,!0,!1,null,"\x00\b\n\f\r	"]})==a&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new p(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new p(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new p(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new p(-1))}catch(f){u=!1}}o=u}if("json-parse"==t){var h=e.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){s=h(a);var l=5==s.a.length&&1===s.a[0];if(l){try{l=!h('"	"')}catch(f){}if(l)try{l=1!==h("01")}catch(f){}if(l)try{l=1!==h("1.")}catch(f){}}}}catch(f){l=!1}o=l}}return n[t]=!!o}t||(t=c.Object()),e||(e=c.Object());var r=t.Number||c.Number,i=t.String||c.String,a=t.Object||c.Object,p=t.Date||c.Date,u=t.SyntaxError||c.SyntaxError,f=t.TypeError||c.TypeError,h=t.Math||c.Math,l=t.JSON||c.JSON;"object"==typeof l&&l&&(e.stringify=l.stringify,e.parse=l.parse);var d,y,g,m=a.prototype,b=m.toString,v=new p(-0xc782b5b800cec);try{v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()}catch(w){}if(!n("json")){var k="[object Function]",x="[object Date]",A="[object Number]",B="[object String]",C="[object Array]",S="[object Boolean]",E=n("bug-string-char-index");if(!v)var _=h.floor,T=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(t,e){return T[e]+365*(t-1970)+_((t-1969+(e=+(e>1)))/4)-_((t-1901+e)/100)+_((t-1601+e)/400)};if((d=m.hasOwnProperty)||(d=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=b?d=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,d=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,d.call(this,t)}),y=function(t,e){var n,r,o,i=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)d.call(r,o)&&i++;return n=r=null,i?y=2==i?function(t,e){var n,r={},o=b.call(t)==k;for(n in t)o&&"prototype"==n||d.call(r,n)||!(r[n]=1)||!d.call(t,n)||e(n)}:function(t,e){var n,r,o=b.call(t)==k;for(n in t)o&&"prototype"==n||!d.call(t,n)||(r="constructor"===n)||e(n);(r||d.call(t,n="constructor"))&&e(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],y=function(t,e){var n,o,i=b.call(t)==k,a=!i&&"function"!=typeof t.constructor&&s[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(n in t)i&&"prototype"==n||!a.call(t,n)||e(n);for(o=r.length;n=r[--o];a.call(t,n)&&e(n));}),y(t,e)},!n("json-stringify")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},P="000000",N=function(t,e){return(P+(e||0)).slice(-t)},R="\\u00",D=function(t){for(var e='"',n=0,r=t.length,o=!E||r>10,i=o&&(E?t.split(""):t);r>n;n++){var s=t.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=j[s];break;default:if(32>s){e+=R+N(2,s.toString(16));break}e+=o?i[n]:t.charAt(n)}}return e+'"'},U=function(t,e,n,r,o,i,s){var a,c,p,u,h,l,m,v,w,k,E,T,j,P,R,q;try{a=e[t]}catch(L){}if("object"==typeof a&&a)if(c=b.call(a),c!=x||d.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=A&&c!=B&&c!=C||d.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(O){for(h=_(a/864e5),p=_(h/365.2425)+1970-1;O(p+1,0)<=h;p++);for(u=_((h-O(p,0))/30.42);O(p,u+1)<=h;u++);h=1+h-O(p,u),l=(a%864e5+864e5)%864e5,m=_(l/36e5)%24,v=_(l/6e4)%60,w=_(l/1e3)%60,k=l%1e3}else p=a.getUTCFullYear(),u=a.getUTCMonth(),h=a.getUTCDate(),m=a.getUTCHours(),v=a.getUTCMinutes(),w=a.getUTCSeconds(),k=a.getUTCMilliseconds();a=(0>=p||p>=1e4?(0>p?"-":"+")+N(6,0>p?-p:p):N(4,p))+"-"+N(2,u+1)+"-"+N(2,h)+"T"+N(2,m)+":"+N(2,v)+":"+N(2,w)+"."+N(3,k)+"Z"}else a=null;if(n&&(a=n.call(e,t,a)),null===a)return"null";if(c=b.call(a),c==S)return""+a;if(c==A)return a>-1/0&&1/0>a?""+a:"null";if(c==B)return D(""+a);if("object"==typeof a){for(P=s.length;P--;)if(s[P]===a)throw f();if(s.push(a),E=[],R=i,i+=o,c==C){for(j=0,P=a.length;P>j;j++)T=U(j,a,n,r,o,i,s),E.push(T===g?"null":T);q=E.length?o?"[\n"+i+E.join(",\n"+i)+"\n"+R+"]":"["+E.join(",")+"]":"[]"}else y(r||a,function(t){var e=U(t,a,n,r,o,i,s);e!==g&&E.push(D(t)+":"+(o?" ":"")+e)}),q=E.length?o?"{\n"+i+E.join(",\n"+i)+"\n"+R+"}":"{"+E.join(",")+"}":"{}";return s.pop(),q}};e.stringify=function(t,e,n){var r,o,i,a;if(s[typeof e]&&e)if((a=b.call(e))==k)o=e;else if(a==C){i={};for(var c,p=0,u=e.length;u>p;c=e[p++],a=b.call(c),(a==B||a==A)&&(i[c]=1));}if(n)if((a=b.call(n))==A){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else a==B&&(r=n.length<=10?n:n.slice(0,10));return U("",(c={},c[""]=t,c),o,i,r,"",[])}}if(!n("json-parse")){var q,L,M=i.fromCharCode,I={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},H=function(){throw q=L=null,u()},z=function(){for(var t,e,n,r,o,i=L,s=i.length;s>q;)switch(o=i.charCodeAt(q)){case 9:case 10:case 13:case 32:q++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=E?i.charAt(q):i[q],q++,t;case 34:for(t="@",q++;s>q;)if(o=i.charCodeAt(q),32>o)H();else if(92==o)switch(o=i.charCodeAt(++q)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=I[o],q++;break;case 117:for(e=++q,n=q+4;n>q;q++)o=i.charCodeAt(q),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||H();t+=M("0x"+i.slice(e,q));break;default:H()}else{if(34==o)break;for(o=i.charCodeAt(q),e=q;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++q);t+=i.slice(e,q)}if(34==i.charCodeAt(q))return q++,t;H();default:if(e=q,45==o&&(r=!0,o=i.charCodeAt(++q)),o>=48&&57>=o){for(48==o&&(o=i.charCodeAt(q+1),o>=48&&57>=o)&&H(),r=!1;s>q&&(o=i.charCodeAt(q),o>=48&&57>=o);q++);if(46==i.charCodeAt(q)){for(n=++q;s>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==q&&H(),q=n}if(o=i.charCodeAt(q),101==o||69==o){for(o=i.charCodeAt(++q),(43==o||45==o)&&q++,n=q;s>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==q&&H(),q=n}return+i.slice(e,q)}if(r&&H(),"true"==i.slice(q,q+4))return q+=4,!0;if("false"==i.slice(q,q+5))return q+=5,!1;if("null"==i.slice(q,q+4))return q+=4,null;H()}return"$"},J=function(t){var e,n;if("$"==t&&H(),"string"==typeof t){if("@"==(E?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=z(),"]"!=t;n||(n=!0))n&&(","==t?(t=z(),"]"==t&&H()):H()),","==t&&H(),e.push(J(t));return e}if("{"==t){for(e={};t=z(),"}"!=t;n||(n=!0))n&&(","==t?(t=z(),"}"==t&&H()):H()),(","==t||"string"!=typeof t||"@"!=(E?t.charAt(0):t[0])||":"!=z())&&H(),e[t.slice(1)]=J(z());return e}H()}return t},X=function(t,e,n){var r=F(t,e,n);r===g?delete t[e]:t[e]=r},F=function(t,e,n){var r,o=t[e];if("object"==typeof o&&o)if(b.call(o)==C)for(r=o.length;r--;)X(o,r,n);else y(o,function(t){X(o,t,n)});return n.call(t,e,o)};e.parse=function(t,e){var n,r;return q=0,L=""+t,n=J(z()),"$"!=z()&&H(),q=L=null,e&&b.call(e)==k?F((r={},r[""]=n,r),"",e):n}}}return e.runInContext=o,e}var i="function"==typeof t&&t.amd,s={"function":!0,object:!0},a=s[typeof r]&&r&&!r.nodeType&&r,c=s[typeof window]&&window||this,p=a&&s[typeof n]&&n&&!n.nodeType&&"object"==typeof e&&e;if(!p||p.global!==p&&p.window!==p&&p.self!==p||(c=p),a&&!i)o(c,a);else{var u=c.JSON,f=c.JSON3,h=!1,l=o(c,c.JSON3={noConflict:function(){return h||(h=!0,c.JSON=u,c.JSON3=f,u=f=null),l}});c.JSON={parse:l.parse,stringify:l.stringify}}i&&t(function(){return l})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],36:[function(t,e,n){function r(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*f;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*p;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function o(t){return t>=u?Math.round(t/u)+"d":t>=p?Math.round(t/p)+"h":t>=c?Math.round(t/c)+"m":t>=a?Math.round(t/a)+"s":t+"ms"}function i(t){return s(t,u,"day")||s(t,p,"hour")||s(t,c,"minute")||s(t,a,"second")||t+" ms"}function s(t,e,n){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var a=1e3,c=60*a,p=60*c,u=24*p,f=365.25*u;e.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e["long"]?i(t):o(t)}},{}],37:[function(t,e,n){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(o,"]").replace(i,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],38:[function(t,e,n){n.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},n.decode=function(t){for(var e={},n=t.split("&"),r=0,o=n.length;o>r;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},{}],39:[function(t,e,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,n=t.indexOf("["),i=t.indexOf("]");-1!=n&&-1!=i&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));for(var s=r.exec(t||""),a={},c=14;c--;)a[o[c]]=s[c]||"";return-1!=n&&-1!=i&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],40:[function(t,e,n){(function(e){var r=t("isarray"),o=t("./is-buffer");n.deconstructPacket=function(t){function e(t){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:n.length};return n.push(t),i}if(r(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a]);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var c in t)s[c]=e(t[c]);return s}return t}var n=[],i=t.data,s=t;return s.data=e(i),s.attachments=n.length,{packet:s,buffers:n}},n.reconstructPacket=function(t,e){function n(t){if(t&&t._placeholder){var o=e[t.num];return o}if(r(t)){for(var i=0;i<t.length;i++)t[i]=n(t[i]);return t}if(t&&"object"==typeof t){for(var s in t)t[s]=n(t[s]);return t}return t}return t.data=n(t.data),t.attachments=void 0,t},n.removeBlobs=function(t,n){function i(t,c,p){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){s++;var u=new FileReader;u.onload=function(){p?p[c]=this.result:a=this.result,--s||n(a)},u.readAsArrayBuffer(t)}else if(r(t))for(var f=0;f<t.length;f++)i(t[f],f,t);else if(t&&"object"==typeof t&&!o(t))for(var h in t)i(t[h],h,t)}var s=0,a=t;i(a),s||n(a)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./is-buffer":42,isarray:34}],41:[function(t,e,n){function r(){}function o(t){var e="",r=!1;return e+=t.type,(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type)&&(e+=t.attachments,e+="-"),t.nsp&&"/"!=t.nsp&&(r=!0,e+=t.nsp),null!=t.id&&(r&&(e+=",",r=!1),e+=t.id),null!=t.data&&(r&&(e+=","),e+=f.stringify(t.data)),u("encoded %j as %s",t,e),e}function i(t,e){function n(t){var n=l.deconstructPacket(t),r=o(n.packet),i=n.buffers;i.unshift(r),e(i)}l.removeBlobs(t,n);
}function s(){this.reconstructor=null}function a(t){var e={},r=0;if(e.type=Number(t.charAt(0)),null==n.types[e.type])return p();if(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type){for(var o="";"-"!=t.charAt(++r)&&(o+=t.charAt(r),r!=t.length););if(o!=Number(o)||"-"!=t.charAt(r))throw new Error("Illegal attachments");e.attachments=Number(o)}if("/"==t.charAt(r+1))for(e.nsp="";++r;){var i=t.charAt(r);if(","==i)break;if(e.nsp+=i,r==t.length)break}else e.nsp="/";var s=t.charAt(r+1);if(""!==s&&Number(s)==s){for(e.id="";++r;){var i=t.charAt(r);if(null==i||Number(i)!=i){--r;break}if(e.id+=t.charAt(r),r==t.length)break}e.id=Number(e.id)}if(t.charAt(++r))try{e.data=f.parse(t.substr(r))}catch(a){return p()}return u("decoded %s as %j",t,e),e}function c(t){this.reconPack=t,this.buffers=[]}function p(t){return{type:n.ERROR,data:"parser error"}}var u=t("debug")("socket.io-parser"),f=t("json3"),h=(t("isarray"),t("component-emitter")),l=t("./binary"),d=t("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=r,n.Decoder=s,r.prototype.encode=function(t,e){if(u("encoding packet %j",t),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type)i(t,e);else{var r=o(t);e([r])}},h(s.prototype),s.prototype.add=function(t){var e;if("string"==typeof t)e=a(t),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type?(this.reconstructor=new c(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!d(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,this.emit("decoded",e))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=l.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":40,"./is-buffer":42,"component-emitter":43,debug:14,isarray:34,json3:35}],42:[function(t,e,n){(function(t){function n(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],43:[function(t,e,n){arguments[4][26][0].apply(n,arguments)},{dup:26}],44:[function(t,e,n){function r(t,e){var n=[];e=e||0;for(var r=e||0;r<t.length;r++)n[r-e]=t[r];return n}e.exports=r},{}],45:[function(e,n,r){(function(e){!function(o){function i(t){for(var e,n,r=[],o=0,i=t.length;i>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&i>o?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function s(t){for(var e,n=t.length,r=-1,o="";++r<n;)e=t[r],e>65535&&(e-=65536,o+=w(e>>>10&1023|55296),e=56320|1023&e),o+=w(e);return o}function a(t){if(t>=55296&&57343>=t)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function c(t,e){return w(t>>e&63|128)}function p(t){if(0==(4294967168&t))return w(t);var e="";return 0==(4294965248&t)?e=w(t>>6&31|192):0==(4294901760&t)?(a(t),e=w(t>>12&15|224),e+=c(t,6)):0==(4292870144&t)&&(e=w(t>>18&7|240),e+=c(t,12),e+=c(t,6)),e+=w(63&t|128)}function u(t){for(var e,n=i(t),r=n.length,o=-1,s="";++o<r;)e=n[o],s+=p(e);return s}function f(){if(v>=b)throw Error("Invalid byte index");var t=255&m[v];if(v++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(){var t,e,n,r,o;if(v>b)throw Error("Invalid byte index");if(v==b)return!1;if(t=255&m[v],v++,0==(128&t))return t;if(192==(224&t)){var e=f();if(o=(31&t)<<6|e,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if(e=f(),n=f(),o=(15&t)<<12|e<<6|n,o>=2048)return a(o),o;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=f(),n=f(),r=f(),o=(15&t)<<18|e<<12|n<<6|r,o>=65536&&1114111>=o))return o;throw Error("Invalid UTF-8 detected")}function l(t){m=i(t),b=m.length,v=0;for(var e,n=[];(e=h())!==!1;)n.push(e);return s(n)}var d="object"==typeof r&&r,y="object"==typeof n&&n&&n.exports==d&&n,g="object"==typeof e&&e;(g.global===g||g.window===g)&&(o=g);var m,b,v,w=String.fromCharCode,k={version:"2.0.0",encode:u,decode:l};if("function"==typeof t&&"object"==typeof t.amd&&t.amd)t(function(){return k});else if(d&&!d.nodeType)if(y)y.exports=k;else{var x={},A=x.hasOwnProperty;for(var B in k)A.call(k,B)&&(d[B]=k[B])}else o.utf8=k}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],46:[function(t,e,n){"use strict";function r(t){var e="";do e=a[t%c]+e,t=Math.floor(t/c);while(t>0);return e}function o(t){var e=0;for(f=0;f<t.length;f++)e=e*c+p[t.charAt(f)];return e}function i(){var t=r(+new Date);return t!==s?(u=0,s=t):t+"."+r(u++)}for(var s,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),c=64,p={},u=0,f=0;c>f;f++)p[a[f]]=f;i.encode=r,i.decode=o,e.exports=i},{}]},{},[1])(1)});
(function(ns){var CLIENT_VERSION = "0.5.0";var NODE_CLIENT=0;ns.wrapper=function(good,wd){
var h,aa=this;function n(a){return void 0!==a}function ba(){}function ca(a){a.mb=function(){return a.He?a.He:a.He=new a}}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ea(a){return"array"==da(a)}function p(a){return"string"==typeof a}function fa(a){return"number"==typeof a}function ga(a){return"function"==da(a)}function ha(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ia(a,b,c){return a.call.apply(a.bind,arguments)}
function ja(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function q(a,b,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja;return q.apply(null,arguments)}var ka=Date.now||function(){return+new Date};
function la(a,b){function c(){}c.prototype=b.prototype;a.eg=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Zf=function(a,c,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[c].apply(a,g)}};var ma={};function na(a,b){this.type=oa;this.source=pa;this.path=a;this.le=b}na.prototype.Cc=function(){return this.path.f()?this:new na(r(this.path),this.le)};na.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" ack write revert="+this.le+")"};function qa(a,b){this.type=ra;this.source=a;this.path=b}qa.prototype.Cc=function(){return this.path.f()?new qa(this.source,t):new qa(this.source,r(this.path))};qa.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" listen_complete)"};function sa(a,b,c){this.type=ta;this.source=a;this.path=b;this.Ma=c}sa.prototype.Cc=function(a){return this.path.f()?new sa(this.source,t,this.Ma.P(a)):new sa(this.source,r(this.path),this.Ma)};sa.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" overwrite: "+this.Ma.toString()+")"};function u(){}u.prototype.R;u.prototype.G;u.prototype.fa;u.prototype.P;u.prototype.ma;u.prototype.Rd;u.prototype.U;u.prototype.K;u.prototype.Ga;u.prototype.f;u.prototype.hb;u.prototype.N;u.prototype.hash;u.prototype.Hb;u.prototype.ca;u.prototype.ab;u.prototype.Tb;function v(a,b){this.name=a;this.node=b}function ua(a,b){return new v(a,b)};function va(a,b){return wa(a.name,b.name)}function xa(a,b){return wa(a,b)};function ya(a){this.rf=a;this.cd=null}ya.prototype.get=function(){var a=this.rf.get(),b=za(a);if(this.cd)for(var c in this.cd)b[c]-=this.cd[c];this.cd=a;return b};function Aa(a,b){this.We={};this.ud=new ya(a);this.ea=b;var c=1E4+2E4*Math.random();setTimeout(q(this.Te,this),Math.floor(c))}Aa.prototype.Te=function(){var a=this.ud.get(),b={},c=!1,d;for(d in a)0<a[d]&&x(this.We,d)&&(b[d]=a[d],c=!0);c&&this.ea.ie(b);setTimeout(q(this.Te,this),Math.floor(6E5*Math.random()))};function z(a,b){if(1==arguments.length){this.B=a.split("/");for(var c=0,d=0;d<this.B.length;d++)0<this.B[d].length&&(this.B[c]=this.B[d],c++);this.B.length=c;this.da=0}else this.B=a,this.da=b}function A(a,b){var c=B(a);if(null===c)return b;if(c===B(b))return A(r(a),r(b));throw Error("INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")");}function B(a){return a.da>=a.B.length?null:a.B[a.da]}function Ba(a){return a.B.length-a.da}
function r(a){var b=a.da;b<a.B.length&&b++;return new z(a.B,b)}function Ca(a){return a.da<a.B.length?a.B[a.B.length-1]:null}h=z.prototype;h.toString=function(){for(var a="",b=this.da;b<this.B.length;b++)""!==this.B[b]&&(a+="/"+this.B[b]);return a||"/"};h.slice=function(a){return this.B.slice(this.da+(a||0))};h.parent=function(){if(this.da>=this.B.length)return null;for(var a=[],b=this.da;b<this.B.length-1;b++)a.push(this.B[b]);return new z(a,0)};
h.F=function(a){for(var b=[],c=this.da;c<this.B.length;c++)b.push(this.B[c]);if(a instanceof z)for(c=a.da;c<a.B.length;c++)b.push(a.B[c]);else for(a=a.split("/"),c=0;c<a.length;c++)0<a[c].length&&b.push(a[c]);return new z(b,0)};h.f=function(){return this.da>=this.B.length};h.ca=function(a){if(Ba(this)!==Ba(a))return!1;for(var b=this.da,c=a.da;b<=this.B.length;b++,c++)if(this.B[b]!==a.B[c])return!1;return!0};
h.contains=function(a){var b=this.da,c=a.da;if(Ba(this)>Ba(a))return!1;for(;b<this.B.length;){if(this.B[b]!==a.B[c])return!1;++b;++c}return!0};var t=new z("");function Da(a,b){this.o=a.slice();this.g=Math.max(1,this.o.length);this.Z=b;for(var c=0;c<this.o.length;c++)this.g+=Ea(this.o[c]);Fa(this)}Da.prototype.push=function(a){0<this.o.length&&(this.g+=1);this.o.push(a);this.g+=Ea(a);Fa(this)};Da.prototype.pop=function(){var a=this.o.pop();this.g-=Ea(a);0<this.o.length&&--this.g};
function Fa(a){if(768<a.g)throw Error(a.Z+"has a key path longer than 768 bytes ("+a.g+").");if(32<a.o.length)throw Error(a.Z+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ga(a));}function Ga(a){return 0==a.o.length?"":"in property '"+a.o.join(".")+"'"};function Ha(a,b){return a&&"object"===typeof a?(C(".sv"in a,"Unexpected leaf node or priority contents"),b[a[".sv"]]):a}function Ia(a,b){var c=new Ja;Ka(a,new z(""),function(a,e){c.bc(a,La(e,b))});return c}function La(a,b){var c=a.G().N(),c=Ha(c,b),d;if(a.R()){var e=Ha(a.Fa(),b);return e!==a.Fa()||c!==a.G().N()?new Ma(e,D(c)):a}d=a;c!==a.G().N()&&(d=d.fa(new Ma(c)));a.Y(E,function(a,c){var e=La(c,b);e!==c&&(d=d.U(a,e))});return d};function Na(a,b,c){this.H=a;this.ga=b;this.Kb=c}function Oa(a){return a.ga}function Pa(a,b){return a.ga&&!a.Kb||a.H.Ga(b)}Na.prototype.u=function(){return this.H};function F(a,b,c,d){this.type=a;this.Na=b;this.Wa=c;this.ae=d;this.nd=void 0}function Qa(a){return new F(Ra,a)}var Ra="value";function Sa(){}Sa.prototype.Fe=function(){return null};Sa.prototype.Pd=function(){return null};var Ta=new Sa;function Ua(a,b,c){this.$e=a;this.Oa=b;this.jd=c}Ua.prototype.Fe=function(a){var b=this.Oa.J;if(Pa(b,a))return b.u().P(a);b=null!=this.jd?new Na(this.jd,!0,!1):this.Oa.D();return this.$e.Va(a,b)};Ua.prototype.Pd=function(a,b,c){var d=null!=this.jd?this.jd:Va(this.Oa);a=this.$e.Gd(d,b,1,c,a);return 0===a.length?null:a[0]};function Wa(){}Wa.prototype.nb;Wa.prototype.Vc;Wa.prototype.gb;Wa.prototype.toString;function Xa(a,b,c,d){this.Ld=b;this.sd=c;this.nd=d;this.Tc=a}Xa.prototype.nb=function(){var a=this.sd.ac();return"value"===this.Tc?a.path:a.parent().path};Xa.prototype.Vc=function(){return this.Tc};Xa.prototype.gb=function(){return this.Ld.gb(this)};Xa.prototype.toString=function(){return this.nb().toString()+":"+this.Tc+":"+G(this.sd.Ae())};function Ya(a,b,c){this.Ld=a;this.error=b;this.path=c}Ya.prototype.nb=function(){return this.path};
Ya.prototype.Vc=function(){return"cancel"};Ya.prototype.gb=function(){return this.Ld.gb(this)};Ya.prototype.toString=function(){return this.path.toString()+":cancel"};function Za(){this.lb=[]}function $a(a,b){for(var c=null,d=0;d<b.length;d++){var e=b[d],f=e.nb();null===c||f.ca(c.nb())||(a.lb.push(c),c=null);null===c&&(c=new ab(f));c.add(e)}c&&a.lb.push(c)}function bb(a,b,c){$a(a,c);cb(a,function(a){return a.ca(b)})}function db(a,b,c){$a(a,c);cb(a,function(a){return a.contains(b)||b.contains(a)})}
function cb(a,b){for(var c=!0,d=0;d<a.lb.length;d++){var e=a.lb[d];if(e)if(e=e.nb(),b(e)){for(var e=a.lb[d],f=0;f<e.Uc.length;f++){var g=e.Uc[f];if(null!==g){e.Uc[f]=null;var k=g.gb();eb&&fb("event: "+g.toString());gb(k)}}a.lb[d]=null}else c=!1}c&&(a.lb=[])}function ab(a){this.va=a;this.Uc=[]}ab.prototype.add=function(a){this.Uc.push(a)};ab.prototype.nb=function(){return this.va};var hb={NETWORK_ERROR:"Unable to contact the Wilddog server.",SERVER_ERROR:"An unknown server error occurred.",TRANSPORT_UNAVAILABLE:"There are no login transports available for the requested method.",REQUEST_INTERRUPTED:"The browser redirected the page before the login request could complete.",USER_CANCELLED:"The user cancelled authentication."};function I(a){var b=Error(J(hb,a),a);b.code=a;return b};function ib(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(navigator.userAgent)}function jb(){return"undefined"!==typeof location&&/^file:\//.test(location.href)}
function kb(){if("undefined"===typeof navigator)return!1;var a=navigator.userAgent;if("Microsoft Internet Explorer"===navigator.appName){if((a=a.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/))&&1<a.length)return 8<=parseFloat(a[1])}else if(-1<a.indexOf("Trident")&&(a=a.match(/rv:([0-9]{2,2}[\.0-9]{0,})/))&&1<a.length)return 8<=parseFloat(a[1]);return!1};function x(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function J(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}function lb(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function mb(a){var b={};lb(a,function(a,d){b[a]=d});return b};function nb(a){this.pc=a;this.md="wilddog:"}h=nb.prototype;h.set=function(a,b){null==b?this.pc.removeItem(this.md+a):this.pc.setItem(this.md+a,G(b))};h.get=function(a){a=this.pc.getItem(this.md+a);return null==a?null:ob(a)};h.remove=function(a){this.pc.removeItem(this.md+a)};h.Je=!1;h.toString=function(){return this.pc.toString()};function pb(){this.kc={}}pb.prototype.set=function(a,b){null==b?delete this.kc[a]:this.kc[a]=b};pb.prototype.get=function(a){return x(this.kc,a)?this.kc[a]:null};pb.prototype.remove=function(a){delete this.kc[a]};pb.prototype.Je=!0;function qb(a){try{if("undefined"!==typeof window&&"undefined"!==typeof window[a]){var b=window[a];b.setItem("wilddog:sentinel","cache");b.removeItem("wilddog:sentinel");return new nb(b)}}catch(c){}return new pb}var rb=qb("localStorage"),sb=qb("sessionStorage");function tb(a,b,c,d,e){this.host=a.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.zb=b;this.Wb=c;this.ld=e||"";this.Qa=rb.get("host:"+a)||this.host}function ub(a,b){null==b?(a.Qa=a.host,"s-"===a.Qa.substr(0,2)&&rb.remove("host:"+a.host)):b!==a.Qa&&(a.Qa=b,"s-"===a.Qa.substr(0,2)&&rb.set("host:"+a.host,a.Qa))}tb.prototype.toString=function(){var a=(this.zb?"https://":"http://")+this.host;this.ld&&(a+="<"+this.ld+">");return a};var vb="auth.wilddog.com";function wb(a,b,c){this.Nc=a||{};this.yd=b||{};this.Za=c||{};this.Nc.remember||(this.Nc.remember="default")}var xb=["remember","redirectTo"];function yb(a){var b={},c={};lb(a||{},function(a,e){0<=zb(xb,a)?b[a]=e:c[a]=e});return new wb(b,{},c)};var Ab={};function K(a,b,c,d){var e;d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c);if(e)throw Error(a+" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+".");}function L(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}return a=a+" failed: "+(d+" argument ")}
function M(a,b,c,d){if((!d||n(c))&&!ga(c))throw Error(L(a,b,d)+"must be a valid function.");}function Bb(a,b,c){if(n(c)&&(!ha(c)||null===c))throw Error(L(a,b,!0)+"must be a valid context object.");};function Cb(){this.o=-1};function Db(){this.o=-1;this.o=64;this.g=[];this.$a=[];this.Dd=[];this.ta=[];this.ta[0]=128;for(var a=1;a<this.o;++a)this.ta[a]=0;this.Ha=this.Z=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.Ha=this.Z=0}la(Db,Cb);
function Eb(a,b,c){c||(c=0);var d=a.Dd;if(p(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
Db.prototype.update=function(a,b){if(null!=a){n(b)||(b=a.length);for(var c=b-this.o,d=0,e=this.$a,f=this.Z;d<b;){if(0==f)for(;d<=c;)Eb(this,a,d),d+=this.o;if(p(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.o){Eb(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.o){Eb(this,e);f=0;break}}this.Z=f;this.Ha+=b}};function Fb(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);}function Gb(){}
function Hb(a,b,c){if(null==b)c.push("null");else{if("object"==typeof b){if(ea(b)){var d=b;b=d.length;c.push("[");for(var e="",f=0;f<b;f++)c.push(e),Hb(a,d[f],c),e=",";c.push("]");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push("{");e="";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(f=b[d],"function"!=typeof f&&(c.push(e),Ib(d,c),c.push(":"),Hb(a,f,c),e=","));c.push("}");return}}switch(typeof b){case "string":Ib(b,c);break;case "number":c.push(isFinite(b)&&
!isNaN(b)?String(b):"null");break;case "boolean":c.push(String(b));break;case "function":c.push("null");break;default:throw Error("Unknown type: "+typeof b);}}}var Jb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Kb=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Ib(a,b){b.push('"',a.replace(Kb,function(a){var b=Jb[a];b||(b="\\u"+(a.charCodeAt(0)|65536).toString(16).substr(1),Jb[a]=b);return b}),'"')};function Lb(a){var b=[];lb(a,function(a,d){ea(d)?Mb(d,function(d){b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))}):b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))});return b.length?"&"+b.join("&"):""}function Nb(a){var b={};a=a.replace(/^\?/,"").split("&");Mb(a,function(a){a&&(a=a.split("="),b[a[0]]=a[1])});return b}function ob(a){return"undefined"!==typeof JSON&&n(JSON.parse)?JSON.parse(a):Fb(a)}
function G(a){if("undefined"!==typeof JSON&&n(JSON.stringify))a=JSON.stringify(a);else{var b=[];Hb(new Gb,a,b);a=b.join("")}return a}function Ob(){this.qd=N}Ob.prototype.u=function(a){return this.qd.ma(a)};Ob.prototype.toString=function(){return this.qd.toString()};function Pb(){var a=window.opener.frames,b;for(b=a.length-1;0<=b;b--)try{if(a[b].location.protocol===window.location.protocol&&a[b].location.host===window.location.host&&"__winchan_relay_frame"===a[b].name)return a[b]}catch(c){}return null}function Qb(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function Rb(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,!1)}
function Sb(a){/^https?:\/\//.test(a)||(a=window.location.href);var b=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(a);return b?b[1]:a}function Tb(a){var b="";try{a=a.replace("#","");var c=Nb(a);c&&x(c,"__wilddog_request_key")&&(b=J(c,"__wilddog_request_key"))}catch(d){}return b}function Ub(){var a=Vb(vb);return a.scheme+"://"+a.host+"/v1"}function Wb(a){return Ub()+"/"+a+"/auth/channel"};function Xb(a){a.callback_parameter||(a.callback_parameter="callback");this.options=a;window.__wilddog_auth_jsonp=window.__wilddog_auth_jsonp||{}}
Xb.prototype.open=function(a,b,c){function d(){c&&(c(I("REQUEST_INTERRUPTED")),c=null)}function e(){setTimeout(function(){window.__wilddog_auth_jsonp[f]=void 0;Yb(window.__wilddog_auth_jsonp)&&(window.__wilddog_auth_jsonp=void 0);try{var a=document.getElementById(f);a&&a.parentNode.removeChild(a)}catch(b){}},1);Rb(window,"beforeunload",d)}var f="fn"+(new Date).getTime()+Math.floor(99999*Math.random());b[this.options.callback_parameter]="__wilddog_auth_jsonp."+f;a+=(/\?/.test(a)?"":"?")+Lb(b);Qb(window,
"beforeunload",d);window.__wilddog_auth_jsonp[f]=function(a){c&&(c(null,a),c=null);e()};Zb(f,a,c)};
function Zb(a,b,c){setTimeout(function(){try{var d=document.createElement("script");d.type="text/javascript";d.id=a;d.async=!0;d.src=b;d.onerror=function(){var b=document.getElementById(a);null!==b&&b.parentNode.removeChild(b);c&&c(I("NETWORK_ERROR"))};var e,f=document.getElementsByTagName("head");f&&0!=f.length?e=f[0]:e=document.documentElement;e.appendChild(d)}catch(g){c&&c(I("NETWORK_ERROR"))}},0)}Xb.isAvailable=function(){return!NODE_CLIENT};Xb.prototype.Gb=function(){return"json"};function $b(a){a.method||(a.method="GET");a.headers||(a.headers={});a.headers.content_type||(a.headers.content_type="application/json");a.headers.content_type=a.headers.content_type.toLowerCase();this.options=a}
$b.prototype.open=function(a,b,c){var d=Vb(a),e="http"===d.scheme?require("http"):require("https");a=this.options.method;var f,g={Accept:"application/json;text/plain"};ac(g,this.options.headers);d={host:d.host.split(":")[0],port:d.port,path:d.Zb,method:this.options.method.toUpperCase()};if("GET"===a)d.path+=(/\?/.test(d.path)?"":"?")+Lb(b),f=null;else{var k=this.options.headers.content_type;"application/json"===k&&(f=G(b));"application/x-www-form-urlencoded"===k&&(f=Lb(b));g["Content-Length"]=Buffer.byteLength(f,
"utf8")}d.headers=g;b=e.request(d,function(a){var b="";a.setEncoding("utf8");a.on("data",function(a){b+=a});a.on("end",function(){try{b=ob(b+"")}catch(a){}c&&(c(null,b),c=null)})});"GET"!==a&&b.write(f);b.on("error",function(a){a&&a.code&&("ENOTFOUND"===a.code||"ENETDOWN"===a.code)?c(I("NETWORK_ERROR")):c(I("SERVER_ERROR"));c=null});b.end()};$b.isAvailable=function(){return NODE_CLIENT};$b.prototype.Gb=function(){return"json"};function bc(a){var b=this;this.nc=a;this.xd="*";kb()?this.wc=this.Zc=Pb():(this.wc=window.opener,this.Zc=window);if(!b.wc)throw"Unable to find relay frame";Qb(this.Zc,"message",q(this.hd,this));Qb(this.Zc,"message",q(this.Ne,this));try{cc(this,{a:"ready"})}catch(c){Qb(this.wc,"load",function(){cc(b,{a:"ready"})})}Qb(window,"unload",q(this.Hf,this))}function cc(a,b){b=G(b);kb()?a.wc.doPost(b,a.xd):a.wc.postMessage(b,a.xd)}
bc.prototype.hd=function(a){var b=this,c;try{c=ob(a.data)}catch(d){}c&&"request"===c.a&&(Rb(window,"message",this.hd),this.xd=a.origin,this.nc&&setTimeout(function(){b.nc(b.xd,c.d,function(a,c){b.nf=!c;b.nc=void 0;cc(b,{a:"response",d:a,forceKeepWindowOpen:c})})},0))};bc.prototype.Hf=function(){try{Rb(this.Zc,"message",this.Ne)}catch(a){}this.nc&&(cc(this,{a:"error",d:"unknown closed window"}),this.nc=void 0);try{window.close()}catch(a){}};bc.prototype.Ne=function(a){if(this.nf&&"die"===a.data)try{window.close()}catch(b){}};function dc(a){this.dc=ec()+ec()+ec();this.Qe=a}dc.prototype.open=function(a,b){sb.set("redirect_request_id",this.dc);sb.set("redirect_request_id",this.dc);b.requestId=this.dc;b.redirectTo=b.redirectTo||window.location.href;a+=(/\?/.test(a)?"":"?")+Lb(b);window.location=a};dc.isAvailable=function(){return!NODE_CLIENT&&!jb()&&!ib()};dc.prototype.Gb=function(){return"redirect"};function fc(a){a.method||(a.method="GET");a.headers||(a.headers={});a.headers.content_type||(a.headers.content_type="application/json");a.headers.content_type=a.headers.content_type.toLowerCase();this.options=a}
fc.prototype.open=function(a,b,c){function d(){c&&(c(I("REQUEST_INTERRUPTED")),c=null)}var e=new XMLHttpRequest,f=this.options.method.toUpperCase(),g;Qb(window,"beforeunload",d);e.onreadystatechange=function(){if(c&&4===e.readyState){var a;if(200<=e.status&&300>e.status){try{a=ob(e.responseText)}catch(b){}c(null,a)}else 500<=e.status&&600>e.status?c(I("SERVER_ERROR")):c(I("NETWORK_ERROR"));c=null;Rb(window,"beforeunload",d)}};if("GET"===f)a+=(/\?/.test(a)?"":"?")+Lb(b),g=null;else{var k=this.options.headers.content_type;
"application/json"===k&&(g=G(b));"application/x-www-form-urlencoded"===k&&(g=Lb(b))}e.open(f,a,!0);a={"X-Requested-With":"XMLHttpRequest",Accept:"application/json;text/plain"};ac(a,this.options.headers);for(var l in a)e.setRequestHeader(l,a[l]);e.send(g)};fc.isAvailable=function(){return!NODE_CLIENT&&!!window.XMLHttpRequest&&(!("undefined"!==typeof navigator&&(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)))||kb())};fc.prototype.Gb=function(){return"json"};function O(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function gc(a,b){var c={},d;for(d in a)c[d]=b.call(void 0,a[d],d,a);return c}function hc(a,b){for(var c in a)if(!b.call(void 0,a[c],c,a))return!1;return!0}function ic(a){var b=0,c;for(c in a)b++;return b}function jc(a){for(var b in a)return b}function kc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function lc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function mc(a,b){return null!==a&&b in a}
function nc(a,b){for(var c in a)if(a[c]==b)return!0;return!1}function oc(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d}function pc(a,b){var c=oc(a,b,void 0);return c&&a[c]}function Yb(a){for(var b in a)return!1;return!0}function za(a){var b={},c;for(c in a)b[c]=a[c];return b}var qc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function ac(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<qc.length;f++)c=qc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function ec(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ka()).toString(36)};var zb=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Mb=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},rc=Array.prototype.filter?function(a,b,c){return Array.prototype.filter.call(a,
b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=p(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},sc=Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=p(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},tc=Array.prototype.reduce?function(a,b,c,d){d&&(b=q(b,d));return Array.prototype.reduce.call(a,b,c)}:function(a,b,c,d){var e=c;Mb(a,function(c,g){e=b.call(d,
e,c,g,a)});return e},uc=Array.prototype.every?function(a,b,c){return Array.prototype.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function vc(a,b){var c=wc(a,b,void 0);return 0>c?null:p(a)?a.charAt(c):a[c]}function wc(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function xc(a,b){var c=zb(a,b);0<=c&&Array.prototype.splice.call(a,c,1)}
function yc(a,b){a.sort(b||zc)}function zc(a,b){return a>b?1:a<b?-1:0};function Ac(){this.oc={}}Ac.prototype.get=function(){return za(this.oc)};var Bc={},Cc={};function Dc(a){a=a.toString();Bc[a]||(Bc[a]=new Ac);return Bc[a]}function Ec(a,b){var c=a.toString();Cc[c]||(Cc[c]=b());return Cc[c]};({}).Uf;function Fc(a,b){this.o=a;this.g=b?b:Gc}h=Fc.prototype;h.Pa=function(a,b){return new Fc(this.o,this.g.Pa(a,b,this.o).ba(null,null,Hc,null,null))};h.remove=function(a){return new Fc(this.o,this.g.remove(a,this.o).ba(null,null,Hc,null,null))};h.get=function(a){for(var b,c=this.g;!c.f();){b=this.o(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return null};
function Ic(a,b){for(var c,d=a.g,e=null;!d.f();){c=a.o(b,d.key);if(0===c){if(d.left.f())return e?e.key:null;for(d=d.left;!d.right.f();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?");}h.f=function(){return this.g.f()};h.count=function(){return this.g.count()};h.xc=function(){return this.g.xc()};h.Vb=function(){return this.g.Vb()};h.na=function(a){return this.g.na(a)};
h.Mb=function(a){return new Jc(this.g,null,this.o,!1,a)};h.Nb=function(a,b){return new Jc(this.g,a,this.o,!1,b)};h.Ob=function(a,b){return new Jc(this.g,a,this.o,!0,b)};h.Ge=function(a){return new Jc(this.g,null,this.o,!0,a)};function Jc(a,b,c,d,e){this.g=e||null;this.o=d;this.Ra=[];for(e=1;!a.f();)if(e=b?c(a.key,b):1,d&&(e*=-1),0>e)a=this.o?a.left:a.right;else if(0===e){this.Ra.push(a);break}else this.Ra.push(a),a=this.o?a.right:a.left}
function P(a){if(0===a.Ra.length)return null;var b=a.Ra.pop(),c;a.g?c=a.g(b.key,b.value):c={key:b.key,value:b.value};if(a.o)for(b=b.left;!b.f();)a.Ra.push(b),b=b.right;else for(b=b.right;!b.f();)a.Ra.push(b),b=b.left;return c}function Kc(a){if(0===a.Ra.length)return null;var b;b=a.Ra;b=b[b.length-1];return a.g?a.g(b.key,b.value):{key:b.key,value:b.value}}function Lc(a,b,c,d,e){this.key=a;this.value=b;this.color=null!=c?c:Mc;this.left=null!=d?d:Gc;this.right=null!=e?e:Gc}var Mc=!0,Hc=!1;h=Lc.prototype;
h.ba=function(a,b,c,d,e){return new Lc(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)};h.count=function(){return this.left.count()+1+this.right.count()};h.f=function(){return!1};h.na=function(a){return this.left.na(a)||a(this.key,this.value)||this.right.na(a)};function Nc(a){return a.left.f()?a:Nc(a.left)}h.xc=function(){return Nc(this).key};h.Vb=function(){return this.right.f()?this.key:this.right.Vb()};
h.Pa=function(a,b,c){var d,e;e=this;d=c(a,e.key);e=0>d?e.ba(null,null,null,e.left.Pa(a,b,c),null):0===d?e.ba(null,b,null,null,null):e.ba(null,null,null,null,e.right.Pa(a,b,c));return Oc(e)};function Pc(a){if(a.left.f())return Gc;a.left.ka()||a.left.left.ka()||(a=Qc(a));a=a.ba(null,null,null,Pc(a.left),null);return Oc(a)}
h.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))c.left.f()||c.left.ka()||c.left.left.ka()||(c=Qc(c)),c=c.ba(null,null,null,c.left.remove(a,b),null);else{c.left.ka()&&(c=Rc(c));c.right.f()||c.right.ka()||c.right.left.ka()||(c=Sc(c),c.left.left.ka()&&(c=Rc(c),c=Sc(c)));if(0===b(a,c.key)){if(c.right.f())return Gc;d=Nc(c.right);c=c.ba(d.key,d.value,null,null,Pc(c.right))}c=c.ba(null,null,null,null,c.right.remove(a,b))}return Oc(c)};h.ka=function(){return this.color};
function Oc(a){a.right.ka()&&!a.left.ka()&&(a=Tc(a));a.left.ka()&&a.left.left.ka()&&(a=Rc(a));a.left.ka()&&a.right.ka()&&(a=Sc(a));return a}function Qc(a){a=Sc(a);a.right.left.ka()&&(a=a.ba(null,null,null,null,Rc(a.right)),a=Tc(a),a=Sc(a));return a}function Tc(a){return a.right.ba(null,null,a.color,a.ba(null,null,Mc,null,a.right.left),null)}function Rc(a){return a.left.ba(null,null,a.color,null,a.ba(null,null,Mc,a.left.right,null))}
function Sc(a){return a.ba(null,null,!a.color,a.left.ba(null,null,!a.left.color,null,null),a.right.ba(null,null,!a.right.color,null,null))}function Uc(){}h=Uc.prototype;h.ba=function(){return this};h.Pa=function(a,b){return new Lc(a,b,null)};h.remove=function(){return this};h.count=function(){return 0};h.f=function(){return!0};h.na=function(){return!1};h.xc=function(){return null};h.Vb=function(){return null};h.ka=function(){return!1};var Gc=new Uc;var Q;a:{var Vc=aa.navigator;if(Vc){var Wc=Vc.userAgent;if(Wc){Q=Wc;break a}}Q=""};var Xc=-1!=Q.indexOf("Opera")||-1!=Q.indexOf("OPR"),Yc=-1!=Q.indexOf("Trident")||-1!=Q.indexOf("MSIE"),Zc=-1!=Q.indexOf("Edge"),$c=-1!=Q.indexOf("Gecko")&&!(-1!=Q.toLowerCase().indexOf("webkit")&&-1==Q.indexOf("Edge"))&&!(-1!=Q.indexOf("Trident")||-1!=Q.indexOf("MSIE"))&&-1==Q.indexOf("Edge"),ad=-1!=Q.toLowerCase().indexOf("webkit")&&-1==Q.indexOf("Edge");
function bd(){var a=Q;if($c)return/rv\:([^\);]+)(\)|;)/.exec(a);if(Zc)return/Edge\/([\d\.]+)/.exec(a);if(Yc)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(ad)return/WebKit\/(\S+)/.exec(a)}(function(){if(Xc&&aa.opera){var a;var b=aa.opera.version;try{a=b()}catch(c){a=b}return a}a="";(b=bd())&&(a=b?b[1]:"");return Yc&&(b=(b=aa.document)?b.documentMode:void 0,b>parseFloat(a))?String(b):a})();var cd=null,dd=null;function ed(a){var b="";fd(a,function(a){b+=String.fromCharCode(a)});return b}function fd(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=dd[c];if(null!=e)return e;if(!/^[\s\xa0]*$/.test(c))throw Error("Unknown base64 encoding at char: "+c);}return b}gd();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=k&&b(g<<6&192|k))}}
function gd(){if(!cd){cd={};dd={};for(var a=0;65>a;a++)cd[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),dd[cd[a]]=a,62<=a&&(dd["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var hd=function(){var a=1;return function(){return a++}}();function C(a,b){if(!a)throw id(b);}function id(a){return Error("Wilddog ("+R.g+") INTERNAL ASSERT FAILED: "+a)}function jd(a){try{return NODE_CLIENT?(new Buffer(a,"base64")).toString("utf8"):"undefined"!==typeof atob?atob(a):ed(a)}catch(b){fb("base64Decode failed: ",b)}return null}
function kd(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e=e-55296,d++,C(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320));128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}a=new Db;a.update(b);b=[];d=8*a.Ha;56>a.Z?a.update(a.ta,56-a.Z):a.update(a.ta,a.o-(a.Z-56));for(c=a.o-1;56<=c;c--)a.$a[c]=d&255,d/=256;Eb(a,a.$a);for(c=d=
0;5>c;c++)for(e=24;0<=e;e-=8)b[d]=a.g[c]>>e&255,++d;gd();a=cd;c=[];for(d=0;d<b.length;d+=3){var f=b[d],g=(e=d+1<b.length)?b[d+1]:0,k=d+2<b.length,l=k?b[d+2]:0,m=f>>2,f=(f&3)<<4|g>>4,g=(g&15)<<2|l>>6,l=l&63;k||(l=64,e||(g=64));c.push(a[m],a[f],a[g],a[l])}return c.join("")}
function ld(a){for(var b="",c=0;c<arguments.length;c++)var d=arguments[c],e=da(d),b="array"==e||"object"==e&&"number"==typeof d.length?b+ld.apply(null,arguments[c]):"object"===typeof arguments[c]?b+G(arguments[c]):b+arguments[c],b=b+" ";return b}var eb=null,md=!0;function fb(a){!0===md&&(md=!1,null===eb&&!0===sb.get("logging_enabled")&&R.Z());if(eb){var b=ld.apply(null,arguments);eb(b)}}function nd(a){return function(){fb(a,arguments)}}
function od(a){if("undefined"!==typeof console){var b="WILDDOG INTERNAL ERROR: "+ld.apply(null,arguments);"undefined"!==typeof console.error?console.error(b):console.log(b)}}function pd(a){var b=ld.apply(null,arguments);throw Error("WILDDOG FATAL ERROR: "+b);}function S(a){if("undefined"!==typeof console){var b="WILDDOG WARNING: "+ld.apply(null,arguments);"undefined"!==typeof console.warn?console.warn(b):console.log(b)}}
function Vb(a){var b="",c="",d="",e="",f=!0,g="https",k=443;if(p(a)){var l=a.indexOf("//");0<=l&&(g=a.substring(0,l-1),a=a.substring(l+2));l=a.indexOf("/");-1===l&&(l=a.length);b=a.substring(0,l);e="";a=a.substring(l).split("/");for(l=0;l<a.length;l++)if(0<a[l].length){var m=a[l];try{m=decodeURIComponent(m.replace(/\+/g," "))}catch(w){}e+="/"+m}a=b.split(".");3===a.length?(c=a[1],d=a[0].toLowerCase()):2===a.length&&(c=a[0]);l=b.indexOf(":");0<=l&&(f="https"===g||"wss"===g,k=b.substring(l+1),isFinite(k)&&
(k=String(k)),k=p(k)?/^\s*-?0x/i.test(k)?parseInt(k,16):parseInt(k,10):NaN)}return{host:b,port:k,domain:c,Sf:d,zb:f,scheme:g,Zb:e}}function qd(a){return fa(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function wa(a,b){if(a===b)return 0;if("[MIN_NAME]"===a||"[MAX_NAME]"===b)return-1;if("[MIN_NAME]"===b||"[MAX_NAME]"===a)return 1;var c=rd(a),d=rd(b);return null!==c?null!==d?0==c-d?a.length-b.length:c-d:-1:null!==d?1:a<b?-1:1}
function sd(a,b){if(b&&a in b)return b[a];throw Error("Missing required key ("+a+") in object: "+G(b));}function td(a){if("object"!==typeof a||null===a)return G(a);var b=[],c;for(c in a)b.push(c);b.sort();c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=G(b[d]),c+=":",c+=td(a[b[d]]);return c+"}"}function ud(a,b){if(ea(a))for(var c=0;c<a.length;++c)b(c,a[c]);else O(a,b)}
function vd(a){C(!qd(a),"Invalid JSON number");var b,c,d,e;0===a?(d=c=0,b=-Infinity===1/a?1:0):(b=0>a,a=Math.abs(a),a>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,52))):(c=0,d=Math.round(a/Math.pow(2,-1074))));e=[];for(a=52;a;--a)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;--a)e.push(c%2?1:0),c=Math.floor(c/2);e.push(b?1:0);e.reverse();b=e.join("");c="";for(a=0;64>a;a+=8)d=parseInt(b.substr(a,8),2).toString(16),1===d.length&&
(d="0"+d),c+=d;return c.toLowerCase()}var wd=/^-?\d{1,10}$/;function rd(a){return wd.test(a)&&(a=Number(a),-2147483648<=a&&2147483647>=a)?a:null}function gb(a){try{a()}catch(b){setTimeout(function(){S("Exception was thrown by user callback.",b.stack||"");throw b;},Math.floor(0))}}function T(a,b){if(ga(a)){var c=Array.prototype.slice.call(arguments,1).slice();gb(function(){a.apply(null,c)})}};function xd(a,b,c){this.type=zd;this.source=a;this.path=b;this.children=c}xd.prototype.Cc=function(a){if(this.path.f())return a=this.children.subtree(new z(a)),a.f()?null:a.value?new sa(this.source,t,a.value):new xd(this.source,t,a);C(B(this.path)===a,"Can't get a merge for a child not on the path of the operation");return new xd(this.source,r(this.path),this.children)};xd.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"};var ta=0,zd=1,oa=2,ra=3;function Ad(){}Ad.prototype.source;Ad.prototype.type;Ad.prototype.path;function Bd(a,b,c,d){this.Nd=a;this.Ee=b;this.xb=c;this.re=d;C(!d||b,"Tagged queries must be from server.")}var pa=new Bd(!0,!1,null,!1),Cd=new Bd(!1,!0,null,!1);Bd.prototype.toString=function(){return this.Nd?"user":this.re?"server(queryID="+this.xb+")":"server"};function Dd(){}Dd.g;var Ed={};function Fd(a){return q(a.compare,a)}Dd.prototype.$c=function(a,b){return 0!==this.compare(new v("[MIN_NAME]",a),new v("[MIN_NAME]",b))};Dd.prototype.yc=function(){return Gd};function Hd(a){this.Qb=a}la(Hd,Dd);h=Hd.prototype;h.rc=function(a){return!a.P(this.Qb).f()};h.compare=function(a,b){var c=a.node.P(this.Qb),d=b.node.P(this.Qb),c=c.Hb(d);return 0===c?wa(a.name,b.name):c};h.uc=function(a,b){var c=D(a),c=N.U(this.Qb,c);return new v(b,c)};
h.vc=function(){var a=N.U(this.Qb,Id);return new v("[MAX_NAME]",a)};h.toString=function(){return this.Qb};function Jd(){}la(Jd,Dd);h=Jd.prototype;h.compare=function(a,b){var c=a.node.G(),d=b.node.G(),c=c.Hb(d);return 0===c?wa(a.name,b.name):c};h.rc=function(a){return!a.G().f()};h.$c=function(a,b){return!a.G().ca(b.G())};h.yc=function(){return Gd};h.vc=function(){return new v("[MAX_NAME]",new Ma("[PRIORITY-POST]",Id))};h.uc=function(a,b){var c=D(a);return new v(b,new Ma("[PRIORITY-POST]",c))};
h.toString=function(){return".priority"};var E=new Jd;function Kd(){}la(Kd,Dd);h=Kd.prototype;h.compare=function(a,b){return wa(a.name,b.name)};h.rc=function(){throw id("KeyIndex.isDefinedOn not expected to be called.");};h.$c=function(){return!1};h.yc=function(){return Gd};h.vc=function(){return new v("[MAX_NAME]",N)};h.uc=function(a){C(p(a),"KeyIndex indexValue must always be a string.");return new v(a,N)};h.toString=function(){return".key"};var Ld=new Kd;function Md(){}la(Md,Dd);h=Md.prototype;
h.compare=function(a,b){var c=a.node.Hb(b.node);return 0===c?wa(a.name,b.name):c};h.rc=function(){return!0};h.$c=function(a,b){return!a.ca(b)};h.yc=function(){return Gd};h.vc=function(){return Nd};h.uc=function(a,b){var c=D(a);return new v(b,c)};h.toString=function(){return".value"};var Od=new Md;function Pd(a,b){this.ad=a;this.Rb=b}Pd.prototype.get=function(a){var b=J(this.ad,a);if(!b)throw Error("No index defined for "+a);return b===Ed?null:b};function Qd(a,b,c){var d=gc(a.ad,function(d,f){var g=J(a.Rb,f);C(g,"Missing index implementation for "+f);if(d===Ed){if(g.rc(b.node)){for(var k=[],l=c.Mb(ua),m=P(l);m;)m.name!=b.name&&k.push(m),m=P(l);k.push(b);return Rd(k,Fd(g))}return Ed}g=c.get(b.name);k=d;g&&(k=k.remove(new v(b.name,g)));return k.Pa(b,b.node)});return new Pd(d,a.Rb)}
function Sd(a,b,c){var d=gc(a.ad,function(a){if(a===Ed)return a;var d=c.get(b.name);return d?a.remove(new v(b.name,d)):a});return new Pd(d,a.Rb)}var Td=new Pd({".priority":Ed},{".priority":E});function Ma(a,b){this.I=a;C(n(this.I)&&null!==this.I,"LeafNode shouldn't be created with null/undefined value.");this.ia=b||N;Ud(this.ia);this.tb=null}h=Ma.prototype;h.R=function(){return!0};h.G=function(){return this.ia};h.fa=function(a){return new Ma(this.I,a)};h.P=function(a){return".priority"===a?this.ia:N};h.ma=function(a){return a.f()?this:".priority"===B(a)?this.ia:N};h.Ga=function(){return!1};h.Rd=function(){return null};
h.U=function(a,b){return".priority"===a?this.fa(b):b.f()&&".priority"!==a?this:N.U(a,b).fa(this.ia)};h.K=function(a,b){var c=B(a);if(null===c)return b;if(b.f()&&".priority"!==c)return this;C(".priority"!==c||1===Ba(a),".priority must be the last token in a path");return this.U(c,N.K(r(a),b))};h.f=function(){return!1};h.hb=function(){return 0};h.N=function(a){return a&&!this.G().f()?{".value":this.Fa(),".priority":this.G().N()}:this.Fa()};
h.hash=function(){if(null===this.tb){var a="";this.ia.f()||(a+="priority:"+Vd(this.ia.N())+":");var b=typeof this.I,a=a+(b+":"),a="number"===b?a+vd(this.I):a+this.I;this.tb=kd(a)}return this.tb};h.Fa=function(){return this.I};h.Hb=function(a){if(a===N)return 1;if(a instanceof U)return-1;C(a.R(),"Unknown node type");var b=typeof a.I,c=typeof this.I,d=zb(Wd,b),e=zb(Wd,c);C(0<=d,"Unknown leaf type: "+b);C(0<=e,"Unknown leaf type: "+c);return d===e?"object"===c?0:this.I<a.I?-1:this.I===a.I?0:1:e-d};
var Wd=["object","boolean","number","string"];Ma.prototype.ab=function(){return this};Ma.prototype.Tb=function(){return!0};Ma.prototype.ca=function(a){return a===this?!0:a.R()?this.I===a.I&&this.ia.ca(a.ia):!1};Ma.prototype.toString=function(){return G(this.N(!0))};function U(a,b,c){this.A=a;(this.ia=b)&&Ud(this.ia);a.f()&&C(!this.ia||this.ia.f(),"An empty node cannot have a priority");this.pb=c;this.tb=null}h=U.prototype;h.R=function(){return!1};h.G=function(){return this.ia||N};h.fa=function(a){return this.A.f()?this:new U(this.A,a,this.pb)};h.P=function(a){if(".priority"===a)return this.G();a=this.A.get(a);return null===a?N:a};h.ma=function(a){var b=B(a);return null===b?this:this.P(b).ma(r(a))};h.Ga=function(a){return null!==this.A.get(a)};
h.U=function(a,b){C(b,"We should always be passing snapshot nodes");if(".priority"===a)return this.fa(b);var c=new v(a,b),d,e;b.f()?(d=this.A.remove(a),c=Sd(this.pb,c,this.A)):(d=this.A.Pa(a,b),c=Qd(this.pb,c,this.A));e=d.f()?N:this.ia;return new U(d,e,c)};h.K=function(a,b){var c=B(a);if(null===c)return b;C(".priority"!==B(a)||1===Ba(a),".priority must be the last token in a path");var d=this.P(c).K(r(a),b);return this.U(c,d)};h.f=function(){return this.A.f()};h.hb=function(){return this.A.count()};
var Xd=/^(0|[1-9]\d*)$/;h=U.prototype;h.N=function(a){if(this.f())return null;var b={},c=0,d=0,e=!0;this.Y(E,function(f,g){b[f]=g.N(a);c++;e&&Xd.test(f)?d=Math.max(d,Number(f)):e=!1});if(!a&&e&&d<2*c){var f=[],g;for(g in b)f[g]=b[g];return f}a&&!this.G().f()&&(b[".priority"]=this.G().N());return b};h.hash=function(){if(null===this.tb){var a="";this.G().f()||(a+="priority:"+Vd(this.G().N())+":");this.Y(E,function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)});this.tb=""===a?"":kd(a)}return this.tb};
h.Rd=function(a,b,c){return(c=Yd(this,c))?(a=Ic(c,new v(a,b)))?a.name:null:Ic(this.A,a)};function Zd(a,b){var c;c=(c=Yd(a,b))?(c=c.xc())&&c.name:a.A.xc();return c?new v(c,a.A.get(c)):null}function $d(a,b){var c;c=(c=Yd(a,b))?(c=c.Vb())&&c.name:a.A.Vb();return c?new v(c,a.A.get(c)):null}h.Y=function(a,b){var c=Yd(this,a);return c?c.na(function(a){return b(a.name,a.node)}):this.A.na(b)};h.Mb=function(a){return this.Nb(a.yc(),a)};
h.Nb=function(a,b){var c=Yd(this,b);if(c)return c.Nb(a,function(a){return a});for(var c=this.A.Nb(a.name,ua),d=Kc(c);null!=d&&0>b.compare(d,a);)P(c),d=Kc(c);return c};h.Ge=function(a){return this.Ob(a.vc(),a)};h.Ob=function(a,b){var c=Yd(this,b);if(c)return c.Ob(a,function(a){return a});for(var c=this.A.Ob(a.name,ua),d=Kc(c);null!=d&&0<b.compare(d,a);)P(c),d=Kc(c);return c};h.Hb=function(a){return this.f()?a.f()?0:-1:a.R()||a.f()?1:a===Id?-1:0};
h.ab=function(a){if(a===Ld||nc(this.pb.Rb,a.toString()))return this;var b=this.pb,c=this.A;C(a!==Ld,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var d=[],e=!1,c=c.Mb(ua),f=P(c);f;)e=e||a.rc(f.node),d.push(f),f=P(c);var g;e?g=Rd(d,Fd(a)):g=Ed;d=a.toString();e=za(b.Rb);e[d]=a;a=za(b.ad);a[d]=g;return new U(this.A,this.ia,new Pd(a,e))};h.Tb=function(a){return a===Ld||nc(this.pb.Rb,a.toString())};
h.ca=function(a){if(a===this)return!0;if(a.R())return!1;if(this.G().ca(a.G())&&this.A.count()===a.A.count()){var b=this.Mb(E);a=a.Mb(E);for(var c=P(b),d=P(a);c&&d;){if(c.name!==d.name||!c.node.ca(d.node))return!1;c=P(b);d=P(a)}return null===c&&null===d}return!1};function Yd(a,b){return b===Ld?null:a.pb.get(b.toString())}h.toString=function(){return G(this.N(!0))};function D(a,b){if(null===a)return N;var c=null;"object"===typeof a&&".priority"in a?c=a[".priority"]:"undefined"!==typeof b&&(c=b);C(null===c||"string"===typeof c||"number"===typeof c||"object"===typeof c&&".sv"in c,"Invalid priority type found: "+typeof c);"object"===typeof a&&".value"in a&&null!==a[".value"]&&(a=a[".value"]);if("object"!==typeof a||".sv"in a)return new Ma(a,D(c));if(a instanceof Array){var d=N,e=a;O(e,function(a,b){if(x(e,b)&&"."!==b.substring(0,1)){var c=D(a);if(c.R()||!c.f())d=
d.U(b,c)}});return d.fa(D(c))}var f=[],g=!1,k=a;lb(k,function(a){if("string"!==typeof a||"."!==a.substring(0,1)){var b=D(k[a]);b.f()||(g=g||!b.G().f(),f.push(new v(a,b)))}});if(0==f.length)return N;var l=Rd(f,va,function(a){return a.name},xa);if(g){var m=Rd(f,Fd(E));return new U(l,D(c),new Pd({".priority":m},{".priority":E}))}return new U(l,D(c),Td)}var ae=Math.log(2);
function be(a){this.count=parseInt(Math.log(a+1)/ae,10);this.ye=this.count-1;this.pf=a+1&parseInt(Array(this.count+1).join("1"),2)}function ce(a){var b=!(a.pf&1<<a.ye);a.ye--;return b}
function Rd(a,b,c,d){function e(b,d){var f=d-b;if(0==f)return null;if(1==f){var m=a[b],w=c?c(m):m;return new Lc(w,m.node,Hc,null,null)}var m=parseInt(f/2,10)+b,f=e(b,m),y=e(m+1,d),m=a[m],w=c?c(m):m;return new Lc(w,m.node,Hc,f,y)}a.sort(b);var f=function(b){function d(b,g){var k=w-b,y=w;w-=b;var y=e(k+1,y),k=a[k],H=c?c(k):k,y=new Lc(H,k.node,g,null,y);f?f.left=y:m=y;f=y}for(var f=null,m=null,w=a.length,y=0;y<b.count;++y){var H=ce(b),yd=Math.pow(2,b.count-(y+1));H?d(yd,Hc):(d(yd,Hc),d(yd,Mc))}return m}(new be(a.length));
return null!==f?new Fc(d||b,f):new Fc(d||b)}function Vd(a){return"number"===typeof a?"number:"+vd(a):"string:"+a}function Ud(a){if(a.R()){var b=a.N();C("string"===typeof b||"number"===typeof b||"object"===typeof b&&x(b,".sv"),"Priority must be a string or number.")}else C(a===Id||a.f(),"priority of unexpected type.");C(a===Id||a.G().f(),"Priority nodes can't have a priority of their own.")}var N=new U(new Fc(xa),null,Td);function de(){U.call(this,new Fc(xa),N,Td)}la(de,U);h=de.prototype;
h.Hb=function(a){return a===this?0:1};h.ca=function(a){return a===this};h.G=function(){return this};h.P=function(){return N};h.f=function(){return!1};var Id=new de,Gd=new v("[MIN_NAME]",N),Nd=new v("[MAX_NAME]",Id);function ee(){this.set={}}h=ee.prototype;h.add=function(a,b){this.set[a]=null!==b?b:!0};h.contains=function(a){return x(this.set,a)};h.get=function(a){return this.contains(a)?this.set[a]:void 0};h.remove=function(a){delete this.set[a]};h.clear=function(){this.set={}};h.f=function(){return Yb(this.set)};h.count=function(){return ic(this.set)};function fe(a,b){O(a.set,function(a,d){b(d,a)})};function Ja(){this.A=this.I=null}Ja.prototype.find=function(a){if(null!=this.I)return this.I.ma(a);if(a.f()||null==this.A)return null;var b=B(a);a=r(a);return this.A.contains(b)?this.A.get(b).find(a):null};Ja.prototype.bc=function(a,b){if(a.f())this.I=b,this.A=null;else if(null!==this.I)this.I=this.I.K(a,b);else{null==this.A&&(this.A=new ee);var c=B(a);this.A.contains(c)||this.A.add(c,new Ja);c=this.A.get(c);a=r(a);c.bc(a,b)}};
function ge(a,b){if(b.f())return a.I=null,a.A=null,!0;if(null!==a.I){if(a.I.R())return!1;var c=a.I;a.I=null;c.Y(E,function(b,c){a.bc(new z(b),c)});return ge(a,b)}return null!==a.A?(c=B(b),b=r(b),a.A.contains(c)&&ge(a.A.get(c),b)&&a.A.remove(c),a.A.f()?(a.A=null,!0):!1):!0}function Ka(a,b,c){null!==a.I?c(b,a.I):a.Y(function(a,e){var f=new z(b.toString()+"/"+a);Ka(e,f,c)})}Ja.prototype.Y=function(a){null!==this.A&&fe(this.A,function(b,c){a(b,c)})};function he(a){C(ea(a)&&0<a.length,"Requires a non-empty array");this.Dd=a;this.Z={}}he.prototype.ta=function(a,b){for(var c=this.Z[a]||[],d=0;d<c.length;d++)c[d].mc.apply(c[d].context,Array.prototype.slice.call(arguments,1))};he.prototype.ub=function(a,b,c){ie(this,a);this.Z[a]=this.Z[a]||[];this.Z[a].push({mc:b,context:c});(a=this.Qd(a))&&b.apply(c,a)};he.prototype.Xb=function(a,b,c){ie(this,a);a=this.Z[a]||[];for(var d=0;d<a.length;d++)if(a[d].mc===b&&(!c||c===a[d].context)){a.splice(d,1);break}};
function ie(a,b){C(vc(a.Dd,function(a){return a===b}),"Unknown event: "+b)};function je(a,b){this.value=a;this.children=b||ke}var ke=new Fc(function(a,b){return a===b?0:a<b?-1:1});function le(a){var b=me;O(a,function(a,d){b=b.set(new z(d),a)});return b}h=je.prototype;h.f=function(){return null===this.value&&this.children.f()};function ne(a,b,c){if(null!=a.value&&c(a.value))return{path:t,value:a.value};if(b.f())return null;var d=B(b);a=a.children.get(d);return null!==a?(b=ne(a,r(b),c),null!=b?{path:(new z(d)).F(b.path),value:b.value}:null):null}
function oe(a,b){return ne(a,b,function(){return!0})}h.subtree=function(a){if(a.f())return this;var b=this.children.get(B(a));return null!==b?b.subtree(r(a)):me};h.set=function(a,b){if(a.f())return new je(b,this.children);var c=B(a),d=(this.children.get(c)||me).set(r(a),b),c=this.children.Pa(c,d);return new je(this.value,c)};
h.remove=function(a){if(a.f())return this.children.f()?me:new je(null,this.children);var b=B(a),c=this.children.get(b);return c?(a=c.remove(r(a)),b=a.f()?this.children.remove(b):this.children.Pa(b,a),null===this.value&&b.f()?me:new je(this.value,b)):this};h.get=function(a){if(a.f())return this.value;var b=this.children.get(B(a));return b?b.get(r(a)):null};
function pe(a,b,c){if(b.f())return c;var d=B(b);b=pe(a.children.get(d)||me,r(b),c);d=b.f()?a.children.remove(d):a.children.Pa(d,b);return new je(a.value,d)}function qe(a,b){return re(a,t,b)}function re(a,b,c){var d={};a.children.na(function(a,f){d[a]=re(f,b.F(a),c)});return c(b,a.value,d)}function se(a,b,c){return te(a,b,t,c)}function te(a,b,c,d){var e=a.value?d(c,a.value):!1;if(e)return e;if(b.f())return null;e=B(b);return(a=a.children.get(e))?te(a,r(b),c.F(e),d):null}
function ue(a,b,c){var d=t;if(!b.f()){var e=!0;a.value&&(e=c(d,a.value));!0===e&&(e=B(b),(a=a.children.get(e))&&ve(a,r(b),d.F(e),c))}}function ve(a,b,c,d){if(b.f())return a;a.value&&d(c,a.value);var e=B(b);return(a=a.children.get(e))?ve(a,r(b),c.F(e),d):me}function we(a,b){xe(a,t,b)}function xe(a,b,c){a.children.na(function(a,e){xe(e,b.F(a),c)});a.value&&c(b,a.value)}function ye(a,b){a.children.na(function(a,d){d.value&&b(a,d.value)})}var me=new je(null);
je.prototype.toString=function(){var a={};we(this,function(b,c){a[b.toString()]=c.toString()});return G(a)};function ze(a){this.aa=a}var Ae=new ze(new je(null));function Be(a,b,c){if(b.f())return new ze(new je(c));var d=oe(a.aa,b);if(null!=d){var e=d.path,d=d.value;b=A(e,b);d=d.K(b,c);return new ze(a.aa.set(e,d))}a=pe(a.aa,b,new je(c));return new ze(a)}function Ce(a,b,c){var d=a;lb(c,function(a,c){d=Be(d,b.F(a),c)});return d}ze.prototype.od=function(a){if(a.f())return Ae;a=pe(this.aa,a,me);return new ze(a)};function De(a,b){var c=oe(a.aa,b);return null!=c?a.aa.get(c.path).ma(A(c.path,b)):null}
function Ee(a){var b=[],c=a.aa.value;null!=c?c.R()||c.Y(E,function(a,c){b.push(new v(a,c))}):a.aa.children.na(function(a,c){null!=c.value&&b.push(new v(a,c.value))});return b}function Fe(a,b){if(b.f())return a;var c=De(a,b);return null!=c?new ze(new je(c)):new ze(a.aa.subtree(b))}ze.prototype.f=function(){return this.aa.f()};ze.prototype.apply=function(a){return Ge(t,this.aa,a)};
function Ge(a,b,c){if(null!=b.value)return c.K(a,b.value);var d=null;b.children.na(function(b,f){".priority"===b?(C(null!==f.value,"Priority writes must always be leaf nodes"),d=f.value):c=Ge(a.F(b),f,c)});c.ma(a).f()||null===d||(c=c.K(a.F(".priority"),d));return c};ma.Yf;function He(){this.X=Ae;this.Da=[];this.Ub=-1}h=He.prototype;
h.od=function(a){var b=wc(this.Da,function(b){return b.Ed===a});C(0<=b,"removeWrite called with nonexistent writeId.");var c=this.Da[b];this.Da.splice(b,1);for(var d=c.visible,e=!1,f=this.Da.length-1;d&&0<=f;){var g=this.Da[f];g.visible&&(f>=b&&Ie(g,c.path)?d=!1:c.path.contains(g.path)&&(e=!0));f--}if(d){if(e)this.X=Je(this.Da,Ke,t),0<this.Da.length?this.Ub=this.Da[this.Da.length-1].Ed:this.Ub=-1;else if(c.Ma)this.X=this.X.od(c.path);else{var k=this;O(c.children,function(a,b){k.X=k.X.od(c.path.F(b))})}return c.path}return null};
h.za=function(a,b,c,d){if(c||d){var e=Fe(this.X,a);return!d&&e.f()?b:d||null!=b||null!=De(e,t)?(e=Je(this.Da,function(b){return(b.visible||d)&&(!c||!(0<=zb(c,b.Ed)))&&(b.path.contains(a)||a.contains(b.path))},a),b=b||N,e.apply(b)):null}e=De(this.X,a);if(null!=e)return e;e=Fe(this.X,a);return e.f()?b:null!=b||null!=De(e,t)?(b=b||N,e.apply(b)):null};
h.lc=function(a,b){var c=N,d=De(this.X,a);if(d)d.R()||d.Y(E,function(a,b){c=c.U(a,b)});else if(b){var e=Fe(this.X,a);b.Y(E,function(a,b){var d=Fe(e,new z(a)).apply(b);c=c.U(a,d)});Mb(Ee(e),function(a){c=c.U(a.name,a.node)})}else e=Fe(this.X,a),Mb(Ee(e),function(a){c=c.U(a.name,a.node)});return c};h.Jc=function(a,b,c,d){C(c||d,"Either existingEventSnap or existingServerSnap must exist");a=a.F(b);if(null!=De(this.X,a))return null;a=Fe(this.X,a);return a.f()?d.ma(b):a.apply(d.ma(b))};
h.Va=function(a,b,c){a=a.F(b);var d=De(this.X,a);return null!=d?d:Pa(c,b)?Fe(this.X,a).apply(c.u().P(b)):null};h.gc=function(a){return De(this.X,a)};h.Gd=function(a,b,c,d,e,f){var g;a=Fe(this.X,a);g=De(a,t);if(null==g)if(null!=b)g=a.apply(b);else return[];g=g.ab(f);if(g.f()||g.R())return[];b=[];a=Fd(f);e=e?g.Ob(c,f):g.Nb(c,f);for(f=P(e);f&&b.length<d;)0!==a(f,c)&&b.push(f),f=P(e);return b};
function Ie(a,b){return a.Ma?a.path.contains(b):!!oc(a.children,function(c,d){return a.path.F(d).contains(b)})}function Ke(a){return a.visible}
function Je(a,b,c){for(var d=Ae,e=0;e<a.length;++e){var f=a[e];if(b(f)){var g=f.path;if(f.Ma)c.contains(g)?(g=A(c,g),d=Be(d,g,f.Ma)):g.contains(c)&&(g=A(g,c),d=Be(d,t,f.Ma.ma(g)));else if(f.children)if(c.contains(g))g=A(c,g),d=Ce(d,g,f.children);else{if(g.contains(c))if(g=A(g,c),g.f())d=Ce(d,t,f.children);else if(f=J(f.children,B(g)))f=f.ma(r(g)),d=Be(d,t,f)}else throw id("WriteRecord should have .snap or .children");}}return d}function Le(a,b){this.Cb=a;this.aa=b}h=Le.prototype;
h.za=function(a,b,c){return this.aa.za(this.Cb,a,b,c)};h.lc=function(a){return this.aa.lc(this.Cb,a)};h.Jc=function(a,b,c){return this.aa.Jc(this.Cb,a,b,c)};h.gc=function(a){return this.aa.gc(this.Cb.F(a))};h.Gd=function(a,b,c,d,e){return this.aa.Gd(this.Cb,a,b,c,d,e)};h.Va=function(a,b){return this.aa.Va(this.Cb,a,b)};h.F=function(a){return new Le(this.Cb.F(a),this.aa)};function Me(){he.call(this,["online"]);this.g=!0;if("undefined"!==typeof window&&"undefined"!==typeof window.addEventListener){var a=this;window.addEventListener("online",function(){a.g||(a.g=!0,a.ta("online",!0))},!1);window.addEventListener("offline",function(){a.g&&(a.g=!1,a.ta("online",!1))},!1)}}la(Me,he);Me.prototype.Qd=function(a){C("online"===a,"Unknown event type: "+a);return[this.g]};ca(Me);function Ne(){this.children={};this.Lc=0;this.value=null}function Oe(a,b,c){this.o=a?a:"";this.g=b?b:null;this.H=c?c:new Ne}function Pe(a,b){for(var c=b instanceof z?b:new z(b),d=a,e;null!==(e=B(c));)d=new Oe(e,d,J(d.H.children,e)||new Ne),c=r(c);return d}h=Oe.prototype;h.Fa=function(){return this.H.value};function Qe(a,b){C("undefined"!==typeof b,"Cannot set value to undefined");a.H.value=b;Re(a)}h.clear=function(){this.H.value=null;this.H.children={};this.H.Lc=0;Re(this)};
h.Wc=function(){return 0<this.H.Lc};h.f=function(){return null===this.Fa()&&!this.Wc()};h.Y=function(a){var b=this;O(this.H.children,function(c,d){a(new Oe(d,b,c))})};function Se(a,b,c,d){c&&!d&&b(a);a.Y(function(a){Se(a,b,!0,d)});c&&d&&b(a)}function Te(a,b){for(var c=a.parent();null!==c&&!b(c);)c=c.parent()}h.path=function(){return new z(null===this.g?this.o:this.g.path()+"/"+this.o)};h.name=function(){return this.o};h.parent=function(){return this.g};
function Re(a){if(null!==a.g){var b=a.g,c=a.o,d=a.f(),e=x(b.H.children,c);d&&e?(delete b.H.children[c],b.H.Lc--,Re(b)):d||e||(b.H.children[c]=a.H,b.H.Lc++,Re(b))}};function Ue(){he.call(this,["visible"]);var a,b;"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(b="visibilitychange",a="hidden"):"undefined"!==typeof document.mozHidden?(b="mozvisibilitychange",a="mozHidden"):"undefined"!==typeof document.msHidden?(b="msvisibilitychange",a="msHidden"):"undefined"!==typeof document.webkitHidden&&(b="webkitvisibilitychange",a="webkitHidden"));this.ic=!0;if(b){var c=this;document.addEventListener(b,
function(){var b=!document[a];b!==c.ic&&(c.ic=b,c.ta("visible",b))},!1)}}la(Ue,he);Ue.prototype.Qd=function(a){C("visible"===a,"Unknown event type: "+a);return[this.ic]};ca(Ue);var Ve=function(){var a=0,b=[];return function(c){var d=c===a;a=c;for(var e=Array(8),f=7;0<=f;f--)e[f]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(c%64),c=Math.floor(c/64);C(0===c,"Cannot push at time == 0");c=e.join("");if(d){for(f=11;0<=f&&63===b[f];f--)b[f]=0;b[f]++}else for(f=0;12>f;f++)b[f]=Math.floor(64*Math.random());for(f=0;12>f;f++)c+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(b[f]);C(20===c.length,"nextPushId: Length should be 20.");
return c}}();function We(){this.cb={}}
function Xe(a,b){var c=b.type,d=b.Wa;C("child_added"==c||"child_changed"==c||"child_removed"==c,"Only child changes supported for tracking");C(".priority"!==d,"Only non-priority child changes can be tracked.");var e=J(a.cb,d);if(e){var f=e.type;if("child_added"==c&&"child_removed"==f)a.cb[d]=new F("child_changed",b.Na,d,e.Na);else if("child_removed"==c&&"child_added"==f)delete a.cb[d];else if("child_removed"==c&&"child_changed"==f)a.cb[d]=new F("child_removed",e.ae,d);else if("child_changed"==c&&
"child_added"==f)a.cb[d]=new F("child_added",b.Na,d);else if("child_changed"==c&&"child_changed"==f)a.cb[d]=new F("child_changed",b.Na,d,e.ae);else throw id("Illegal combination of changes: "+b+" occurred after "+e);}else a.cb[d]=b};function Ye(a){this.$=a;this.m=a.C.m}function Ze(a,b,c,d){var e=[],f=[];Mb(b,function(b){"child_changed"===b.type&&a.m.$c(b.ae,b.Na)&&f.push(new F("child_moved",b.Na,b.Wa))});$e(a,e,"child_removed",b,d,c);$e(a,e,"child_added",b,d,c);$e(a,e,"child_moved",f,d,c);$e(a,e,"child_changed",b,d,c);$e(a,e,Ra,b,d,c);return e}function $e(a,b,c,d,e,f){d=rc(d,function(a){return a.type===c});yc(d,q(a.sf,a));Mb(d,function(c){var d=af(a,c,f);Mb(e,function(e){e.ke(c.type)&&b.push(e.createEvent(d,a.$))})})}
function af(a,b,c){"value"!==b.type&&"child_removed"!==b.type&&(b.nd=c.Rd(b.Wa,b.Na,a.m));return b}Ye.prototype.sf=function(a,b){if(null==a.Wa||null==b.Wa)throw id("Should only compare child_ events.");return this.m.compare(new v(a.Wa,a.Na),new v(b.Wa,b.Na))};function bf(){}bf.prototype.ke;bf.prototype.createEvent;bf.prototype.gb;bf.prototype.Jd;bf.prototype.matches;bf.prototype.Sd;function cf(a,b,c){this.Fb=a;this.jb=b;this.kb=c||null}h=cf.prototype;h.ke=function(a){return"value"===a};h.createEvent=function(a,b){var c=b.C.m;return new Xa("value",this,new V(a.Na,b.ac(),c))};
h.gb=function(a){var b=this.kb;if("cancel"===a.Vc()){C(this.jb,"Raising a cancel event on a listener with no cancel callback");var c=this.jb;return function(){c.call(b,a.error)}}var d=this.Fb;return function(){d.call(b,a.sd)}};h.Jd=function(a,b){return this.jb?new Ya(this,a,b):null};h.matches=function(a){return a instanceof cf?a.Fb&&this.Fb?a.Fb===this.Fb&&a.kb===this.kb:!0:!1};h.Sd=function(){return null!==this.Fb};function df(a,b,c){this.la=a;this.jb=b;this.kb=c}h=df.prototype;
h.ke=function(a){a="children_added"===a?"child_added":a;return mc(this.la,"children_removed"===a?"child_removed":a)};h.Jd=function(a,b){return this.jb?new Ya(this,a,b):null};h.createEvent=function(a,b){C(null!=a.Wa,"Child events should have a childName.");var c=b.ac().F(a.Wa);return new Xa(a.type,this,new V(a.Na,c,b.C.m),a.nd)};
h.gb=function(a){var b=this.kb;if("cancel"===a.Vc()){C(this.jb,"Raising a cancel event on a listener with no cancel callback");var c=this.jb;return function(){c.call(b,a.error)}}var d=this.la[a.Tc];return function(){d.call(b,a.sd,a.nd)}};
h.matches=function(a){if(a instanceof df){if(!this.la||!a.la)return!0;if(this.kb===a.kb){var b=ic(a.la);if(b===ic(this.la)){if(1===b){var b=jc(a.la),c=jc(this.la);return c===b&&(!a.la[b]||!this.la[c]||a.la[b]===this.la[c])}return hc(this.la,function(b,c){return a.la[c]===b})}}}return!1};h.Sd=function(){return null!==this.la};function ef(a,b){this.J=a;this.rd=b}function ff(a,b,c,d){return new ef(new Na(b,c,d),a.rd)}function gf(a){return a.J.ga?a.J.u():null}ef.prototype.D=function(){return this.rd};function Va(a){return a.rd.ga?a.rd.u():null};function hf(a,b){this.Cd=a;this.qf=b}function jf(a){this.O=a}
jf.prototype.bb=function(a,b,c,d){var e=new We,f;if(b.type===ta)b.source.Nd?c=kf(this,a,b.path,b.Ma,c,d,e):(C(b.source.Ee,"Unknown source."),f=b.source.re,c=lf(this,a,b.path,b.Ma,c,d,f,e));else if(b.type===zd)b.source.Nd?c=mf(this,a,b.path,b.children,c,d,e):(C(b.source.Ee,"Unknown source."),f=b.source.re,c=nf(this,a,b.path,b.children,c,d,f,e));else if(b.type===oa)if(b.le)if(f=b.path,null!=c.gc(f))c=a;else{b=new Ua(c,a,d);d=a.J.u();if(f.f()||".priority"===B(f))Oa(a.D())?b=c.za(Va(a)):(b=a.D().u(),
C(b instanceof U,"serverChildren would be complete if leaf node"),b=c.lc(b)),b=this.O.ya(d,b,e);else{f=B(f);var g=c.Va(f,a.D());null==g&&Pa(a.D(),f)&&(g=d.P(f));b=null!=g?this.O.K(d,f,g,b,e):a.J.u().Ga(f)?this.O.K(d,f,N,b,e):d;b.f()&&Oa(a.D())&&(d=c.za(Va(a)),d.R()&&(b=this.O.ya(b,d,e)))}d=Oa(a.D())||null!=c.gc(t);c=ff(a,b,d,this.O.Ka())}else c=of(this,a,b.path,c,d,e);else if(b.type===ra)d=b.path,b=a.D(),f=b.u(),g=b.ga||d.f(),c=pf(this,new ef(a.J,new Na(f,g,b.Kb)),d,c,Ta,e);else throw id("Unknown operation type: "+
b.type);e=kc(e.cb);d=c;b=d.J;b.ga&&(f=b.u().R()||b.u().f(),g=gf(a),(0<e.length||!a.J.ga||f&&!b.u().ca(g)||!b.u().G().ca(g.G()))&&e.push(Qa(gf(d))));return new hf(c,e)};
function pf(a,b,c,d,e,f){var g=b.J;if(null!=d.gc(c))return b;var k;if(c.f())C(Oa(b.D()),"If change path is empty, we must have complete server data"),b.D().Kb?(e=Va(b),d=d.lc(e instanceof U?e:N)):d=d.za(Va(b)),f=a.O.ya(b.J.u(),d,f);else{var l=B(c);if(".priority"==l)C(1==Ba(c),"Can't have a priority with additional path components"),f=g.u(),k=b.D().u(),d=d.Jc(c,f,k),f=null!=d?a.O.fa(f,d):g.u();else{var m=r(c);Pa(g,l)?(k=b.D().u(),d=d.Jc(c,g.u(),k),d=null!=d?g.u().P(l).K(m,d):g.u().P(l)):d=d.Va(l,b.D());
f=null!=d?a.O.K(g.u(),l,d,e,f):g.u()}}return ff(b,f,g.ga||c.f(),a.O.Ka())}function lf(a,b,c,d,e,f,g,k){var l=b.D();g=g?a.O:a.O.Lb();if(c.f())d=g.ya(l.u(),d,null);else if(g.Ka()&&!l.Kb)d=l.u().K(c,d),d=g.ya(l.u(),d,null);else{var m=B(c);if((c.f()?!l.ga||l.Kb:!Pa(l,B(c)))&&1<Ba(c))return b;d=l.u().P(m).K(r(c),d);d=".priority"==m?g.fa(l.u(),d):g.K(l.u(),m,d,Ta,null)}l=l.ga||c.f();b=new ef(b.J,new Na(d,l,g.Ka()));return pf(a,b,c,e,new Ua(e,b,f),k)}
function kf(a,b,c,d,e,f,g){var k=b.J;e=new Ua(e,b,f);if(c.f())g=a.O.ya(b.J.u(),d,g),a=ff(b,g,!0,a.O.Ka());else if(f=B(c),".priority"===f)g=a.O.fa(b.J.u(),d),a=ff(b,g,k.ga,k.Kb);else{var l=r(c);c=k.u().P(f);if(!l.f()){var m=e.Fe(f);d=null!=m?".priority"===Ca(l)&&m.ma(l.parent()).f()?m:m.K(l,d):N}c.ca(d)?a=b:(g=a.O.K(k.u(),f,d,e,g),a=ff(b,g,k.ga,a.O.Ka()))}return a}
function mf(a,b,c,d,e,f,g){var k=b;we(d,function(d,m){var w=c.F(d);Pa(b.J,B(w))&&(k=kf(a,k,w,m,e,f,g))});we(d,function(d,m){var w=c.F(d);Pa(b.J,B(w))||(k=kf(a,k,w,m,e,f,g))});return k}function qf(a,b){we(b,function(b,d){a=a.K(b,d)});return a}
function nf(a,b,c,d,e,f,g,k){if(b.D().u().f()&&!Oa(b.D()))return b;var l=b;c=c.f()?d:pe(me,c,d);var m=b.D().u();c.children.na(function(c,d){if(m.Ga(c)){var H=b.D().u().P(c),H=qf(H,d);l=lf(a,l,new z(c),H,e,f,g,k)}});c.children.na(function(c,d){var H=!Oa(b.D())&&null==d.value;m.Ga(c)||H||(H=b.D().u().P(c),H=qf(H,d),l=lf(a,l,new z(c),H,e,f,g,k))});return l}
function of(a,b,c,d,e,f){if(null!=d.gc(c))return b;var g=new Ua(d,b,e),k=e=b.J.u();if(Oa(b.D())){if(c.f())e=d.za(Va(b)),k=a.O.ya(b.J.u(),e,f);else if(".priority"===B(c)){var l=d.Va(B(c),b.D());null==l||e.f()||e.G().ca(l)||(k=a.O.fa(e,l))}else l=B(c),e=d.Va(l,b.D()),null!=e&&(k=a.O.K(b.J.u(),l,e,g,f));e=!0}else if(b.J.ga||c.f())k=e,e=b.J.u(),e.R()||e.Y(E,function(c){var e=d.Va(c,b.D());null!=e&&(k=a.O.K(k,c,e,g,f))}),e=b.J.ga;else{l=B(c);if(1==Ba(c)||Pa(b.J,l))c=d.Va(l,b.D()),null!=c&&(k=a.O.K(e,l,
c,g,f));e=!1}return ff(b,k,e,a.O.Ka())};function rf(a,b){this.$=a;var c=a.C,d=new sf(c.m),c=tf(c)?new sf(c.m):c.oa?new uf(c):new vf(c);this.Se=new jf(c);var e=b.D(),f=b.J,g=d.ya(N,e.u(),null),k=c.ya(N,f.u(),null);this.Oa=new ef(new Na(k,f.ga,c.Ka()),new Na(g,e.ga,d.Ka()));this.Xa=[];this.uf=new Ye(a)}function wf(a){return a.$}h=rf.prototype;h.D=function(){return this.Oa.D().u()};h.fb=function(a){var b=Va(this.Oa);return b&&(tf(this.$.C)||!a.f()&&!b.P(B(a)).f())?b.ma(a):null};h.f=function(){return 0===this.Xa.length};h.Eb=function(a){this.Xa.push(a)};
h.ib=function(a,b){var c=[];if(b){C(null==a,"A cancel should cancel all event registrations.");var d=this.$.path;Mb(this.Xa,function(a){(a=a.Jd(b,d))&&c.push(a)})}if(a){for(var e=[],f=0;f<this.Xa.length;++f){var g=this.Xa[f];if(!g.matches(a))e.push(g);else if(a.Sd()){e=e.concat(this.Xa.slice(f+1));break}}this.Xa=e}else this.Xa=[];return c};
h.bb=function(a,b,c){a.type===zd&&null!==a.source.xb&&(C(Va(this.Oa),"We should always have a full cache before handling merges"),C(gf(this.Oa),"Missing event cache, even though we have a server cache"));var d=this.Oa;a=this.Se.bb(d,a,b,c);b=this.Se;c=a.Cd;C(c.J.u().Tb(b.O.m),"Event snap not indexed");C(c.D().u().Tb(b.O.m),"Server snap not indexed");C(Oa(a.Cd.D())||!Oa(d.D()),"Once a server snap is complete, it should never go back");this.Oa=a.Cd;return xf(this,a.qf,a.Cd.J.u(),null)};
function yf(a,b){var c=a.Oa.J,d=[];c.u().R()||c.u().Y(E,function(a,b){d.push(new F("child_added",b,a))});c.ga&&d.push(Qa(c.u()));return xf(a,d,c.u(),b)}function xf(a,b,c,d){return Ze(a.uf,b,c,d?[d]:a.Xa)};function zf(){this.Ca={}}h=zf.prototype;h.f=function(){return Yb(this.Ca)};h.bb=function(a,b,c){var d=a.source.xb;if(null!==d)return d=J(this.Ca,d),C(null!=d,"SyncTree gave us an op for an invalid query."),d.bb(a,b,c);var e=[];O(this.Ca,function(d){e=e.concat(d.bb(a,b,c))});return e};h.Eb=function(a,b,c,d,e){var f=a.Ba(),g=J(this.Ca,f);if(!g){var g=c.za(e?d:null),k=!1;g?k=!0:(g=d instanceof U?c.lc(d):N,k=!1);g=new rf(a,new ef(new Na(g,k,!1),new Na(d,e,!1)));this.Ca[f]=g}g.Eb(b);return yf(g,b)};
h.ib=function(a,b,c){var d=a.Ba(),e=[],f=[],g=null!=Af(this);if("default"===d){var k=this;O(this.Ca,function(a,d){f=f.concat(a.ib(b,c));a.f()&&(delete k.Ca[d],tf(a.$.C)||e.push(a.$))})}else{var l=J(this.Ca,d);l&&(f=f.concat(l.ib(b,c)),l.f()&&(delete this.Ca[d],tf(l.$.C)||e.push(l.$)))}g&&null==Af(this)&&e.push(new R(a.w,a.path));return{Lf:e,wf:f}};function Bf(a){return rc(kc(a.Ca),function(a){return!tf(a.$.C)})}h.fb=function(a){var b=null;O(this.Ca,function(c){b=b||c.fb(a)});return b};
function Cf(a,b){if(tf(b.C))return Af(a);var c=b.Ba();return J(a.Ca,c)}function Af(a){return pc(a.Ca,function(a){return tf(a.$.C)})||null};ma.Vf;function Df(a){this.xa=me;this.wb=new He;this.qe={};this.$b={};this.tc=a}function Ef(a,b,c,d,e){var f=a.wb,g=e;C(d>f.Ub,"Stacking an older write on top of newer ones");n(g)||(g=!0);f.Da.push({path:b,Ma:c,Ed:d,visible:g});g&&(f.X=Be(f.X,b,c));f.Ub=d;return e?Ff(a,new sa(pa,b,c)):[]}function Gf(a,b,c,d){var e=a.wb;C(d>e.Ub,"Stacking an older merge on top of newer ones");e.Da.push({path:b,children:c,Ed:d,visible:!0});e.X=Ce(e.X,b,c);e.Ub=d;c=le(c);return Ff(a,new xd(pa,b,c))}
function Hf(a,b,c){c=c||!1;b=a.wb.od(b);return null==b?[]:Ff(a,new na(b,c))}function If(a,b,c){c=le(c);return Ff(a,new xd(Cd,b,c))}function Jf(a,b,c,d){d=Kf(a,d);if(null!=d){var e=Lf(d);d=e.path;e=e.xb;b=A(d,b);c=new sa(new Bd(!1,!0,e,!0),b,c);return Mf(a,d,c)}return[]}function Nf(a,b,c,d){if(d=Kf(a,d)){var e=Lf(d);d=e.path;e=e.xb;b=A(d,b);c=le(c);c=new xd(new Bd(!1,!0,e,!0),b,c);return Mf(a,d,c)}return[]}
Df.prototype.Eb=function(a,b){var c=a.path,d=null,e=!1;ue(this.xa,c,function(a,b){var f=A(a,c);d=b.fb(f);e=e||null!=Af(b);return!d});var f=this.xa.get(c);f?(e=e||null!=Af(f),d=d||f.fb(t)):(f=new zf,this.xa=this.xa.set(c,f));var g;null!=d?g=!0:(g=!1,d=N,ye(this.xa.subtree(c),function(a,b){var c=b.fb(t);c&&(d=d.U(a,c))}));var k=null!=Cf(f,a);if(!k&&!tf(a.C)){var l=Of(a);C(!mc(this.$b,l),"View does not exist, but we have a tag");var m=Pf++;this.$b[l]=m;this.qe["_"+m]=l}g=f.Eb(a,b,new Le(c,this.wb),d,
g);k||e||(f=Cf(f,a),g=g.concat(Qf(this,a,f)));return g};
Df.prototype.ib=function(a,b,c){var d=a.path,e=this.xa.get(d),f=[];if(e&&("default"===a.Ba()||null!=Cf(e,a))){f=e.ib(a,b,c);e.f()&&(this.xa=this.xa.remove(d));e=f.Lf;f=f.wf;b=-1!==wc(e,function(a){return tf(a.C)});var g=se(this.xa,d,function(a,b){return null!=Af(b)});if(b&&!g&&(d=this.xa.subtree(d),!d.f()))for(var d=Rf(d),k=0;k<d.length;++k){var l=d[k],m=l.$,l=Sf(this,l);this.tc.ne(m,Tf(this,m),l.Xc,l.S)}if(!g&&0<e.length&&!c)if(b)this.tc.vd(a,null);else{var w=this;Mb(e,function(a){a.Ba();var b=w.$b[Of(a)];
w.tc.vd(a,b)})}Uf(this,e)}return f};Df.prototype.za=function(a,b){var c=this.wb,d=se(this.xa,a,function(b,c){var d=A(b,a);if(d=c.fb(d))return d});return c.za(a,d,b,!0)};function Rf(a){return qe(a,function(a,c,d){if(c&&null!=Af(c))return[Af(c)];var e=[];c&&(e=Bf(c));O(d,function(a){e=e.concat(a)});return e})}function Uf(a,b){for(var c=0;c<b.length;++c){var d=b[c];if(!tf(d.C)){var d=Of(d),e=a.$b[d];delete a.$b[d];delete a.qe["_"+e]}}}
function Qf(a,b,c){var d=b.path,e=Tf(a,b);c=Sf(a,c);b=a.tc.ne(b,e,c.Xc,c.S);d=a.xa.subtree(d);if(e)C(null==Af(d.value),"If we're adding a query, it shouldn't be shadowed");else for(e=qe(d,function(a,b,c){if(!a.f()&&b&&null!=Af(b))return[wf(Af(b))];var d=[];b&&(d=d.concat(sc(Bf(b),function(a){return a.$})));O(c,function(a){d=d.concat(a)});return d}),d=0;d<e.length;++d)c=e[d],a.tc.vd(c,Tf(a,c));return b}
function Sf(a,b){var c=b.$,d=Tf(a,c);return{Xc:function(){return(b.D()||N).hash()},S:function(b){if("ok"===b){if(d){var f=c.path;if(b=Kf(a,d)){var g=Lf(b);b=g.path;g=g.xb;f=A(b,f);f=new qa(new Bd(!1,!0,g,!0),f);b=Mf(a,b,f)}else b=[]}else b=Ff(a,new qa(Cd,c.path));return b}f="Unknown Error";"too_big"===b?f="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==b?f="Client doesn't have permission to access the desired data.":"unavailable"==b&&
(f="The service is unavailable");f=Error(b+": "+f);f.code=b.toUpperCase();return a.ib(c,null,f)}}}function Of(a){return a.path.toString()+"$"+a.Ba()}function Lf(a){var b=a.indexOf("$");C(-1!==b&&b<a.length-1,"Bad queryKey.");return{xb:a.substr(b+1),path:new z(a.substr(0,b))}}function Kf(a,b){var c=a.qe,d="_"+b;return null!==c&&d in c?c[d]:void 0}function Tf(a,b){var c=Of(b);return J(a.$b,c)}var Pf=1;
function Mf(a,b,c){var d=a.xa.get(b);C(d,"Missing sync point for query tag that we're tracking");return d.bb(c,new Le(b,a.wb),null)}function Ff(a,b){return Vf(a,b,a.xa,null,new Le(t,a.wb))}function Vf(a,b,c,d,e){if(b.path.f())return Wf(a,b,c,d,e);var f=c.get(t);null==d&&null!=f&&(d=f.fb(t));var g=[],k=B(b.path),l=b.Cc(k);if((c=c.children.get(k))&&l)var m=d?d.P(k):null,k=e.F(k),g=g.concat(Vf(a,l,c,m,k));f&&(g=g.concat(f.bb(b,e,d)));return g}
function Wf(a,b,c,d,e){var f=c.get(t);null==d&&null!=f&&(d=f.fb(t));var g=[];c.children.na(function(c,f){var m=d?d.P(c):null,w=e.F(c),y=b.Cc(c);y&&(g=g.concat(Wf(a,y,f,m,w)))});f&&(g=g.concat(f.bb(b,e,d)));return g};function sf(a){this.m=a}h=sf.prototype;h.K=function(a,b,c,d,e){C(a.Tb(this.m),"A node must be indexed if only a child is updated");d=a.P(b);if(d.ca(c))return a;null!=e&&(c.f()?a.Ga(b)?Xe(e,new F("child_removed",d,b)):C(a.R(),"A child remove without an old child only makes sense on a leaf node"):d.f()?Xe(e,new F("child_added",c,b)):Xe(e,new F("child_changed",c,b,d)));return a.R()&&c.f()?a:a.U(b,c).ab(this.m)};
h.ya=function(a,b,c){null!=c&&(a.R()||a.Y(E,function(a,e){b.Ga(a)||Xe(c,new F("child_removed",e,a))}),b.R()||b.Y(E,function(b,e){if(a.Ga(b)){var f=a.P(b);f.ca(e)||Xe(c,new F("child_changed",e,b,f))}else Xe(c,new F("child_added",e,b))}));return b.ab(this.m)};h.fa=function(a,b){return a.f()?N:a.fa(b)};h.Ka=function(){return!1};h.Lb=function(){return this};function vf(a){this.Td=new sf(a.m);this.m=a.m;var b;a.qa?(b=Xf(a),b=a.m.uc(Yf(a),b)):b=a.m.yc();this.Gc=b;a.sa?(b=Zf(a),a=a.m.uc($f(a),b)):a=a.m.vc();this.qc=a}h=vf.prototype;h.matches=function(a){return 0>=this.m.compare(this.Gc,a)&&0>=this.m.compare(a,this.qc)};h.K=function(a,b,c,d,e){this.matches(new v(b,c))||(c=N);return this.Td.K(a,b,c,d,e)};h.ya=function(a,b,c){b.R()&&(b=N);var d=b.ab(this.m),d=d.fa(N),e=this;b.Y(E,function(a,b){e.matches(new v(a,b))||(d=d.U(a,N))});return this.Td.ya(a,d,c)};
h.fa=function(a){return a};h.Ka=function(){return!0};h.Lb=function(){return this.Td};function uf(a){this.wa=new vf(a);this.m=a.m;C(a.oa,"Only valid if limit has been set");this.pa=a.pa;this.yb=!ag(a)}h=uf.prototype;h.K=function(a,b,c,d,e){this.wa.matches(new v(b,c))||(c=N);return a.P(b).ca(c)?a:a.hb()<this.pa?this.wa.Lb().K(a,b,c,d,e):bg(this,a,b,c,d,e)};
h.ya=function(a,b,c){var d;if(b.R()||b.f())d=N.ab(this.m);else if(2*this.pa<b.hb()&&b.Tb(this.m)){d=N.ab(this.m);b=this.yb?b.Ob(this.wa.qc,this.m):b.Nb(this.wa.Gc,this.m);for(var e=0;0<b.Ra.length&&e<this.pa;){var f=P(b),g;if(g=this.yb?0>=this.m.compare(this.wa.Gc,f):0>=this.m.compare(f,this.wa.qc))d=d.U(f.name,f.node),e++;else break}}else{d=b.ab(this.m);d=d.fa(N);var k,l,m;if(this.yb){b=d.Ge(this.m);k=this.wa.qc;l=this.wa.Gc;var w=Fd(this.m);m=function(a,b){return w(b,a)}}else b=d.Mb(this.m),k=this.wa.Gc,
l=this.wa.qc,m=Fd(this.m);for(var e=0,y=!1;0<b.Ra.length;)f=P(b),!y&&0>=m(k,f)&&(y=!0),(g=y&&e<this.pa&&0>=m(f,l))?e++:d=d.U(f.name,N)}return this.wa.Lb().ya(a,d,c)};h.fa=function(a){return a};h.Ka=function(){return!0};h.Lb=function(){return this.wa.Lb()};
function bg(a,b,c,d,e,f){var g;if(a.yb){var k=Fd(a.m);g=function(a,b){return k(b,a)}}else g=Fd(a.m);C(b.hb()==a.pa,"");var l=new v(c,d),m=a.yb?Zd(b,a.m):$d(b,a.m),w=a.wa.matches(l);if(b.Ga(c)){var y=b.P(c),m=e.Pd(a.m,m,a.yb);null!=m&&m.name==c&&(m=e.Pd(a.m,m,a.yb));e=null==m?1:g(m,l);if(w&&!d.f()&&0<=e)return null!=f&&Xe(f,new F("child_changed",d,c,y)),b.U(c,d);null!=f&&Xe(f,new F("child_removed",y,c));b=b.U(c,N);return null!=m&&a.wa.matches(m)?(null!=f&&Xe(f,new F("child_added",m.node,m.name)),b.U(m.name,
m.node)):b}return d.f()?b:w&&0<=g(m,l)?(null!=f&&(Xe(f,new F("child_removed",m.node,m.name)),Xe(f,new F("child_added",d,c))),b.U(c,d).U(m.name,N)):b};function cg(){this.Ib=this.sa=this.Bb=this.qa=this.oa=!1;this.pa=0;this.Db="";this.Sb=null;this.qb="";this.Pb=null;this.ob="";this.m=E}var dg=new cg;function ag(a){return""===a.Db?a.qa:"l"===a.Db}function Yf(a){C(a.qa,"Only valid if start has been set");return a.Sb}function Xf(a){C(a.qa,"Only valid if start has been set");return a.Bb?a.qb:"[MIN_NAME]"}function $f(a){C(a.sa,"Only valid if end has been set");return a.Pb}
function Zf(a){C(a.sa,"Only valid if end has been set");return a.Ib?a.ob:"[MAX_NAME]"}function eg(a){var b=new cg;b.oa=a.oa;b.pa=a.pa;b.qa=a.qa;b.Sb=a.Sb;b.Bb=a.Bb;b.qb=a.qb;b.sa=a.sa;b.Pb=a.Pb;b.Ib=a.Ib;b.ob=a.ob;b.m=a.m;return b}h=cg.prototype;h.Yd=function(a){var b=eg(this);b.oa=!0;b.pa=a;b.Db="";return b};h.Zd=function(a){var b=eg(this);b.oa=!0;b.pa=a;b.Db="l";return b};h.$d=function(a){var b=eg(this);b.oa=!0;b.pa=a;b.Db="r";return b};
h.td=function(a,b){var c=eg(this);c.qa=!0;n(a)||(a=null);c.Sb=a;null!=b?(c.Bb=!0,c.qb=b):(c.Bb=!1,c.qb="");return c};h.Sc=function(a,b){var c=eg(this);c.sa=!0;n(a)||(a=null);c.Pb=a;n(b)?(c.Ib=!0,c.ob=b):(c.dg=!1,c.ob="");return c};function fg(a,b){var c=eg(a);c.m=b;return c}function gg(a){var b={};a.qa&&(b.sp=a.Sb,a.Bb&&(b.sn=a.qb));a.sa&&(b.ep=a.Pb,a.Ib&&(b.en=a.ob));if(a.oa){b.l=a.pa;var c=a.Db;""===c&&(c=ag(a)?"l":"r");b.vf=c}a.m!==E&&(b.i=a.m.toString());return b}
function tf(a){return!(a.qa||a.sa||a.oa)}function hg(a){var b={};if(tf(a)&&a.m==E)return b;var c;a.m===E?c="$priority":a.m===Od?c="$value":a.m===Ld?c="$key":(C(a.m instanceof Hd,"Unrecognized index type!"),c=a.m.toString());b.orderBy=G(c);a.qa&&(b.startAt=G(a.Sb),a.Bb&&(b.startAt+=","+G(a.qb)));a.sa&&(b.endAt=G(a.Pb),a.Ib&&(b.endAt+=","+G(a.ob)));a.oa&&(ag(a)?b.limitToFirst=a.pa:b.limitToLast=a.pa);return b}h.toString=function(){return G(gg(this))};function ig(a){this.dc=ec()+ec()+ec();this.Qe=a}
ig.prototype.open=function(a,b,c){function d(){c&&(c(I("USER_CANCELLED")),c=null)}var e=this,f=Vb(vb),g;b.requestId=this.dc;b.redirectTo=f.scheme+"://"+f.host+"/blank/page.html";a+=/\?/.test(a)?"":"?";a+=Lb(b);(g=window.open(a,"_blank","location=no"))&&ga(g.addEventListener)?(g.addEventListener("loadstart",function(a){var b;if(b=a&&a.url)a:{try{var m=document.createElement("a");m.href=a.url;b=m.host===f.host&&"/blank/page.html"===m.pathname;break a}catch(w){}b=!1}b&&(a=Tb(a.url),g.removeEventListener("exit",
d),g.close(),a=new wb(null,null,{requestId:e.dc,requestKey:a}),e.Qe.requestWithCredential("/auth/session",a,c),c=null)}),g.addEventListener("exit",d)):c(I("TRANSPORT_UNAVAILABLE"))};ig.isAvailable=function(){return!NODE_CLIENT&&ib()};ig.prototype.Gb=function(){return"redirect"};function jg(a){if(!a.window_features||"undefined"!==typeof navigator&&(-1!==navigator.userAgent.indexOf("Fennec/")||-1!==navigator.userAgent.indexOf("Firefox/")&&-1!==navigator.userAgent.indexOf("Android")))a.window_features=void 0;a.window_name||(a.window_name="_blank");this.options=a}
jg.prototype.open=function(a,b,c){function d(a){g&&(document.body.removeChild(g),g=void 0);w&&(w=clearInterval(w));Rb(window,"message",e);Rb(window,"unload",d);if(m&&!a)try{m.close()}catch(b){k.postMessage("die",l)}m=k=void 0}function e(a){if(a.origin===l)try{var b=ob(a.data);"ready"===b.a?k.postMessage(y,l):"error"===b.a?(d(!1),c&&(c(b.d),c=null)):"response"===b.a&&(d(b.forceKeepWindowOpen),c&&(c(null,b.d),c=null))}catch(e){}}var f=kb(),g,k;if(!this.options.relay_url)return c(Error("invalid arguments: origin of url and relay_url must match"));
var l=Sb(a);if(l!==Sb(this.options.relay_url))c&&setTimeout(function(){c(Error("invalid arguments: origin of url and relay_url must match"))},0);else{f&&(g=document.createElement("iframe"),g.setAttribute("src",this.options.relay_url),g.style.display="none",g.setAttribute("name","__winchan_relay_frame"),document.body.appendChild(g),k=g.contentWindow);a+=(/\?/.test(a)?"":"?")+Lb(b);var m=window.open(a,this.options.window_name,this.options.window_features);k||(k=m);var w=setInterval(function(){m&&m.closed&&
(d(!1),c&&(c(I("USER_CANCELLED")),c=null))},500),y=G({a:"request",d:b});Qb(window,"unload",d);Qb(window,"message",e)}};
jg.isAvailable=function(){return!NODE_CLIENT&&"postMessage"in window&&!jb()&&!(ib()||"undefined"!==typeof navigator&&(navigator.userAgent.match(/Windows Phone/)||window.Windows&&/^ms-appx:/.test(location.href))||"undefined"!==typeof navigator&&"undefined"!==typeof window&&(navigator.userAgent.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i)||navigator.userAgent.match(/CriOS/)||navigator.userAgent.match(/Twitter for iPhone/)||navigator.userAgent.match(/FBAN\/FBIOS/)||window.navigator.standalone))&&
!("undefined"!==typeof navigator&&navigator.userAgent.match(/PhantomJS/))};jg.prototype.Gb=function(){return"popup"};function kg(a){var b={},c={},d={},e="";try{var f=a.split("."),b=ob(jd(f[0])||""),c=ob(jd(f[1])||""),e=f[2],d=c.d||{};delete c.d}catch(g){}return{ag:b,Mc:c,data:d,cg:e}}function lg(a){a=kg(a).Mc;return"object"===typeof a&&a.hasOwnProperty("iat")?J(a,"iat"):null};function mg(a,b){this.j=nd("p:rest:");this.L=a;this.vb=b;this.Ja=null;this.ha={}}function ng(a,b){if(n(b))return"tag$"+b;var c=a.C;C(tf(c)&&c.m==E,"should have a tag if it's not a default query.");return a.path.toString()}h=mg.prototype;
h.Le=function(a,b,c,d){var e=a.path.toString();this.j("Listen called for "+e+" "+a.Ba());var f=ng(a,c),g={};this.ha[f]=g;a=hg(a.C);var k=this;og(this,e+".json",a,function(a,b){var w=b;404===a&&(a=w=null);null===a&&k.vb(e,w,!1,c);J(k.ha,f)===g&&d(a?401==a?"permission_denied":"rest_error:"+a:"ok",null)})};h.Ye=function(a,b){var c=ng(a,b);delete this.ha[c]};h.V=function(a,b){this.Ja=a;var c=kg(a),d=c.data,c=c.Mc&&c.Mc.exp;b&&b("ok",{auth:d,expires:c})};h.Ad=function(a){this.Ja=null;a("ok",null)};
h.ce=function(){};h.Oe=function(){};h.gd=function(){};h.put=function(){};h.Me=function(){};h.ie=function(){};
function og(a,b,c,d){c=c||{};c.format="export";a.Ja&&(c.auth=a.Ja);var e=(a.L.zb?"https://":"http://")+a.L.host+b+"?"+Lb(c);a.j("Sending REST request for "+e);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(d&&4===f.readyState){a.j("REST Response for "+e+" received. status:",f.status,"response:",f.responseText);var b=null;if(200<=f.status&&300>f.status){try{b=ob(f.responseText)}catch(c){S("Failed to parse JSON response for "+e+": "+f.responseText)}d(null,b)}else 401!==f.status&&404!==
f.status&&S("Got unsuccessful REST response for "+e+" Status: "+f.status),d(f.status);d=null}};f.open("GET",e,!0);f.send()};function pg(a,b){this.fe=["session",a.ld,a.Wb].join(":");this.wd=b}pg.prototype.set=function(a,b){if(!b)if(this.wd.length)b=this.wd[0];else throw Error("wd.login.SessionManager : No storage options available!");b.set(this.fe,a)};pg.prototype.get=function(){var a=sc(this.wd,q(this.zf,this)),a=rc(a,function(a){return null!==a});yc(a,function(a,c){return lg(c.token)-lg(a.token)});return 0<a.length?a.shift():null};pg.prototype.zf=function(a){try{var b=a.get(this.fe);if(b&&b.token)return b}catch(c){}return null};
pg.prototype.clear=function(){var a=this;Mb(this.wd,function(b){b.remove(a.fe)})};function qg(a,b,c,d){he.call(this,["auth_status"]);this.L=a;this.$a=b;this.af=c;this.be=d;this.o=new pg(a,[rb,sb]);this.g=null;this.Ha=!1;rg(this)}la(qg,he);h=qg.prototype;h.Od=function(){return this.g||null};function rg(a){sb.get("redirect_request_id")&&sg(a);var b=a.o.get();b&&b.token?(tg(a,b),a.$a(b.token,function(c,d){ug(a,c,d,!1,b.token,b)},function(b,d){vg(a,"resumeSession()",b,d)})):tg(a,null)}
function wg(a,b,c,d,e,f){"wilddogio-demo.com"===a.L.domain&&S("Wilddog authentication is not supported on demo Wilddogs (*.wilddogio-demo.com). To secure your Wilddog, create a production Wilddog at https://www.wilddog.com.");a.$a(b,function(f,k){ug(a,f,k,!0,b,c,d||{},e)},function(b,c){vg(a,"auth()",b,c,f)})}function xg(a,b){a.o.clear();tg(a,null);a.af(function(a,d){if("ok"===a)T(b,null);else{var e=(a||"error").toUpperCase(),f=e;d&&(f+=": "+d);f=Error(f);f.code=e;T(b,f)}})}
function ug(a,b,c,d,e,f,g,k){"ok"===b?(d&&(b=c.auth,f.auth=b,f.expires=c.expires,f.token=e,c=null,b&&x(b,"uid")?c=J(b,"uid"):x(f,"uid")&&(c=J(f,"uid")),f.uid=c,c="custom",b&&x(b,"provider")?c=J(b,"provider"):x(f,"provider")&&(c=J(f,"provider")),f.provider=c,a.o.clear(),g=g||{},c=rb,"sessionOnly"===g.remember&&(c=sb),"none"!==g.remember&&a.o.set(f,c),tg(a,f)),T(k,null,f)):(a.o.clear(),tg(a,null),f=a=(b||"error").toUpperCase(),c&&(f+=": "+c),f=Error(f),f.code=a,T(k,f))}
function vg(a,b,c,d,e){S(b+" was canceled: "+d);a.o.clear();tg(a,null);a=Error(d);a.code=c.toUpperCase();T(e,a)}function yg(a,b,c,d,e){zg(a);c=new wb(d||{},{},c||{});Ag(a,NODE_CLIENT?[$b]:[fc,Xb],"/auth/"+b,c,e)}
function Bg(a,b,c,d){zg(a);var e=[jg,ig];c=yb(c);"anonymous"===b||"password"===b?setTimeout(function(){T(d,I("TRANSPORT_UNAVAILABLE"))},0):(c.yd.window_features="menubar=yes,modal=yes,alwaysRaised=yeslocation=yes,resizable=yes,scrollbars=yes,status=yes,height=625,width=625,top="+("object"===typeof screen?.5*(screen.height-625):0)+",left="+("object"===typeof screen?.5*(screen.width-625):0),c.yd.relay_url=Wb(a.L.Wb),c.yd.requestWithCredential=q(a.ec,a),Ag(a,e,"/auth/"+b,c,d))}
function sg(a){var b=sb.get("redirect_request_id");if(b){var c=sb.get("redirect_client_options");sb.remove("redirect_request_id");sb.remove("redirect_client_options");var d=[fc,Xb],b={requestId:b,requestKey:Tb(document.location.hash)},c=new wb(c,{},b);a.Ha=!0;try{document.location.hash=document.location.hash.replace(/&__wilddog_request_key=([a-zA-z0-9]*)/,"")}catch(e){}Ag(a,d,"/auth/session",c,function(){this.Ha=!1}.bind(a))}}
h.Kd=function(a,b){zg(this);var c=yb(a);c.Za._method="POST";this.ec("/users",c,function(a,c){a?T(b,a):T(b,a,c)})};h.he=function(a,b){var c=this;zg(this);var d="/users/"+encodeURIComponent(a.email),e=yb(a);e.Za._method="DELETE";this.ec(d,e,function(a,d){!a&&d&&d.uid&&c.g&&c.g.uid&&c.g.uid===d.uid&&xg(c);T(b,a)})};h.Id=function(a,b){zg(this);var c="/users/"+encodeURIComponent(a.email)+"/password",d=yb(a);d.Za._method="PUT";d.Za.password=a.newPassword;this.ec(c,d,function(a){T(b,a)})};
h.Hd=function(a,b){zg(this);var c="/users/"+encodeURIComponent(a.oldEmail)+"/email",d=yb(a);d.Za._method="PUT";d.Za.email=a.newEmail;d.Za.password=a.password;this.ec(c,d,function(a){T(b,a)})};h.je=function(a,b){zg(this);var c="/users/"+encodeURIComponent(a.email)+"/password",d=yb(a);d.Za._method="POST";this.ec(c,d,function(a){T(b,a)})};h.ec=function(a,b,c){Cg(this,NODE_CLIENT?[$b]:[fc,Xb],a,b,c)};
function Ag(a,b,c,d,e){Cg(a,b,c,d,function(b,c){!b&&c&&c.token&&c.uid?wg(a,c.token,c,d.Nc,function(a,b){a?T(e,a):T(e,null,b)}):T(e,b||I("UNKNOWN_ERROR"))})}
function Cg(a,b,c,d,e){b=rc(b,function(a){return"function"===typeof a.isAvailable&&a.isAvailable()});0===b.length?setTimeout(function(){T(e,I("TRANSPORT_UNAVAILABLE"))},0):(b=new (b.shift())(d.yd),d=mb(d.Za),d.v=(NODE_CLIENT?"node-":"js-")+CLIENT_VERSION,d.transport=b.Gb(),d.suppress_status_codes=!0,a=Ub()+"/"+a.L.Wb+c,b.open(a,d,function(a,b){if(a)T(e,a);else if(b&&b.error){var c=Error(b.error.message);c.code=b.error.code;c.details=b.error.details;T(e,c)}else T(e,null,b)}))}
function tg(a,b){var c=null!==a.g||null!==b;a.g=b;c&&a.ta("auth_status",b);a.be(null!==b)}h.Qd=function(a){C("auth_status"===a,'initial event must be of type "auth_status"');return this.Ha?null:[this.g]};function zg(a){var b=a.L;if("wilddogio.com"!==b.domain&&"wilddogio-demo.com"!==b.domain&&"auth.wilddog.com"===vb)throw Error("This custom Wilddog server ('"+a.L.domain+"') does not support delegated login.");};function Ea(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b++:2048>d?b+=2:55296<=d&&56319>=d?(b+=4,c++):b+=3}return b};var Dg=/[\[\].#$\/\u0000-\u001F\u007F]/,Eg=/[\[\].#$\u0000-\u001F\u007F]/;function Fg(a){return p(a)&&0!==a.length&&!Dg.test(a)}function Gg(a){return null===a||p(a)||fa(a)&&!qd(a)||ha(a)&&x(a,".sv")}function Hg(a,b,c,d){d&&!n(b)||Ig(L(a,1,d),b,c)}
function Ig(a,b,c){c instanceof z&&(c=new Da(c,a));if(!n(b))throw Error(a+"contains undefined "+Ga(c));if(ga(b))throw Error(a+"contains a function "+Ga(c)+" with contents: "+b.toString());if(qd(b))throw Error(a+"contains "+b.toString()+" "+Ga(c));if(p(b)&&b.length>10485760/3&&10485760<Ea(b))throw Error(a+"contains a string greater than 10485760 utf8 bytes "+Ga(c)+" ('"+b.substring(0,50)+"...')");if(ha(b)){var d=!1,e=!1;lb(b,function(b,g){if(".value"===b)d=!0;else if(".priority"!==b&&".sv"!==b&&(e=
!0,!Fg(b)))throw Error(a+" contains an invalid key ("+b+") "+Ga(c)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');c.push(b);Ig(a,g,c);c.pop()});if(d&&e)throw Error(a+' contains ".value" child '+Ga(c)+" in addition to actual children.");}}
function Jg(a,b,c){if(!ha(b)||ea(b))throw Error(L(a,1,!1)+" must be an Object containing the children to replace.");if(x(b,".value"))throw Error(L(a,1,!1)+' must not contain ".value".  To overwrite with a leaf value, just use .set() instead.');Hg(a,b,c,!1)}
function Kg(a,b,c){if(qd(c))throw Error(L(a,b,!1)+"is "+c.toString()+", but must be a valid Wilddog priority (a string, finite number, server value, or null).");if(!Gg(c))throw Error(L(a,b,!1)+"must be a valid Wilddog priority (a string, finite number, server value, or null).");}
function Lg(a,b,c){if(!c||n(b))switch(b){case "value":case "child_added":case "child_removed":case "child_changed":case "child_moved":break;default:throw Error(L(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".');}}function Mg(a,b,c,d){if((!d||n(c))&&!Fg(c))throw Error(L(a,b,d)+'was an invalid key: "'+c+'".  Wilddog keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").');}
function Ng(a,b){if(!p(b)||0===b.length||Eg.test(b))throw Error(L(a,1,!1)+'was an invalid path: "'+b+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"');}function Og(a,b){if(".info"===B(b))throw Error(a+" failed: Can't modify data under /.info/");}function Pg(a,b){if(!p(b))throw Error(L(a,1,!1)+"must be a valid credential (a string).");}function Qg(a,b,c){if(!p(c))throw Error(L(a,b,!1)+"must be a valid string.");}
function Rg(a,b,c,d){if(!d||n(c))if(!ha(c)||null===c)throw Error(L(a,b,d)+"must be a valid object.");}function Sg(a,b,c){if(!ha(b)||null===b||!x(b,c))throw Error(L(a,1,!1)+'must contain the key "'+c+'"');if(!p(J(b,c)))throw Error(L(a,1,!1)+'must contain the key "'+c+'" with type "string"');};function V(a,b,c){this.H=a;this.$=b;this.m=c}V.prototype.N=function(){K("Wilddog.DataSnapshot.val",0,0,arguments.length);return this.H.N()};V.prototype.val=V.prototype.N;V.prototype.Ae=function(){K("Wilddog.DataSnapshot.exportVal",0,0,arguments.length);return this.H.N(!0)};V.prototype.exportVal=V.prototype.Ae;V.prototype.g=function(){K("Wilddog.DataSnapshot.exists",0,0,arguments.length);return!this.H.f()};V.prototype.exists=V.prototype.g;
V.prototype.F=function(a){K("Wilddog.DataSnapshot.child",0,1,arguments.length);fa(a)&&(a=String(a));Ng("Wilddog.DataSnapshot.child",a);var b=new z(a),c=this.$.F(b);return new V(this.H.ma(b),c,E)};V.prototype.child=V.prototype.F;V.prototype.Ga=function(a){K("Wilddog.DataSnapshot.hasChild",1,1,arguments.length);Ng("Wilddog.DataSnapshot.hasChild",a);var b=new z(a);return!this.H.ma(b).f()};V.prototype.hasChild=V.prototype.Ga;
V.prototype.G=function(){K("Wilddog.DataSnapshot.getPriority",0,0,arguments.length);return this.H.G().N()};V.prototype.getPriority=V.prototype.G;V.prototype.o=function(a){K("Wilddog.DataSnapshot.forEach",1,1,arguments.length);M("Wilddog.DataSnapshot.forEach",1,a,!1);if(this.H.R())return!1;var b=this;return!!this.H.Y(this.m,function(c,d){return a(new V(d,b.$.F(c),E))})};V.prototype.forEach=V.prototype.o;
V.prototype.Wc=function(){K("Wilddog.DataSnapshot.hasChildren",0,0,arguments.length);return this.H.R()?!1:!this.H.f()};V.prototype.hasChildren=V.prototype.Wc;V.prototype.name=function(){S("Wilddog.DataSnapshot.name() being deprecated. Please use Wilddog.DataSnapshot.key() instead.");K("Wilddog.DataSnapshot.name",0,0,arguments.length);return this.key()};V.prototype.name=V.prototype.name;V.prototype.key=function(){K("Wilddog.DataSnapshot.key",0,0,arguments.length);return this.$.key()};
V.prototype.key=V.prototype.key;V.prototype.hb=function(){K("Wilddog.DataSnapshot.numChildren",0,0,arguments.length);return this.H.hb()};V.prototype.numChildren=V.prototype.hb;V.prototype.ac=function(){K("Wilddog.DataSnapshot.ref",0,0,arguments.length);return this.$};V.prototype.ref=V.prototype.ac;function W(a,b,c,d){this.w=a;this.path=b;this.C=c;this.Yb=d}
function Tg(a){var b=null,c=null;a.qa&&(b=Yf(a));a.sa&&(c=$f(a));if(a.m===Ld){if(a.qa){if("[MIN_NAME]"!=Xf(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==typeof b)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.");}if(a.sa){if("[MAX_NAME]"!=Zf(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==
typeof c)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.");}}else if(a.m===E){if(null!=b&&!Gg(b)||null!=c&&!Gg(c))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).");}else if(C(a.m instanceof Hd||a.m===Od,"unknown index type."),null!=b&&"object"===typeof b||null!=c&&"object"===typeof c)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.");
}function Ug(a){if(a.qa&&a.sa&&a.oa&&(!a.oa||""===a.Db))throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.");}function Vg(a,b){if(!0===a.Yb)throw Error(b+": You can't combine multiple orderBy calls.");}W.prototype.ac=function(){K("Query.ref",0,0,arguments.length);return new R(this.w,this.path)};W.prototype.ref=W.prototype.ac;
W.prototype.ub=function(a,b,c,d){K("Query.on",2,4,arguments.length);Lg("Query.on",a,!1);M("Query.on",2,b,!1);var e=Wg("Query.on",c,d);if("value"===a)Xg(this.w,this,new cf(b,e.cancel||null,e.context||null));else{var f={};f[a]=b;Xg(this.w,this,new df(f,e.cancel,e.context))}return b};W.prototype.on=W.prototype.ub;
W.prototype.Xb=function(a,b,c){K("Query.off",0,3,arguments.length);Lg("Query.off",a,!0);M("Query.off",2,b,!0);Bb("Query.off",3,c);var d=null,e=null;"value"===a?d=new cf(b||null,null,c||null):a&&(b&&(e={},e[a]=b),d=new df(e,null,c||null));e=this.w;d=".info"===B(this.path)?e.bd.ib(this,d):e.T.ib(this,d);bb(e.ja,this.path,d)};W.prototype.off=W.prototype.Xb;
W.prototype.o=function(a,b){function c(g){f&&(f=!1,e.Xb(a,c),b.call(d.context,g))}K("Query.once",2,4,arguments.length);Lg("Query.once",a,!1);M("Query.once",2,b,!1);var d=Wg("Query.once",arguments[2],arguments[3]),e=this,f=!0;this.ub(a,c,function(b){e.Xb(a,c);d.cancel&&d.cancel.call(d.context,b)})};W.prototype.once=W.prototype.o;
W.prototype.Yd=function(a){S("Query.limit() being deprecated. Please use Query.limitToFirst() or Query.limitToLast() instead.");K("Query.limit",1,1,arguments.length);if(!fa(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limit: First argument must be a positive integer.");if(this.C.oa)throw Error("Query.limit: Limit was already set (by another call to limit, limitToFirst, orlimitToLast.");var b=this.C.Yd(a);Ug(b);return new W(this.w,this.path,b,this.Yb)};W.prototype.limit=W.prototype.Yd;
W.prototype.Zd=function(a){K("Query.limitToFirst",1,1,arguments.length);if(!fa(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.C.oa)throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new W(this.w,this.path,this.C.Zd(a),this.Yb)};W.prototype.limitToFirst=W.prototype.Zd;
W.prototype.$d=function(a){K("Query.limitToLast",1,1,arguments.length);if(!fa(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.C.oa)throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new W(this.w,this.path,this.C.$d(a),this.Yb)};W.prototype.limitToLast=W.prototype.$d;
W.prototype.Z=function(a){K("Query.orderByChild",1,1,arguments.length);if("$key"===a)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===a)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===a)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Mg("Query.orderByChild",1,a,!1);Vg(this,"Query.orderByChild");var b=fg(this.C,new Hd(a));Tg(b);return new W(this.w,
this.path,b,!0)};W.prototype.orderByChild=W.prototype.Z;W.prototype.ta=function(){K("Query.orderByKey",0,0,arguments.length);Vg(this,"Query.orderByKey");var a=fg(this.C,Ld);Tg(a);return new W(this.w,this.path,a,!0)};W.prototype.orderByKey=W.prototype.ta;W.prototype.Ha=function(){K("Query.orderByPriority",0,0,arguments.length);Vg(this,"Query.orderByPriority");var a=fg(this.C,E);Tg(a);return new W(this.w,this.path,a,!0)};W.prototype.orderByPriority=W.prototype.Ha;
W.prototype.$a=function(){K("Query.orderByValue",0,0,arguments.length);Vg(this,"Query.orderByValue");var a=fg(this.C,Od);Tg(a);return new W(this.w,this.path,a,!0)};W.prototype.orderByValue=W.prototype.$a;
W.prototype.td=function(a,b){K("Query.startAt",0,2,arguments.length);Hg("Query.startAt",a,this.path,!0);Mg("Query.startAt",2,b,!0);var c=this.C.td(a,b);Ug(c);Tg(c);if(this.C.qa)throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");n(a)||(b=a=null);return new W(this.w,this.path,c,this.Yb)};W.prototype.startAt=W.prototype.td;
W.prototype.Sc=function(a,b){K("Query.endAt",0,2,arguments.length);Hg("Query.endAt",a,this.path,!0);Mg("Query.endAt",2,b,!0);var c=this.C.Sc(a,b);Ug(c);Tg(c);if(this.C.sa)throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new W(this.w,this.path,c,this.Yb)};W.prototype.endAt=W.prototype.Sc;
W.prototype.g=function(a,b){K("Query.equalTo",1,2,arguments.length);Hg("Query.equalTo",a,this.path,!1);Mg("Query.equalTo",2,b,!0);if(this.C.qa)throw Error("Query.equalTo: Starting point was already set (by another call to endAt or equalTo).");if(this.C.sa)throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.td(a,b).Sc(a,b)};W.prototype.equalTo=W.prototype.g;
W.prototype.toString=function(){K("Query.toString",0,0,arguments.length);for(var a=this.path,b="",c=a.da;c<a.B.length;c++)""!==a.B[c]&&(b+="/"+encodeURIComponent(String(a.B[c])));return this.w.toString()+(b||"/")};W.prototype.toString=W.prototype.toString;W.prototype.Ba=function(){var a=td(gg(this.C));return"{}"===a?"default":a};
function Wg(a,b,c){var d={cancel:null,context:null};if(b&&c)d.cancel=b,M(a,3,d.cancel,!0),d.context=c,Bb(a,4,d.context);else if(b)if("object"===typeof b&&null!==b)d.context=b;else if("function"===typeof b)d.cancel=b;else throw Error(L(a,3,!0)+" must either be a cancel callback or a context object.");return d};if(NODE_CLIENT)var Yg=require("socket.io-client");else void 0!=typeof window&&(Yg=window.io);
function Zg(a,b,c){this.we=a;this.j=nd(this.we);this.ue=this.ve=0;this.Mf=b;this.Hc=Dc(b);this.se=[];(this.Tf=0==rb.get("previous_websocket_failure"))||NODE_CLIENT||this.se.push("polling");this.se.push("websocket");this.eb=(b.zb?"https://":"http://")+b.Qa+"?v=1.0";!NODE_CLIENT&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("wilddogio.com")&&(this.eb+="&r=f");b.host!==b.Qa&&(this.eb=this.eb+"&ns="+b.Wb);c&&(this.eb=this.eb+"&s="+c)}
Zg.prototype.open=function(a,b){this.onDisconnect=b;this.onMessage=a;this.j("Websocket connecting to "+this.eb);this.ze=!1;this.Aa=Yg(this.eb,{path:"/.ws",multiplex:"false","force new connection":!0,transports:this.se});var c=this;this.Aa.on("connect",function(){c.j("Websocket connected.");c.ze=!0;if(null!=c.Aa&&null!=c.Aa.io&&null!=c.Aa.io.engine)c.Aa.io.engine.on("upgrade",function(){rb.set("previous_websocket_failure",!1)})});this.Aa.on("disconnect",function(){c.j("Socketio connection was disconnected.");
c.Aa=null;$g(c)});this.Aa.on("wd",function(a){if(null!==c.Aa)c.onMessage(a)});this.Aa.on("connect_error",function(a){c.j("Socketio error.  Closing connection.");(a=a.message||a.data)&&c.j(a);ub(c.Mf,null);rb.set("previous_websocket_failure",!0);$g(c)})};Zg.prototype.start=function(){};Zg.De=function(){Zg.Z=!0};Zg.isAvailable=function(){return!0};Zg.ta=function(){return rb.Je||!0===rb.get("previous_websocket_failure")};function ah(){rb.remove("previous_websocket_failure")}
Zg.prototype.send=function(a){this.Aa.emit("wd",a)};function bh(a){a.Ie=!0;null!=a.Aa&&a.Aa.disconnect()}function $g(a){a.Ie||(a.j("WebSocket is closing itself"),bh(a),a.onDisconnect&&(a.onDisconnect(a.ze),a.onDisconnect=null))}Zg.prototype.close=function(){this.Ie||(this.j("WebSocket is being closed"),bh(this))};function ch(){dh(this)}var eh=[Zg];function dh(a){var b=a.zd=[];ud(eh,function(a,d){d&&d.isAvailable()&&b.push(d)})}function fh(a){if(0<a.zd.length)return a.zd[0];throw Error("No transports available");};function gh(a,b,c,d,e,f){this.id=a;this.j=nd("c:"+this.id+":");this.hd=c;this.Bc=d;this.La=e;this.de=f;this.L=b;this.kd=[];this.xe=0;this.Xe=new ch;this.Ua=0;this.j("Connection created");hh(this)}
function hh(a){var b=fh(a.Xe);a.W=new b("c:"+a.id+":"+a.xe++,a.L);a.ge=b.responsesRequiredToBeHealthy||0;var c=ih(a,a.W),d=jh(a,a.W);a.Ic=a.W;a.Fc=a.W;a.M=null;a.sb=!1;setTimeout(function(){a.W&&a.W.open(c,d)},Math.floor(0));b=b.healthyTimeout||0;0<b&&(a.Yc=setTimeout(function(){a.Yc=null;a.sb||(a.W&&102400<a.W.ue?(a.j("Connection exceeded healthy timeout but has received "+a.W.ue+" bytes.  Marking connection healthy."),a.sb=!0,ah()):a.W&&10240<a.W.ve?a.j("Connection exceeded healthy timeout but has sent "+
a.W.ve+" bytes.  Leaving connection alive."):(a.j("Closing unhealthy connection after timeout."),a.close()))},Math.floor(b)))}function jh(a,b){return function(c){b===a.W?(a.W=null,c||0!==a.Ua?1===a.Ua&&a.j("Realtime connection lost."):(a.j("Realtime connection failed."),"s-"===a.L.Qa.substr(0,2)&&(rb.remove("host:"+a.L.host),a.L.Qa=a.L.host)),a.close()):b===a.M?(a.j("Secondary connection lost."),c=a.M,a.M=null,a.Ic!==c&&a.Fc!==c||a.close()):a.j("closing an old connection")}}
function ih(a,b){return function(c){if(2!=a.Ua)if(b===a.Fc){var d=sd("t",c);c=sd("d",c);if("c"==d){if(d=sd("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.sessionId=c.s;ub(a.L,f);0==a.Ua&&(a.W.start(),kh(a,a.W,d),"1.0"!==e&&S("Protocol version mismatch detected"),c=a.Xe,(c=1<c.zd.length?c.zd[1]:null)&&lh(a,c))}else if("n"===d){a.j("recvd end transmission on primary");a.Fc=a.M;for(c=0;c<a.kd.length;++c)a.fd(a.kd[c]);a.kd=[];mh(a)}else"s"===d?(a.j("Connection shutdown command received. Shutting down..."),
a.de&&(a.de(c),a.de=null),a.La=null,a.close()):"r"===d?(a.j("Reset packet received.  New host: "+c),ub(a.L,c),1===a.Ua?a.close():(nh(a),hh(a))):"e"===d?od("Server Error: "+c):"o"===d?(a.j("got pong on primary."),oh(a),ph(a)):od("Unknown control packet command: "+d)}else"d"==d&&a.fd(c)}else if(b===a.M)if(d=sd("t",c),c=sd("d",c),"c"==d)"t"in c&&(c=c.t,"a"===c?qh(a):"r"===c?(a.j("Got a reset on secondary, closing it"),a.M.close(),a.Ic!==a.M&&a.Fc!==a.M||a.close()):"o"===c&&(a.j("got pong on secondary."),
a.Ve--,qh(a)));else if("d"==d)a.kd.push(c);else throw Error("Unknown protocol layer: "+d);else a.j("message on old connection")}}gh.prototype.Ia=function(a){rh(this,{t:"d",d:a})};function mh(a){a.Ic===a.M&&a.Fc===a.M&&(a.j("cleaning up and promoting a connection: "+a.M.we),a.W=a.M,a.M=null)}
function qh(a){0>=a.Ve?(a.j("Secondary connection is healthy."),a.sb=!0,ah(),a.M.start(),a.j("sending client ack on secondary"),a.M.send({t:"c",d:{t:"a",d:{}}}),a.j("Ending transmission on primary"),a.W.send({t:"c",d:{t:"n",d:{}}}),a.Ic=a.M,mh(a)):(a.j("sending ping on secondary."),a.M.send({t:"c",d:{t:"p",d:{}}}))}gh.prototype.fd=function(a){oh(this);this.hd(a)};function oh(a){a.sb||(a.ge--,0>=a.ge&&(a.j("Primary connection is healthy."),a.sb=!0,ah()))}
function lh(a,b){a.M=new b("c:"+a.id+":"+a.xe++,a.L,a.sessionId);a.Ve=b.responsesRequiredToBeHealthy||0;a.M.open(ih(a,a.M),jh(a,a.M));setTimeout(function(){a.M&&(a.j("Timed out trying to upgrade."),a.M.close())},Math.floor(6E4))}function kh(a,b,c){a.j("Realtime connection established.");a.W=b;a.Ua=1;a.Bc&&(a.Bc(c),a.Bc=null);0===a.ge?(a.j("Primary connection is healthy."),a.sb=!0):setTimeout(function(){ph(a)},Math.floor(5E3))}
function ph(a){a.sb||1!==a.Ua||(a.j("sending ping on primary."),rh(a,{t:"c",d:{t:"p",d:{}}}))}function rh(a,b){if(1!==a.Ua)throw"Connection is not connected";a.Ic.send(b)}gh.prototype.close=function(){2!==this.Ua&&(this.j("Closing realtime connection."),this.Ua=2,nh(this),this.La&&(this.La(),this.La=null))};function nh(a){a.j("Shutting down all connections");a.W&&(a.W.close(),a.W=null);a.M&&(a.M.close(),a.M=null);a.Yc&&(clearTimeout(a.Yc),a.Yc=null)};function sh(a,b,c,d){this.id=sh.o++;this.j=nd("p:"+this.id+":");this.Ke=this.Wd=!1;this.ha={};this.ua=[];this.Dc=0;this.Ac=[];this.ra=!1;this.Ya=1E3;this.dd=3E5;this.vb=b;this.zc=c;this.ee=d;this.L=a;this.me=null;this.pd={};this.Nf=0;this.Be=!0;this.sc=this.Xd=null;th(this,0);Ue.mb().ub("visible",this.If,this);-1===a.host.indexOf("wd.ocal")&&Me.mb().ub("online",this.Gf,this)}sh.o=0;sh.g=0;h=sh.prototype;
h.Ia=function(a,b,c){var d=++this.Nf;a={r:d,a:a,b:b};this.j(G(a));C(this.ra,"sendRequest call when we're not connected not allowed.");this.Ta.Ia(a);c&&(this.pd[d]=c)};h.Le=function(a,b,c,d){var e=a.Ba(),f=a.path.toString();this.j("Listen called for "+f+" "+e);this.ha[f]=this.ha[f]||{};C(!this.ha[f][e],"listen() called twice for same path/queryId.");a={S:d,Xc:b,Jf:a,tag:c};this.ha[f][e]=a;this.ra&&uh(this,a)};
function uh(a,b){var c=b.Jf,d=c.path.toString(),e=c.Ba();a.j("Listen on "+d+" for "+e);var f={p:d};b.tag&&(f.q=gg(c.C),f.t=b.tag);f.h=b.Xc();a.Ia("q",f,function(f){var k=f.d,l=f.s;if(k&&"object"===typeof k&&x(k,"w")){var m=J(k,"w");ea(m)&&0<=zb(m,"no_index")&&S("Using an unspecified index. Consider adding "+('".indexOn": "'+c.C.m.toString()+'"')+" at "+c.path.toString()+" to your security rules for better performance")}(a.ha[d]&&a.ha[d][e])===b&&(a.j("listen response",f),"ok"!==l&&vh(a,d,e),b.S&&
b.S(l,k))})}h.V=function(a,b,c){this.Ja={tf:a,Ce:!1,mc:b,Kc:c};this.j("Authenticating using credential: "+a);wh(this);(b=40==a.length)||(a=kg(a).Mc,b="object"===typeof a&&!0===J(a,"admin"));b&&(this.j("Admin auth credential detected.  Reducing max reconnect time."),this.dd=3E4)};h.Ad=function(a){delete this.Ja;this.ra&&this.Ia("unauth",{},function(b){a(b.s,b.d)})};
function wh(a){var b=a.Ja;a.ra&&b&&a.Ia("auth",{cred:b.tf},function(c){var d=c.s;c=c.d||"error";"ok"!==d&&a.Ja===b&&delete a.Ja;b.Ce?"ok"!==d&&b.Kc&&b.Kc(d,c):(b.Ce=!0,b.mc&&b.mc(d,c))})}h.Ye=function(a,b){var c=a.path.toString(),d=a.Ba();this.j("Unlisten called for "+c+" "+d);if(vh(this,c,d)&&this.ra){var e=gg(a.C);this.j("Unlisten on "+c+" for "+d);c={p:c};b&&(c.q=e,c.t=b);this.Ia("n",c)}};h.ce=function(a,b,c){this.ra?xh(this,"o",a,b,c):this.Ac.push({Zb:a,action:"o",data:b,S:c})};
h.Oe=function(a,b,c){this.ra?xh(this,"om",a,b,c):this.Ac.push({Zb:a,action:"om",data:b,S:c})};h.gd=function(a,b){this.ra?xh(this,"oc",a,null,b):this.Ac.push({Zb:a,action:"oc",data:null,S:b})};function xh(a,b,c,d,e){c={p:c,d:d};a.j("onDisconnect "+b,c);a.Ia(b,c,function(a){e&&setTimeout(function(){e(a.s,a.d)},Math.floor(0))})}h.put=function(a,b,c,d){yh(this,"p",a,b,c,d)};h.Me=function(a,b,c,d){yh(this,"m",a,b,c,d)};
function yh(a,b,c,d,e,f){d={p:c,d:d};n(f)&&(d.h=f);a.ua.push({action:b,request:d,S:e});a.Dc++;b=a.ua.length-1;a.ra?zh(a,b):a.j("Buffering put: "+c)}function zh(a,b){var c=a.ua[b].action,d=a.ua[b].request,e=a.ua[b].S;a.ua[b].Kf=a.ra;a.Ia(c,d,function(d){a.j(c+" response",d);delete a.ua[b];a.Dc--;0===a.Dc&&(a.ua=[]);e&&e(d.s,d.d)})}h.ie=function(a){if(this.ra){a={c:a};this.j("reportStats",a);var b=this;this.Ia("s",a,function(a){"ok"!==a.s&&b.j("reportStats","Error sending stats: "+a.d)})}};
h.fd=function(a){if("r"in a){this.j("from server: "+G(a));var b=a.r,c=this.pd[b];c&&(delete this.pd[b],c(a.b))}else{if("error"in a)throw"A server-side error has occurred: "+a.error;"a"in a&&(b=a.a,c=a.b,this.j("handleServerMessage",b,c),"d"===b?this.vb(c.p,c.d,!1,c.t):"m"===b?this.vb(c.p,c.d,!0,c.t):"c"===b?Ah(this,c.p,c.q):"ac"===b?(a=c.s,b=c.d,c=this.Ja,delete this.Ja,c&&c.Kc&&c.Kc(a,b)):"sd"===b?this.me?this.me(c):"msg"in c&&"undefined"!==typeof console&&console.log("WILDDOG: "+c.msg.replace("\n",
"\nWILDDOG: ")):od("Unrecognized action received from server: "+G(b)+"\nAre you using the latest client?"))}};h.Bc=function(a){this.j("connection ready");this.ra=!0;this.sc=(new Date).getTime();this.ee({serverTimeOffset:a-(new Date).getTime()});this.Be&&(a={},a["sdk.js."+CLIENT_VERSION.replace(/\./g,"-")]=1,ib()&&(a["framework.cordova"]=1),this.ie(a));Bh(this);this.Be=!1;this.zc(!0)};
function th(a,b){C(!a.Ta,"Scheduling a connect when we're already connected/ing?");a.Jb&&clearTimeout(a.Jb);a.Jb=setTimeout(function(){a.Jb=null;Ch(a)},Math.floor(b))}h.If=function(a){a&&!this.ic&&this.Ya===this.dd&&(this.j("Window became visible.  Reducing delay."),this.Ya=1E3,this.Ta||th(this,0));this.ic=a};h.Gf=function(a){a?(this.j("Browser went online."),this.Ya=1E3,this.Ta||th(this,0)):(this.j("Browser went offline.  Killing connection."),this.Ta&&this.Ta.close())};
h.Pe=function(){this.j("data client disconnected");this.ra=!1;this.Ta=null;for(var a=0;a<this.ua.length;a++){var b=this.ua[a];b&&"h"in b.request&&b.Kf&&(b.S&&b.S("disconnect"),delete this.ua[a],this.Dc--)}0===this.Dc&&(this.ua=[]);this.pd={};Dh(this)&&(this.ic?this.sc&&(3E4<(new Date).getTime()-this.sc&&(this.Ya=1E3),this.sc=null):(this.j("Window isn't visible.  Delaying reconnect."),this.Ya=this.dd,this.Xd=(new Date).getTime()),a=Math.max(0,this.Ya-((new Date).getTime()-this.Xd)),a*=Math.random(),
this.j("Trying to reconnect in "+a+"ms"),th(this,a),this.Ya=Math.min(this.dd,1.3*this.Ya));this.zc(!1)};function Ch(a){if(Dh(a)){a.j("Making a connection attempt");a.Xd=(new Date).getTime();a.sc=null;var b=q(a.fd,a),c=q(a.Bc,a),d=q(a.Pe,a),e=a.id+":"+sh.g++;a.Ta=new gh(e,a.L,b,c,d,function(b){S(b+" ("+a.L.toString()+")");a.Ke=!0})}}h.rb=function(){this.Wd=!0;this.Ta?this.Ta.close():(this.Jb&&(clearTimeout(this.Jb),this.Jb=null),this.ra&&this.Pe())};
h.fc=function(){this.Wd=!1;this.Ya=1E3;this.Ta||th(this,0)};function Ah(a,b,c){c=c?sc(c,function(a){return td(a)}).join("$"):"default";(a=vh(a,b,c))&&a.S&&a.S("permission_denied")}function vh(a,b,c){b=(new z(b)).toString();var d;n(a.ha[b])?(d=a.ha[b][c],delete a.ha[b][c],0===ic(a.ha[b])&&delete a.ha[b]):d=void 0;return d}
function Bh(a){wh(a);O(a.ha,function(b){O(b,function(b){uh(a,b)})});for(var b=0;b<a.ua.length;b++)a.ua[b]&&zh(a,b);for(;a.Ac.length;)b=a.Ac.shift(),xh(a,b.action,b.Zb,b.data,b.S)}function Dh(a){var b;b=Me.mb().g;return!a.Ke&&!a.Wd&&b};function Eh(a,b){this.L=a;this.Hc=Dc(a);this.ja=new Za;this.ed=1;this.Sa=null;this.ea;b||0<=("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)?(this.ea=new mg(this.L,q(this.vb,this)),setTimeout(q(this.zc,this,!0),0)):this.ea=this.Sa=new sh(this.L,q(this.vb,this),q(this.zc,this),q(this.ee,this));this.Rf=Ec(a,q(function(){return new Aa(this.Hc,this.ea)},this));this.hc=new Oe;
this.Ud=new Ob;var c=this;this.bd=new Df({ne:function(a,b,f,g){b=[];f=c.Ud.u(a.path);f.f()||(b=Ff(c.bd,new sa(Cd,a.path,f)),setTimeout(function(){g("ok")},0));return b},vd:ba});Fh(this,"connected",!1);this.La=new Ja;this.V=new qg(a,q(this.ea.V,this.ea),q(this.ea.Ad,this.ea),q(this.be,this));this.Rc=0;this.Vd=null;this.T=new Df({ne:function(a,b,f,g){c.ea.Le(a,f,b,function(b,e){var f=g(b,e);db(c.ja,a.path,f)});return[]},vd:function(a,b){c.ea.Ye(a,b)}})}h=Eh.prototype;
h.toString=function(){return(this.L.zb?"https://":"http://")+this.L.host};h.name=function(){return this.L.Wb};function Gh(a){a=a.Ud.u(new z(".info/serverTimeOffset")).N()||0;return(new Date).getTime()+a}function Hh(a){a=a={timestamp:Gh(a)};a.timestamp=a.timestamp||(new Date).getTime();return a}
h.vb=function(a,b,c,d){this.Rc++;var e=new z(a);b=this.Vd?this.Vd(a,b):b;a=[];d?c?(b=gc(b,function(a){return D(a)}),a=Nf(this.T,e,b,d)):(b=D(b),a=Jf(this.T,e,b,d)):c?(d=gc(b,function(a){return D(a)}),a=If(this.T,e,d)):(d=D(b),a=Ff(this.T,new sa(Cd,e,d)));d=e;0<a.length&&(d=Ih(this,e));db(this.ja,d,a)};h.zc=function(a){Fh(this,"connected",a);!1===a&&Jh(this)};h.ee=function(a){var b=this;ud(a,function(a,d){Fh(b,d,a)})};h.be=function(a){Fh(this,"authenticated",a)};
function Fh(a,b,c){b=new z("/.info/"+b);c=D(c);var d=a.Ud;d.qd=d.qd.K(b,c);c=Ff(a.bd,new sa(Cd,b,c));db(a.ja,b,c)}h.Ab=function(a,b,c,d){this.j("set",{path:a.toString(),value:b,bg:c});var e=Hh(this);b=D(b,c);var e=La(b,e),f=this.ed++,e=Ef(this.T,a,e,f,!0);$a(this.ja,e);var g=this;this.ea.put(a.toString(),b.N(!0),function(b,c){var e="ok"===b;e||S("set at "+a+" failed: "+b);e=Hf(g.T,f,!e);db(g.ja,a,e);Kh(d,b,c)});e=Lh(this,a);Ih(this,e);db(this.ja,e,[])};
h.update=function(a,b,c){this.j("update",{path:a.toString(),value:b});var d=!0,e=Hh(this),f={};O(b,function(a,b){d=!1;var c=D(a);f[b]=La(c,e)});if(d)fb("update() called with empty data.  Don't do anything."),Kh(c,"ok");else{var g=this.ed++,k=Gf(this.T,a,f,g);$a(this.ja,k);var l=this;this.ea.Me(a.toString(),b,function(b,d){var e="ok"===b;e||S("update at "+a+" failed: "+b);var e=Hf(l.T,g,!e),f=a;0<e.length&&(f=Ih(l,a));db(l.ja,f,e);Kh(c,b,d)});b=Lh(this,a);Ih(this,b);db(this.ja,a,[])}};
function Jh(a){a.j("onDisconnectEvents");var b=Hh(a),c=[];Ka(Ia(a.La,b),t,function(b,e){c=c.concat(Ff(a.T,new sa(Cd,b,e)));var f=Lh(a,b);Ih(a,f)});a.La=new Ja;db(a.ja,t,c)}h.gd=function(a,b){var c=this;this.ea.gd(a.toString(),function(d,e){"ok"===d&&ge(c.La,a);Kh(b,d,e)})};function Mh(a,b,c,d){var e=D(c);a.ea.ce(b.toString(),e.N(!0),function(c,g){"ok"===c&&a.La.bc(b,e);Kh(d,c,g)})}function Nh(a,b,c,d,e){var f=D(c,d);a.ea.ce(b.toString(),f.N(!0),function(c,d){"ok"===c&&a.La.bc(b,f);Kh(e,c,d)})}
function Oh(a,b,c,d){var e=!0,f;for(f in c)e=!1;e?(fb("onDisconnect().update() called with empty data.  Don't do anything."),Kh(d,"ok")):a.ea.Oe(b.toString(),c,function(e,f){if("ok"===e)for(var l in c){var m=D(c[l]);a.La.bc(b.F(l),m)}Kh(d,e,f)})}function Xg(a,b,c){c=".info"===B(b.path)?a.bd.Eb(b,c):a.T.Eb(b,c);bb(a.ja,b.path,c)}h.rb=function(){this.Sa&&this.Sa.rb()};h.fc=function(){this.Sa&&this.Sa.fc()};
h.oe=function(a){if("undefined"!==typeof console){a?(this.ud||(this.ud=new ya(this.Hc)),a=this.ud.get()):a=this.Hc.get();var b=tc(lc(a),function(a,b){return Math.max(b.length,a)},0),c;for(c in a){for(var d=a[c],e=c.length;e<b+2;e++)c+=" ";console.log(c+d)}}};h.pe=function(a){var b=this.Hc,c;n(c)||(c=1);x(b.oc,a)||(b.oc[a]=0);b.oc[a]+=c;this.Rf.We[a]=!0};h.j=function(a){var b="";this.Sa&&(b=this.Sa.id+":");fb(b,arguments)};
function Kh(a,b,c){a&&gb(function(){if("ok"==b)a(null);else{var d=(b||"error").toUpperCase(),e=d;c&&(e+=": "+c);e=Error(e);e.code=d;a(e)}})};ma.Wf;
function Ph(a,b,c,d,e){function f(){}a.j("transaction on "+b);var g=new R(a,b);g.ub("value",f);c={path:b,update:c,S:d,status:null,Re:hd(),te:e,Ue:0,Bd:function(){g.Xb("value",f)},Fd:null,Ea:null,Oc:null,Pc:null,Qc:null};d=a.T.za(b,void 0)||N;c.Oc=d;d=c.update(d.N());if(n(d)){Ig("transaction failed: Data returned ",d,c.path);c.status=1;e=Pe(a.hc,b);var k=e.Fa()||[];k.push(c);Qe(e,k);"object"===typeof d&&null!==d&&x(d,".priority")?(k=J(d,".priority"),C(Gg(k),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):k=
(a.T.za(b)||N).G().N();e=Hh(a);d=D(d,k);e=La(d,e);c.Pc=d;c.Qc=e;c.Ea=a.ed++;c=Ef(a.T,b,e,c.Ea,c.te);db(a.ja,b,c);Qh(a)}else c.Bd(),c.Pc=null,c.Qc=null,c.S&&(a=new V(c.Oc,new R(a,c.path),E),c.S(null,!1,a))}function Qh(a,b){var c=b||a.hc;b||Rh(a,c);if(null!==c.Fa()){var d=Sh(a,c);C(0<d.length,"Sending zero length transaction queue");uc(d,function(a){return 1===a.status})&&Th(a,c.path(),d)}else c.Wc()&&c.Y(function(b){Qh(a,b)})}
function Th(a,b,c){for(var d=sc(c,function(a){return a.Ea}),e=a.T.za(b,d)||N,d=e,e=e.hash(),f=0;f<c.length;f++){var g=c[f];C(1===g.status,"tryToSendTransactionQueue_: items in queue should all be run.");g.status=2;g.Ue++;var k=A(b,g.path),d=d.K(k,g.Pc)}d=d.N(!0);a.ea.put(b.toString(),d,function(d){a.j("transaction put response",{path:b.toString(),status:d});var e=[];if("ok"===d){d=[];for(f=0;f<c.length;f++){c[f].status=3;e=e.concat(Hf(a.T,c[f].Ea));if(c[f].S){var g=c[f].Qc,k=new R(a,c[f].path);d.push(q(c[f].S,
null,null,!0,new V(g,k,E)))}c[f].Bd()}Rh(a,Pe(a.hc,b));Qh(a);db(a.ja,b,e);for(f=0;f<d.length;f++)gb(d[f])}else{if("datastale"===d)for(f=0;f<c.length;f++)c[f].status=4===c[f].status?5:1;else for(S("transaction at "+b.toString()+" failed: "+d),f=0;f<c.length;f++)c[f].status=5,c[f].Fd=d;Ih(a,b)}},e)}function Ih(a,b){var c=Uh(a,b),d=c.path(),c=Sh(a,c);Vh(a,c,d);return d}
function Vh(a,b,c){if(0!==b.length){for(var d=[],e=[],f=sc(b,function(a){return a.Ea}),g=0;g<b.length;g++){var k=b[g],l=A(c,k.path),m=!1,w;C(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===k.status)m=!0,w=k.Fd,e=e.concat(Hf(a.T,k.Ea,!0));else if(1===k.status)if(25<=k.Ue)m=!0,w="maxretry",e=e.concat(Hf(a.T,k.Ea,!0));else{var y=a.T.za(k.path,f)||N;k.Oc=y;var H=b[g].update(y.N());n(H)?(Ig("transaction failed: Data returned ",H,k.path),l=D(H),"object"===typeof H&&null!=
H&&x(H,".priority")||(l=l.fa(y.G())),y=k.Ea,H=Hh(a),H=La(l,H),k.Pc=l,k.Qc=H,k.Ea=a.ed++,xc(f,y),e=e.concat(Ef(a.T,k.path,H,k.Ea,k.te)),e=e.concat(Hf(a.T,y,!0))):(m=!0,w="nodata",e=e.concat(Hf(a.T,k.Ea,!0)))}db(a.ja,c,e);e=[];m&&(b[g].status=3,setTimeout(b[g].Bd,Math.floor(0)),b[g].S&&("nodata"===w?(k=new R(a,b[g].path),d.push(q(b[g].S,null,null,!1,new V(b[g].Oc,k,E)))):d.push(q(b[g].S,null,Error(w),!1,null))))}Rh(a,a.hc);for(g=0;g<d.length;g++)gb(d[g]);Qh(a)}}
function Uh(a,b){for(var c,d=a.hc;null!==(c=B(b))&&null===d.Fa();)d=Pe(d,c),b=r(b);return d}function Sh(a,b){var c=[];Wh(a,b,c);c.sort(function(a,b){return a.Re-b.Re});return c}function Wh(a,b,c){var d=b.Fa();if(null!==d)for(var e=0;e<d.length;e++)c.push(d[e]);b.Y(function(b){Wh(a,b,c)})}function Rh(a,b){var c=b.Fa();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d;Qe(b,0<c.length?c:null)}b.Y(function(b){Rh(a,b)})}
function Lh(a,b){var c=Uh(a,b).path(),d=Pe(a.hc,b);Te(d,function(b){Xh(a,b)});Xh(a,d);Se(d,function(b){Xh(a,b)});return c}
function Xh(a,b){var c=b.Fa();if(null!==c){for(var d=[],e=[],f=-1,g=0;g<c.length;g++)4!==c[g].status&&(2===c[g].status?(C(f===g-1,"All SENT items should be at beginning of queue."),f=g,c[g].status=4,c[g].Fd="set"):(C(1===c[g].status,"Unexpected transaction status in abort"),c[g].Bd(),e=e.concat(Hf(a.T,c[g].Ea,!0)),c[g].S&&d.push(q(c[g].S,null,Error("set"),!1,null))));-1===f?Qe(b,null):c.length=f+1;db(a.ja,b.path(),e);for(g=0;g<d.length;g++)gb(d[g])}};function Yh(){this.cc={};this.Ze=!1}ca(Yh);Yh.prototype.rb=function(){for(var a in this.cc)this.cc[a].rb()};Yh.prototype.interrupt=Yh.prototype.rb;Yh.prototype.fc=function(){for(var a in this.cc)this.cc[a].fc()};Yh.prototype.resume=Yh.prototype.fc;Yh.prototype.Md=function(){this.Ze=!0};var X={xf:function(){Ab.Xf.De();Ab.bf.$f()}};X.forceLongPolling=X.xf;X.yf=function(){Ab.bf.De()};X.forceWebSockets=X.yf;X.Qf=function(a,b){a.w.Sa.me=b};X.setSecurityDebugCallback=X.Qf;X.oe=function(a,b){a.w.oe(b)};X.stats=X.oe;X.pe=function(a,b){a.w.pe(b)};X.statsIncrementCounter=X.pe;X.Rc=function(a){return a.w.Rc};X.dataUpdateCount=X.Rc;X.Bf=function(a,b){a.w.Vd=b};X.interceptServerData=X.Bf;X.Ff=function(a){new bc(a)};X.onPopupOpen=X.Ff;X.Of=function(a){vb=a};X.setAuthenticationServer=X.Of;function Y(a,b){this.Ec=a;this.va=b}Y.prototype.cancel=function(a){K("Wilddog.onDisconnect().cancel",0,1,arguments.length);M("Wilddog.onDisconnect().cancel",1,a,!0);this.Ec.gd(this.va,a||null)};Y.prototype.cancel=Y.prototype.cancel;Y.prototype.remove=function(a){K("Wilddog.onDisconnect().remove",0,1,arguments.length);Og("Wilddog.onDisconnect().remove",this.va);M("Wilddog.onDisconnect().remove",1,a,!0);Mh(this.Ec,this.va,null,a)};Y.prototype.remove=Y.prototype.remove;
Y.prototype.set=function(a,b){K("Wilddog.onDisconnect().set",1,2,arguments.length);Og("Wilddog.onDisconnect().set",this.va);Hg("Wilddog.onDisconnect().set",a,this.va,!1);M("Wilddog.onDisconnect().set",2,b,!0);Mh(this.Ec,this.va,a,b)};Y.prototype.set=Y.prototype.set;
Y.prototype.Ab=function(a,b,c){K("Wilddog.onDisconnect().setWithPriority",2,3,arguments.length);Og("Wilddog.onDisconnect().setWithPriority",this.va);Hg("Wilddog.onDisconnect().setWithPriority",a,this.va,!1);Kg("Wilddog.onDisconnect().setWithPriority",2,b);M("Wilddog.onDisconnect().setWithPriority",3,c,!0);Nh(this.Ec,this.va,a,b,c)};Y.prototype.setWithPriority=Y.prototype.Ab;
Y.prototype.update=function(a,b){K("Wilddog.onDisconnect().update",1,2,arguments.length);Og("Wilddog.onDisconnect().update",this.va);if(ea(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c;S("Passing an Array to Wilddog.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jg("Wilddog.onDisconnect().update",a,this.va);M("Wilddog.onDisconnect().update",2,b,!0);Oh(this.Ec,
this.va,a,b)};Y.prototype.update=Y.prototype.update;var Z={};Z.jc=sh;Z.DataConnection=Z.jc;sh.prototype.o=function(a,b){this.Ia("q",{p:a},b)};Z.jc.prototype.simpleListen=Z.jc.prototype.o;sh.prototype.g=function(a,b){this.Ia("echo",{d:a},b)};Z.jc.prototype.echo=Z.jc.prototype.g;sh.prototype.interrupt=sh.prototype.rb;Z.df=gh;Z.RealTimeConnection=Z.df;gh.prototype.sendRequest=gh.prototype.Ia;gh.prototype.close=gh.prototype.close;
Z.Af=function(a){var b=sh.prototype.put;sh.prototype.put=function(c,d,e,f){n(f)&&(f=a());b.call(this,c,d,e,f)};return function(){sh.prototype.put=b}};Z.hijackHash=Z.Af;Z.cf=tb;Z.ConnectionTarget=Z.cf;Z.Ba=function(a){return a.Ba()};Z.queryIdentifier=Z.Ba;Z.Cf=function(a){return a.w.Sa.ha};Z.listens=Z.Cf;Z.Md=function(a){a.Md()};Z.forceRestClient=Z.Md;function R(a,b){var c,d,e;if(a instanceof Eh)c=a,d=b;else{K("new Wilddog",1,2,arguments.length);d=Vb(arguments[0]);c=d.Sf;"wilddog"===d.domain&&pd(d.host+" is no longer supported. Please use <YOUR WILDDOG>.wilddogio.com instead");c||pd("Cannot parse Wilddog url. Please use https://<YOUR WILDDOG>.wilddogio.com");d.zb||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Wilddog access from a secure page. Please use https in calls to new Wilddog().");
c=new tb(d.host,d.zb,c);d=new z(d.Zb);e=d.toString();var f;!(f=!p(c.host)||0===c.host.length||!Fg(c.Wb))&&(f=0!==e.length)&&(e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),f=!(p(e)&&0!==e.length&&!Eg.test(e)));if(f)throw Error(L("new Wilddog",1,!1)+'must be a valid wilddog URL and the path can\'t contain ".", "#", "$", "[", or "]".');if(b)if(b instanceof Yh)e=b;else if(p(b))e=Yh.mb(),c.ld=b;else throw Error("Expected a valid Wilddog.Context for second argument to new Wilddog()");else e=Yh.mb();f=c.toString();
var g=J(e.cc,f);g||(g=new Eh(c,e.Ze),e.cc[f]=g);c=g}W.call(this,c,d,dg,!1)}la(R,W);"undefined"!=typeof module&&(module.exports=R);h=R.prototype;h.name=function(){S("Wilddog.name() being deprecated. Please use Wilddog.key() instead.");K("Wilddog.name",0,0,arguments.length);return this.key()};h.key=function(){K("Wilddog.key",0,0,arguments.length);return this.path.f()?null:Ca(this.path)};
h.F=function(a){K("Wilddog.child",1,1,arguments.length);if(fa(a))a=String(a);else if(!(a instanceof z))if(null===B(this.path)){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/"));Ng("Wilddog.child",b)}else Ng("Wilddog.child",a);return new R(this.w,this.path.F(a))};h.parent=function(){K("Wilddog.parent",0,0,arguments.length);var a=this.path.parent();return null===a?null:new R(this.w,a)};h.ef=function(){K("Wilddog.ref",0,0,arguments.length);for(var a=this;null!==a.parent();)a=a.parent();return a};
h.set=function(a,b){K("Wilddog.set",1,2,arguments.length);Og("Wilddog.set",this.path);Hg("Wilddog.set",a,this.path,!1);M("Wilddog.set",2,b,!0);this.w.Ab(this.path,a,null,b||null)};
h.update=function(a,b){K("Wilddog.update",1,2,arguments.length);Og("Wilddog.update",this.path);if(ea(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c;S("Passing an Array to Wilddog.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jg("Wilddog.update",a,this.path);M("Wilddog.update",2,b,!0);this.w.update(this.path,a,b||null)};
h.Ab=function(a,b,c){K("Wilddog.setWithPriority",2,3,arguments.length);Og("Wilddog.setWithPriority",this.path);Hg("Wilddog.setWithPriority",a,this.path,!1);Kg("Wilddog.setWithPriority",2,b);M("Wilddog.setWithPriority",3,c,!0);if(".length"===this.key()||".keys"===this.key())throw"Wilddog.setWithPriority failed: "+this.key()+" is a read-only object.";this.w.Ab(this.path,a,b,c||null)};
h.remove=function(a){K("Wilddog.remove",0,1,arguments.length);Og("Wilddog.remove",this.path);M("Wilddog.remove",1,a,!0);this.set(null,a)};
h.ff=function(a,b,c){K("Wilddog.transaction",1,3,arguments.length);Og("Wilddog.transaction",this.path);M("Wilddog.transaction",1,a,!1);M("Wilddog.transaction",2,b,!0);if(n(c)&&"boolean"!=typeof c)throw Error(L("Wilddog.transaction",3,!0)+"must be a boolean.");if(".length"===this.key()||".keys"===this.key())throw"Wilddog.transaction failed: "+this.key()+" is a read-only object.";"undefined"===typeof c&&(c=!0);Ph(this.w,this.path,a,b||null,c)};
h.Pf=function(a,b){K("Wilddog.setPriority",1,2,arguments.length);Og("Wilddog.setPriority",this.path);Kg("Wilddog.setPriority",1,a);M("Wilddog.setPriority",2,b,!0);this.w.Ab(this.path.F(".priority"),a,null,b)};h.push=function(a,b){K("Wilddog.push",0,2,arguments.length);Og("Wilddog.push",this.path);Hg("Wilddog.push",a,this.path,!0);M("Wilddog.push",2,b,!0);var c=Gh(this.w),c=Ve(c),c=this.F(c);"undefined"!==typeof a&&null!==a&&c.set(a,b);return c};
h.onDisconnect=function(){Og("Wilddog.onDisconnect",this.path);return new Y(this.w,this.path)};h.V=function(a,b,c){S("WilddogRef.auth() being deprecated. Please use WilddogRef.authWithCustomToken() instead.");K("Wilddog.auth",1,3,arguments.length);Pg("Wilddog.auth",a);M("Wilddog.auth",2,b,!0);M("Wilddog.auth",3,b,!0);wg(this.w.V,a,{},{remember:"none"},b,c)};h.Ad=function(a){K("Wilddog.unauth",0,1,arguments.length);M("Wilddog.unauth",1,a,!0);xg(this.w.V,a)};
h.Od=function(){K("Wilddog.getAuth",0,0,arguments.length);return this.w.V.Od()};h.Ef=function(a,b){K("Wilddog.onAuth",1,2,arguments.length);M("Wilddog.onAuth",1,a,!1);Bb("Wilddog.onAuth",2,b);this.w.V.ub("auth_status",a,b)};h.Df=function(a,b){K("Wilddog.offAuth",1,2,arguments.length);M("Wilddog.offAuth",1,a,!1);Bb("Wilddog.offAuth",2,b);this.w.V.Xb("auth_status",a,b)};
h.hf=function(a,b,c){K("Wilddog.authWithCustomToken",2,3,arguments.length);Pg("Wilddog.authWithCustomToken",a);M("Wilddog.authWithCustomToken",2,b,!1);Rg("Wilddog.authWithCustomToken",3,c,!0);wg(this.w.V,a,{},c||{},b)};h.jf=function(a,b,c){K("Wilddog.authWithOAuthPopup",2,3,arguments.length);Qg("Wilddog.authWithOAuthPopup",1,a);M("Wilddog.authWithOAuthPopup",2,b,!1);Rg("Wilddog.authWithOAuthPopup",3,c,!0);Bg(this.w.V,a,c,b)};
h.kf=function(a,b,c){K("Wilddog.authWithOAuthRedirect",2,3,arguments.length);Qg("Wilddog.authWithOAuthRedirect",1,a);M("Wilddog.authWithOAuthRedirect",2,b,!1);Rg("Wilddog.authWithOAuthRedirect",3,c,!0);var d=this.w.V;zg(d);var e=[dc],f=yb(c);"anonymous"===a||"wilddog"===a?T(b,I("TRANSPORT_UNAVAILABLE")):(sb.set("redirect_client_options",f.Nc),Ag(d,e,"/auth/"+a,f,b))};
h.lf=function(a,b,c,d){K("Wilddog.authWithOAuthToken",3,4,arguments.length);Qg("Wilddog.authWithOAuthToken",1,a);M("Wilddog.authWithOAuthToken",3,c,!1);Rg("Wilddog.authWithOAuthToken",4,d,!0);p(b)?(Qg("Wilddog.authWithOAuthToken",2,b),yg(this.w.V,a+"/token",{access_token:b},d,c)):(Rg("Wilddog.authWithOAuthToken",2,b,!1),yg(this.w.V,a+"/token",b,d,c))};
h.gf=function(a,b){K("Wilddog.authAnonymously",1,2,arguments.length);M("Wilddog.authAnonymously",1,a,!1);Rg("Wilddog.authAnonymously",2,b,!0);yg(this.w.V,"anonymous",{},b,a)};h.mf=function(a,b,c){K("Wilddog.authWithPassword",2,3,arguments.length);Rg("Wilddog.authWithPassword",1,a,!1);Sg("Wilddog.authWithPassword",a,"email");Sg("Wilddog.authWithPassword",a,"password");M("Wilddog.authAnonymously",2,b,!1);Rg("Wilddog.authAnonymously",3,c,!0);yg(this.w.V,"password",a,c,b)};
h.Kd=function(a,b){K("Wilddog.createUser",2,2,arguments.length);Rg("Wilddog.createUser",1,a,!1);Sg("Wilddog.createUser",a,"email");Sg("Wilddog.createUser",a,"password");M("Wilddog.createUser",2,b,!1);this.w.V.Kd(a,b)};h.he=function(a,b){K("Wilddog.removeUser",2,2,arguments.length);Rg("Wilddog.removeUser",1,a,!1);Sg("Wilddog.removeUser",a,"email");Sg("Wilddog.removeUser",a,"password");M("Wilddog.removeUser",2,b,!1);this.w.V.he(a,b)};
h.Id=function(a,b){K("Wilddog.changePassword",2,2,arguments.length);Rg("Wilddog.changePassword",1,a,!1);Sg("Wilddog.changePassword",a,"email");Sg("Wilddog.changePassword",a,"oldPassword");Sg("Wilddog.changePassword",a,"newPassword");M("Wilddog.changePassword",2,b,!1);this.w.V.Id(a,b)};
h.Hd=function(a,b){K("Wilddog.changeEmail",2,2,arguments.length);Rg("Wilddog.changeEmail",1,a,!1);Sg("Wilddog.changeEmail",a,"oldEmail");Sg("Wilddog.changeEmail",a,"newEmail");Sg("Wilddog.changeEmail",a,"password");M("Wilddog.changeEmail",2,b,!1);this.w.V.Hd(a,b)};h.je=function(a,b){K("Wilddog.resetPassword",2,2,arguments.length);Rg("Wilddog.resetPassword",1,a,!1);Sg("Wilddog.resetPassword",a,"email");M("Wilddog.resetPassword",2,b,!1);this.w.V.je(a,b)};
R.ta=function(){K("Wilddog.goOffline",0,0,arguments.length);Yh.mb().rb()};R.Ha=function(){K("Wilddog.goOnline",0,0,arguments.length);Yh.mb().fc()};R.Z=function(){C(!0,"Can't turn on custom loggers persistently.");"undefined"!==typeof console&&("function"===typeof console.log?eb=q(console.log,console):"object"===typeof console.log&&(eb=function(a){console.log(a)}))};R.o={TIMESTAMP:{".sv":"timestamp"}};R.g=CLIENT_VERSION;R.INTERNAL=X;R.$a=Yh;R.Dd=Z;"undefined"!=typeof window&&(window.Wilddog=R);
R.prototype.name=R.prototype.name;R.prototype.key=R.prototype.key;R.prototype.child=R.prototype.F;R.prototype.parent=R.prototype.parent;R.prototype.root=R.prototype.ef;R.prototype.set=R.prototype.set;R.prototype.update=R.prototype.update;R.prototype.setPriority=R.prototype.Pf;R.prototype.setWithPriority=R.prototype.Ab;R.prototype.remove=R.prototype.remove;R.prototype.transaction=R.prototype.ff;R.prototype.push=R.prototype.push;R.prototype.onDisconnect=R.prototype.onDisconnect;R.prototype.auth=R.prototype.V;
R.prototype.unauth=R.prototype.Ad;R.prototype.getAuth=R.prototype.Od;R.prototype.onAuth=R.prototype.Ef;R.prototype.offAuth=R.prototype.Df;R.prototype.authWithCustomToken=R.prototype.hf;R.prototype.authWithOAuthPopup=R.prototype.jf;R.prototype.authWithOAuthRedirect=R.prototype.kf;R.prototype.authWithOAuthToken=R.prototype.lf;R.prototype.authAnonymously=R.prototype.gf;R.prototype.authWithPassword=R.prototype.mf;R.prototype.createUser=R.prototype.Kd;R.prototype.removeUser=R.prototype.he;
R.prototype.changeEmail=R.prototype.Hd;R.prototype.changePassword=R.prototype.Id;R.prototype.resetPassword=R.prototype.je;R.goOnline=R.Ha;R.goOffline=R.ta;R.ServerValue=R.o;R.INTERNAL=R.INTERNAL;
};ns.wrapper(ns.goog,ns.wd)})({goog:{},wd:{}})
